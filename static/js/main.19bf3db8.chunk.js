(this["webpackJsonpp2p-videochat-platform-frontend"]=this["webpackJsonpp2p-videochat-platform-frontend"]||[]).push([[0],{137:function(e,t,a){e.exports=a(184)},139:function(e,t,a){},147:function(e,t){},151:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=151},181:function(e,t){},184:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=(a(139),a(8)),c=a.n(o),l=a(29),i=a(35),u=a(106),s=a(107),m=(a(147),a(10)),d={peer:null,socket:null,metadata:{nickname:"Andi"},error:null},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_LOCAL_USER_SOCKET":return Object(m.a)({},e,{socket:t.payload.socket,error:null});case"INIT_LOCAL_USER_PEER":return Object(m.a)({},e,{peer:t.payload.peer,error:null});case"SET_LOCAL_USER_METADATA":return Object(m.a)({},e,{metadata:t.payload.metadata,error:null});case"SET_LOCAL_USER_ERROR":return Object(m.a)({},e,{error:t.payload.error});default:return e}},f=a(27),E={data:{},error:null},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_PEER":var a=t.payload.peer;return{data:Object(m.a)({},e.data,Object(f.a)({},a.id,a)),error:null};case"REMOVE_PEER":var n=Object(m.a)({},e.data),r=t.payload.peer;return delete n[r.id],{data:n,error:null};case"SET_PEERS_ERROR":return Object(m.a)({},e,{error:t.payload.error});case"ADD_CONNECTION":case"REMOVE_CONNECTION":case"ADD_CALL":case"REMOVE_CALL":default:return e}},b={data:{},error:null},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_CONNECTION":var a=t.payload.connection;return{data:Object(m.a)({},e.data,Object(f.a)({},a.peer,a)),error:null};case"REMOVE_CONNECTION":var n=Object(m.a)({},e.data),r=t.payload.connection;return delete n[r.peer],{data:n,error:null};case"SET_CONNECTIONS_ERROR":return Object(m.a)({},e,{error:t.payload.error});default:return e}},y={data:{},error:null},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_CALL":var a=t.payload.call;return{data:Object(m.a)({},e.data,Object(f.a)({},a.peer,a)),error:null};case"REMOVE_CALL":var n=Object(m.a)({},e.data),r=t.payload.call;return delete n[r.id],{data:n,error:null};case"REMOVE_CONNECTION":var o=t.payload.connection.peer,c=e.data[o];if(c){var l=Object(m.a)({},e.data);return delete l[o],Object(m.a)({},e,{data:l,error:null})}return e;case"SET_CALLS_ERROR":return Object(m.a)({},e,{error:t.payload.error});default:return e}},x=a(15),O=function(e){e&&e.getTracks().forEach((function(e){return e.stop()}))},j={data:{},error:null},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_STREAM":var a=t.payload,n=a.peerId,r=a.stream;return{data:Object(m.a)({},e.data,Object(f.a)({},n,r)),error:null};case"REMOVE_STREAM":var o=Object(m.a)({},e.data),c=t.payload.peerId,l=o[c];return O(l),delete o[c],{data:o,error:null};case"SET_STREAM_ERROR":return Object(m.a)({},e,{error:t.payload.error});case"CLEAR_ALL_STREAMS":return Object.values(e.data).forEach(O),Object(m.a)({},e,{data:{},error:null});default:return e}},S=Object(i.combineReducers)({localUser:p,peers:h,calls:v,connections:g,streams:w}),C=Object(i.createStore)(S,Object(s.composeWithDevTools)(Object(i.applyMiddleware)(u.a))),N=a(18),R=a(39),k=a(211),_=a(213),L=a(118),T=Object(L.a)({palette:{primary:{main:"#E53935"},secondary:{main:"#FB8C00"}}}),A=a(228),I=a(215),D=a(69),M=a(232),U=a(220),B=a(66),P=a.n(B),F=Object(k.a)({containerStyle:{display:"flex",justifyContent:"center",paddingTop:"128px"},titleStyle:{display:"flex",justifyContent:"center",padding:"16px",color:"white",fontWeight:"bold",backgroundColor:"#FB8C00"},nicknameStyle:{width:"616px",margin:"16px"},textfieldLink:{width:"616px",marginRight:"16px",marginLeft:"16px"},nextButton:{color:"white",boxShadow:"none",width:"422px"},alignbutton:{display:"flex",justifyContent:"center",marginTop:"24px"}}),z=function(e){var t=e.match,a=r.a.useState(""),n=Object(x.a)(a,2),o=n[0],c=n[1],l=r.a.useState(t.params.roomId),i=Object(x.a)(l,2),u=i[0],s=i[1],m=F();return r.a.createElement(_.a,{theme:T},r.a.createElement(A.a,{display:"flex",height:63,bgcolor:"#E53935",alignItems:"center",paddingLeft:"36px"},r.a.createElement(N.b,{to:"/",style:{textDecoration:"none",color:"white"}},r.a.createElement(P.a,null))),r.a.createElement(I.a,{className:m.containerStyle},r.a.createElement(A.a,{display:"flex",flexDirection:"column",width:648,height:307,borderRadius:"5px",bgcolor:"white"},r.a.createElement(D.a,{variant:"h4",className:m.titleStyle},"Enter the rooom"),r.a.createElement(M.a,{required:!0,id:"outlined-required",label:"Nickname",variant:"outlined",value:o,className:m.nicknameStyle,onChange:function(e){c(e.target.value)}}),r.a.createElement(M.a,{required:!0,id:"outlined-required",label:"Room ID",variant:"outlined",value:u,className:m.textfieldLink,onChange:function(e){s(e.target.value)}}),r.a.createElement("div",{className:m.alignbutton},r.a.createElement(N.b,{to:"/rooms/".concat(t.params.roomId),style:{textDecoration:"none"}},r.a.createElement(U.a,{size:"large",color:"secondary",variant:"contained",className:m.nextButton},"join"))))))},V=function(){return r.a.createElement(A.a,{bgcolor:"salmon",flexGrow:1},r.a.createElement("iframe",{src:"https://andreas-schoch.github.io/breakout-game/",style:{width:"100%",height:"100%"}}))},W=a(221),q=Object(k.a)((function(e){return{root:{display:"flex"},cardWrapper:{marginBottom:"5px"},media:{width:"100%",height:"120px",objectFit:"cover"}}})),J=function(e){var t=e.stream,a=e.muted,o=void 0!==a&&a,c=e.user,l=q(),i=Object(n.useRef)(null),u=c.nickname;c.peerId;return Object(n.useEffect)((function(){!function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e.current&&t&&(e.current.srcObject=t,e.current.oncanplay=function(){e.current.play(),e.current.muted=a})}(i,t,o)}),[t]),r.a.createElement(W.a,{className:l.cardWrapper},r.a.createElement("video",{ref:i,className:l.media}),u)},G=a(222),K=a(13),H=a.n(K),Q=a(26),X=function(e,t){return function(a,n){t&&a({type:"ADD_STREAM",payload:{peerId:e,stream:t}})}},Y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{video:!0,audio:!0};return function(){var a=Object(Q.a)(H.a.mark((function a(n,r){var o,c;return H.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o=e||r().localUser.peer,a.prev=1,a.next=4,navigator.mediaDevices.getUserMedia(t);case 4:return c=a.sent,n(X(o.id,c)),window.localStream=c,a.abrupt("return",c);case 10:a.prev=10,a.t0=a.catch(1),console.error('local stream couldnt be started via "startStream()"',a.t0);case 13:case"end":return a.stop()}}),a,null,[[1,10]])})));return function(e,t){return a.apply(this,arguments)}}()},Z=function(e){return function(t,a){e&&(t({type:"ADD_CALL",payload:{call:e}}),t($(e)))}},$=function(e){return function(t,a){e&&e.on("stream",(function(a){t(X(e.peer,a))}))}},ee=Object(l.b)((function(e,t){var a=e.localUser.peer,n=t.connection.peer,r=n?e.streams.data[n]:null;return{localPeer:a,localStream:a?e.streams.data[a.id]:null,remoteStream:r,call:e.calls.data[n]}}),{addCall:Z})((function(e){var t=e.localPeer,a=(e.localStream,e.remoteStream),o=e.connection,c=e.call;e.addCall;Object(n.useEffect)((function(){}),[t,o]);return r.a.createElement(r.a.Fragment,null,c?r.a.createElement(J,{stream:a,user:{nickname:"remote"}}):r.a.createElement(G.a,{color:"inherit"}))})),te=Object(l.b)((function(e){return{connections:Object.values(e.connections.data)}}))((function(e){var t=e.connections;return r.a.createElement(r.a.Fragment,null,t&&t.map((function(e){return r.a.createElement(ee,{key:e.connectionId,connection:e})})))})),ae=Object(k.a)((function(e){return{roomMediaManager:{padding:"5px"}}})),ne=Object(l.b)((function(e){var t=e.localUser.peer,a=t?e.streams.data[t.id]:null;return{localPeerMetadata:e.localUser.metadata,localStream:a}}),{})((function(e){var t=e.localStream,a=e.localPeerMetadata,n=ae();return r.a.createElement(A.a,{bgcolor:"lightblue",width:"220px",minWidth:"150px",className:n.roomMediaManager},r.a.createElement(J,{stream:t,muted:!0,user:{nickname:a.nickname}}),r.a.createElement(te,null))})),re=function(e){return function(t,a){e&&e.peer&&(t({type:"ADD_CONNECTION",payload:{connection:e}}),t(ce(e)))}},oe=function(e){return function(t,a){e&&e.peer&&t({type:"REMOVE_CONNECTION",payload:{connection:e}})}},ce=function(e){return function(t,a){e&&e.connectionId&&(e.on("data",(function(e){var t=JSON.parse(e);t.textMessage&&console.log("%c MESSAGE - ".concat(t.textMessage.author,': "').concat(t.textMessage.text,'"'),"background: black; color: white; padding: 1rem"),t.pluginData&&console.log("received plugin data:",t)})),e.on("close",(function(){t(oe(e))})))}},le=function(e){return function(t,a){var n=a().localUser.peer;if(e!==n.id){var r=n.connect(e,{metadata:{nickname:"test-metadata"}});t(re(r)),t(function(e){return function(){var t=Object(Q.a)(H.a.mark((function t(a,n){var r,o,c;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n().localUser.peer,t.t0=n().streams.data[r.id],t.t0){t.next=6;break}return t.next=5,a(Y(r));case 5:t.t0=t.sent;case 6:return o=t.t0,t.next=9,r.call(e.peer,o);case 9:c=t.sent,a(Z(c));case 11:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()}(r))}}},ie=a(112),ue=a.n(ie),se=a(113),me=a.n(se),de=function(e){return function(t,a){var n=e||a().localUser.peer;n&&(n.on("open",(function(e){})),n.on("connection",(function(e){t(re(e))})),n.on("call",(function(e){var r=a().streams.data[n.id];e.answer(r),t(Z(e))})))}},pe=a(114),fe=a.n(pe),Ee=a(115),he=a.n(Ee),be=a(231),ge=a(219),ye=a(225),ve=a(187),xe=a(223),Oe=a(224),je=a(116),we=a.n(je),Se=Object(k.a)({list:{width:250},menuIcon:{margin:"8px"}}),Ce=function(){var e=Se(),t=Object(n.useState)(!1),a=Object(x.a)(t,2),o=a[0],c=a[1],l=function(e){"keydown"!==e.type&&c(!o)};return r.a.createElement(_.a,{theme:T},r.a.createElement(U.a,null,r.a.createElement(we.a,{onClick:l,color:"primary",fontSize:"large",className:e.menuIcon}),r.a.createElement(be.a,{open:o,onClose:l,anchor:"left"},r.a.createElement("div",{className:e.list,role:"presentation",onClick:l},r.a.createElement(ge.a,null,["Plugin 1","Plugin 2","Plugin 3","Plugin 4"].map((function(e,t){return r.a.createElement(ve.a,{button:!0,key:e},r.a.createElement(xe.a,null,r.a.createElement(fe.a,null)),r.a.createElement(Oe.a,{primary:e}))}))),r.a.createElement(ye.a,null),r.a.createElement(ge.a,null,r.a.createElement(ve.a,{button:!0},r.a.createElement(xe.a,null,r.a.createElement(he.a,null)),r.a.createElement(Oe.a,{primary:"Browse Plugins"})))))))},Ne=a(117),Re=a.n(Ne),ke=Object(k.a)({list:{width:300},chatIcon:{margin:"8px"}}),_e=function(){var e=ke(),t=Object(n.useState)(!1),a=Object(x.a)(t,2),o=a[0],c=a[1],l=function(e){"keydown"!==e.type&&c(!o)};return r.a.createElement(_.a,{theme:T},r.a.createElement(U.a,null,r.a.createElement(Re.a,{onClick:l,color:"primary",fontSize:"large",className:e.chatIcon}),r.a.createElement(be.a,{open:o,onClose:l,anchor:"right"},r.a.createElement("div",{className:e.list,role:"presentation",onClick:l}))))},Le=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(A.a,{bgcolor:"wheat",height:"10%",display:"flex",flexDirection:"row",width:1,justifyContent:"center"},r.a.createElement(Ce,null),r.a.createElement(_e,null),r.a.createElement(N.b,{to:"/"},"Home")))},Te=Object(l.b)((function(e){return{socket:e.localUser.socket,localPeer:e.localUser.peer,connections:e.connections.data}}),{addConnection:re,removeConnection:oe,initLocalUser:function(e){return function(){var t=Object(Q.a)(H.a.mark((function t(a,n){var r;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"https",(r=me()("".concat("https","://").concat("derpmasters.online",":").concat("5002"),{secure:!0,query:(n=e,Object.entries(n).map((function(e){var t=Object(x.a)(e,2),a=t[0],n=t[1];return"".concat(a,"=").concat(n)})).join("&"))})).on("ready",(function(t){var n;a({type:"SET_LOCAL_USER_METADATA",payload:{metadata:e}}),a({type:"INIT_LOCAL_USER_SOCKET",payload:{socket:r}}),a((n=t,function(){var e=Object(Q.a)(H.a.mark((function e(t,a){var r;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new ue.a(n,{host:"derpmasters.online",port:"5001",path:"/peer/signal",config:{iceServers:[{url:"stun:stun.l.google.com:19302"}]}});case 2:r=e.sent,t({type:"INIT_LOCAL_USER_PEER",payload:{peer:r}}),t(Y(r)),t(de(r));case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()))}));case 3:case"end":return t.stop()}var n}),t)})));return function(e,a){return t.apply(this,arguments)}}()},joinRoom:function(e,t){return function(){var a=Object(Q.a)(H.a.mark((function a(n,r){var o,c,l;return H.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:o=r().localUser,c=o.socket,l=o.peer,c&&l&&c.emit("join",{roomId:e,password:t,peerId:l.id},(function(e){e&&e.room.joinedUsers.forEach((function(e){return n(le(e))}))}));case 2:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}()},startLocalStream:Y,clearAllStreams:function(){return function(){var e=Object(Q.a)(H.a.mark((function e(t,a){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"CLEAR_ALL_STREAMS"});case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()}})((function(e){var t=e.socket,a=e.localPeer,o=e.connections,c=e.match,l=e.initLocalUser,i=e.joinRoom,u=e.startLocalStream,s=e.clearAllStreams;return Object(n.useEffect)((function(){l({nickname:"andiiii"})}),[]),Object(n.useEffect)((function(){a&&(u(),i(c.params.roomId,"dummy123"))}),[a]),Object(n.useEffect)((function(){return function(){t&&(t.emit("leave",c.params.roomId),t.disconnect()),o&&Object.values(o).forEach((function(e){return e.close()})),window.localStream&&window.localStream.getTracks().forEach((function(e){return e.stop()})),s()}}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(A.a,{display:"flex",flexDirection:"column",width:1,height:"100%",justifyContent:"space-between"},r.a.createElement(A.a,{display:"flex",flexDirection:"row",width:1,height:"90%",justifyContent:"space-between"},r.a.createElement(V,null),r.a.createElement(ne,null)),r.a.createElement(Le,null)))})),Ae=Object(k.a)({titleStyle:{color:"white",fontWeight:"bold",marginTop:"98px"},buttonStyle:{borderRadius:"50px",width:"106px",fontWeight:"bold",border:"2px solid #E53935","&:hover":{color:"white",backgroundColor:"#E53935"},"&:focus":{outline:0}}}),Ie=function(){var e=Ae();return r.a.createElement(_.a,{theme:T},r.a.createElement(A.a,{height:63,bgcolor:"#E53935"}," "),r.a.createElement(A.a,{height:640,display:"flex"},r.a.createElement(A.a,{display:"flex",flexDirection:"column",width:"50%",height:"100%",bgcolor:"#FDD835",alignItems:"center"},r.a.createElement(D.a,{variant:"h3",className:e.titleStyle,gutterBottom:!0}," Create a new room"),r.a.createElement(N.b,{to:"/create-room",style:{textDecoration:"none"}},r.a.createElement(U.a,{size:"large",color:"primary",className:e.buttonStyle},"Create"))),r.a.createElement(A.a,{display:"flex",flexDirection:"column",width:"50%",height:"100%",bgcolor:"#FB8C00",alignItems:"center"},r.a.createElement(D.a,{variant:"h3",className:e.titleStyle,gutterBottom:!0}," Join a room"),r.a.createElement(U.a,{size:"large",color:"primary",className:e.buttonStyle},"Join"))),r.a.createElement(N.b,{to:"/rooms/dummy-room-id"},"Test room"))},De=a(233),Me=a(226),Ue=a(218),Be=a(229),Pe=Object(k.a)({containerStyle:{display:"flex",justifyContent:"center",paddingTop:"128px"},titleStyle:{display:"flex",justifyContent:"center",padding:"16px",color:"white",fontWeight:"bold",backgroundColor:"#FB8C00"},formControl:{width:"20%",margin:"16px"},select:{borderColor:"#FB8C00","&:before":{borderColor:"#FB8C00"},"&:after":{borderColor:"#f57c00"}},textfield:{width:"616px",marginLeft:"16px"},textfieldLink:{width:"506px",marginRight:"16px",marginLeft:"16px"},alignButton:{display:"flex",justifyContent:"flex-end",margin:"16px"},myButton:{color:"white",boxShadow:"none"},paper:{padding:T.spacing(2),textAlign:"center",color:T.palette.text.secondary},copyLink:{display:"flex",alignItems:"center",marginTop:"16px"},nextButton:{color:"white",boxShadow:"none",margin:"32px",width:"576px"},subtitle:{display:"flex",justifyContent:"center",marginTop:"16px"}}),Fe=function(){var e=r.a.useState(""),t=Object(x.a)(e,2),a=t[0],n=t[1],o=r.a.useState(""),c=Object(x.a)(o,2),l=c[0],i=c[1],u=r.a.useState(""),s=Object(x.a)(u,2),m=s[0],d=s[1],p=r.a.useState(""),f=Object(x.a)(p,2),E=f[0],h=f[1],b=r.a.useState(!0),g=Object(x.a)(b,2),y=g[0],v=g[1],O=Pe(),j=function(e){i(e.target.value)};return r.a.createElement(_.a,{theme:T},r.a.createElement(A.a,{display:"flex",height:63,bgcolor:"#E53935",alignItems:"center",paddingLeft:"36px"},r.a.createElement(N.b,{to:"/",style:{textDecoration:"none",color:"white"}},r.a.createElement(P.a,null))),r.a.createElement(I.a,{className:O.containerStyle},y?r.a.createElement(A.a,{display:"flex",flexDirection:"column",width:648,height:307,borderRadius:"5px",bgcolor:"white"},r.a.createElement(D.a,{variant:"h4",className:O.titleStyle},"Create a new room"),r.a.createElement(Ue.a,{variant:"outlined",className:O.formControl},r.a.createElement(De.a,{id:"demo-simple-select-outlined-label"},"Status"),r.a.createElement(Be.a,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",value:a,onChange:function(e){n(e.target.value)},label:"Status",className:O.select},r.a.createElement(Me.a,{value:"Privat"},"Privat"),r.a.createElement(Me.a,{value:"Public"},"Public"))),r.a.createElement(M.a,{required:!0,id:"outlined-required",label:"Room name",variant:"outlined",value:l,onChange:j,className:O.textfield}),r.a.createElement("div",{className:O.alignButton},r.a.createElement(U.a,{size:"large",color:"secondary",variant:"contained",className:O.myButton,onClick:function(){var e={name:l,password:"Test123.",maxUsers:4,status:a};l.length>0&&a.length>0?fetch("http://localhost:5002/api/rooms",{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){d("http://localhost:3000/#/room-lobby/".concat(e)),h(e),v(!1)})):console.log("error")}},"create"))):r.a.createElement(A.a,{display:"flex",flexDirection:"column",width:648,height:307,borderRadius:"5px",bgcolor:"white"},r.a.createElement(D.a,{variant:"h4",className:O.titleStyle},"Room was created"),r.a.createElement("div",{className:O.copyLink},r.a.createElement(M.a,{variant:"outlined",value:m,onChange:j,className:O.textfieldLink}),r.a.createElement(U.a,{size:"large",color:"secondary",variant:"contained",className:O.myButton,onClick:function(){navigator.clipboard.writeText(m)}},"copy")),r.a.createElement(D.a,{variant:"h6",className:O.subtitle}," Share your link and invite someone to your room"),r.a.createElement(N.b,{to:"/room-lobby/".concat(E),style:{textDecoration:"none"}},r.a.createElement(U.a,{size:"large",color:"secondary",variant:"contained",className:O.nextButton},"next")))))},ze=a(227),Ve=function(){return r.a.createElement(ze.a,null,r.a.createElement(N.a,null,r.a.createElement(R.c,null,r.a.createElement(R.a,{exact:!0,path:"/",component:Ie}),r.a.createElement(R.a,{exact:!0,path:"/create-room",component:Fe}),r.a.createElement(R.a,{exact:!0,path:"/room-lobby/:roomId",component:z}),r.a.createElement(R.a,{path:"/rooms/:roomId",component:Te}))))};c.a.render(r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a,{store:C},r.a.createElement(Ve,null))),document.getElementById("root"))}},[[137,1,2]]]);
//# sourceMappingURL=main.19bf3db8.chunk.js.map