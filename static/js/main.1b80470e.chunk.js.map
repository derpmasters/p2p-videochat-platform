{"version":3,"sources":["store/reducers/room.reducer.js","store/actionTypes.js","utils.js","store/reducers/localUser.reducer.js","store/reducers/peers.reducer.js","store/reducers/connections.reducer.js","store/reducers/streams.reducer.js","store/reducers/plugin.reducer.js","store/reducers/chat.reducer.js","store/reducers/index.js","store/index.js","style/theme/MainTheme.jsx","store/actions/streams.actions.js","store/actions/room.actions.js","store/actions/connections.actions.js","constants.js","store/actions/localUser.actions.js","components/RoomLobby/RoomLobby.jsx","store/actions/plugin.actions.js","components/Room/RoomPluginContent/RoomPluginContent.jsx","components/Room/GenericMediaCard/GenericMediaCard.jsx","components/Room/RoomMediaManager/RemoteMediaCard/RemoteMediaCard.jsx","components/Room/RoomMediaManager/RemoteMediaManager/RemoteMediaManager.jsx","components/Room/RoomMediaManager/RoomMediaManager.jsx","components/Room/RoomSidebarMenu/RoomSidebarMenu.jsx","components/Room/RoomSidebarChat/Chat/ChatMsg.jsx","components/Room/RoomSidebarChat/Chat/ChatStyle.jsx","components/Room/RoomSidebarChat/Chat/Chat.jsx","store/actions/chat.actions.js","components/Room/RoomSidebarChat/RoomSidebarChat.jsx","components/Room/RoomActionbar/RoomActionbar.jsx","components/Room/Room.jsx","components/Home/BulletPoint/BulletPoint.jsx","components/Home/Home.jsx","components/RoomCreateForm/RoomCreateForm.jsx","components/App/App.jsx","index.jsx"],"names":["roomReducer","produce","roomDraft","action","type","data","payload","room","error","clearStreamTracks","stream","getTracks","forEach","track","stop","getPersistedData","key","dataJson","localStorage","getItem","JSON","parse","initialState","socket","metadata","loading","localUserReducer","localPeerDraft","peersReducer","peersDraft","socketId","peer","id","connectionsReducer","connectionsDraft","connection","remoteSocketId","streamsReducer","streamsDraft","Object","values","pluginReducer","pluginDraft","plugin","url","name","iframe","chatReducer","messagesDraft","push","reducer","combineReducers","localUser","peers","connections","streams","chat","store","createStore","composeWithDevTools","applyMiddleware","thunk","theme","createMuiTheme","palette","primary","main","secondary","addStream","dispatch","getState","removeStream","startLocalStream","constraintsOverride","a","localSocket","constraints","audio","video","frameRate","ideal","max","width","height","navigator","mediaDevices","getUserMedia","mediaStream","console","log","setCurrentRoomError","addConnection","initConnectionListeners","removeConnection","initDataChannelListeners","dataChannel","onmessage","evt","textMessage","nickname","authorSocketId","text","window","postMessage","contentWindow","senderSocketId","onopen","onclose","currentIteration","iceCandidates","timer","length","emit","receiverSocketId","rawDelay","Math","pow","roundedDelay","round","setTimeout","onicecandidate","iceCandidate","candidate","maxIterations","onaddstream","onsignalingstatechange","signalingState","localDescription","remoteDescription","ondatachannel","defaultDataChannel","channel","introduceYourself","connectWithPeer","RTCPeerConnection","iceServers","urls","iceCandidatePoolSize","createDataChannel","localStream","createOffer","offer","setLocalDescription","sendDataToConnection","serializedData","stringify","send","BACKEND_URL","process","REACT_APP_BACKEND_URL","location","origin","resetLocalUser","initLocalUserSocket","io","secure","protocol","query","object","entries","map","value","join","initLocalUserSocketListeners","on","setRemoteDescription","RTCSessionDescription","createAnswer","answer","addIceCandidate","RTCIceCandidate","useStyles","makeStyles","containerStyle","display","justifyContent","paddingTop","titleStyle","padding","color","fontWeight","backgroundColor","nicknameStyle","margin","textfieldLink","marginRight","marginLeft","nextButton","boxShadow","alignbutton","marginTop","marginBottom","connect","state","roomError","setMetadata","dataStringified","setItem","persistData","history","match","useState","newNickname","setNewNickname","params","roomId","link","setLink","classes","handleJoin","e","ThemeProvider","bgcolor","alignItems","paddingLeft","to","style","textDecoration","container","className","item","xs","md","lg","flexDirection","borderRadius","variant","required","label","onChange","target","onKeyPress","autoFocus","onClick","size","textAlign","message","setPlugin","pluginMessageActions","peerId","handlePluginMessage","startsWith","iframeRef","useRef","useEffect","handleMessage","addEventListener","removeEventListener","current","flexGrow","src","border","ref","title","root","cardWrapper","position","flexFlow","media","objectFit","displayName","opacity","bottom","left","fontSize","userSelect","GenericMediaCard","muted","user","videoRef","srcObject","oncanplay","play","setVideoSrc","ownProps","remoteStream","remoteNickname","roomMediaManager","borderLeft","localPeerMetadata","minWidth","list","menuIcon","plugins","open","setOpen","toggleDrawer","event","handleSelectPlugin","index","currentTarget","dataset","onClose","anchor","role","i","button","data-index","ChatMsg","withStyles","spacing","radius","rightBgColor","wrapper","avatar","leftRow","rightRow","msg","wordBreak","fontFamily","borderTopRightRadius","borderBottomRightRadius","grey","right","borderTopLeftRadius","borderBottomLeftRadius","common","white","leftFirst","leftLast","rightFirst","rightLast","props","messages","side","GridContainerProps","GridItemProps","AvatarProps","getTypographyProps","justify","cx","TypographyProps","align","defaultProps","chatFeed","maxHeight","overflow","chatInput","chatInputTextfield","zIndex","chatInputSendBtn","cursor","transition","chatData","sendMessage","newMessage","setNewMessage","feedRef","scrollTop","scrollHeight","preventDefault","replace","chatMessages","multiline","rowsMax","shiftKey","concat","RoomSidebarChat","_","RoomActionbar","borderTop","localPeerLoading","currentRoom","initLocalUser","joinRoom","password","err","joinedUsers","roomExitCleanup","disconnect","conn","close","smallScreenContainer","alignTitle","customizeTitle","customizeIcon","customizeText","paddingRight","BulletPoint","icon","smallScreen","useMediaQuery","content","image","alt","header","textTransform","box","smallScreenBox","titleContainer","buttonStyle","outline","mainImg","smallScreenMainImg","bulletPoints","smallScreenBulletPoints","Home","aria-label","gutterBottom","formControl","select","borderColor","textfield","alignButton","btnCreateWrapper","btnCreate","fabProgress","top","btnCreateProgress","paper","copyLink","subtitle","RoomCreateForm","setName","setRoomId","setLoading","setError","useHistory","handleChangeTexfield","handleKeyPress","createRoom","maxUsers","Error","fetch","method","body","headers","res","status","json","createRoomJSX","disabled","CircularProgress","shareRoomJSX","myButton","clipboard","writeText","App","exact","path","component","RoomLobby","Room","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.1b80470e.chunk.js","sourcesContent":["import {SET_CURRENT_ROOM, SET_CURRENT_ROOM_ERROR} from '../actionTypes';\r\nimport produce from 'immer';\r\n\r\nconst initialState = {\r\n  data: {\r\n    // id: 'dummy-room-id',\r\n    // name: 'Dummy Room',\r\n  },\r\n  error: null\r\n};\r\n\r\nconst roomReducer = produce((roomDraft, action) => {\r\n  switch (action.type) {\r\n    case SET_CURRENT_ROOM: {\r\n      roomDraft.data = action.payload.room;\r\n      roomDraft.error = null;\r\n      return;\r\n    }\r\n    case SET_CURRENT_ROOM_ERROR: {\r\n      roomDraft.error = action.payload.error;\r\n      return;\r\n    }\r\n    default: {}\r\n  }\r\n}, initialState);\r\n\r\nexport default roomReducer;\r\n","export const ADD_PEER = 'ADD_PEER';\r\nexport const REMOVE_PEER = 'REMOVE_PEER';\r\nexport const SET_PEERS_ERROR = 'SET_PEERS_ERROR';\r\n\r\nexport const ADD_CONNECTION = 'ADD_CONNECTION';\r\nexport const REMOVE_CONNECTION = 'REMOVE_CONNECTION';\r\nexport const SET_CONNECTIONS_ERROR = 'SET_CONNECTIONS_ERROR';\r\n\r\nexport const ADD_CALL = 'ADD_CALL';\r\nexport const REMOVE_CALL = 'REMOVE_CALL';\r\nexport const SET_CALLS_ERROR = 'SET_CALLS_ERROR';\r\n\r\nexport const ADD_STREAM = 'ADD_STREAM';\r\nexport const REMOVE_STREAM = 'REMOVE_STREAM';\r\nexport const SET_STREAMS_ERROR = 'SET_STREAM_ERROR';\r\nexport const CLEAR_ALL_STREAMS = 'CLEAR_ALL_STREAMS';\r\n\r\nexport const SET_CURRENT_ROOM = 'SET_CURRENT_ROOM';\r\nexport const SET_CURRENT_ROOM_ERROR = 'SET_CURRENT_ROOM_ERROR';\r\n\r\nexport const SET_LOCAL_USER_LOADING = 'SET_LOCAL_USER_LOADING';\r\nexport const INIT_LOCAL_USER_SOCKET = 'INIT_LOCAL_USER_SOCKET';\r\nexport const INIT_LOCAL_USER_PEER = 'INIT_LOCAL_USER_PEER';\r\nexport const SET_LOCAL_USER_METADATA = 'SET_LOCAL_USER_METADATA';\r\nexport const SET_LOCAL_USER_ERROR = 'SET_LOCAL_USER_ERROR';\r\nexport const RESET_LOCAL_USER = 'RESET_LOCAL_USER';\r\n\r\nexport const SET_PLUGIN = 'SET_PLUGIN';\r\nexport const SET_PLUGIN_ERROR = 'SET_PLUGIN_ERROR';\r\n\r\nexport const ADD_NEW_MESSAGE = 'ADD_NEW_MESSAGE';\r\n","// The place to put all helper methods that do not necessarily belong to a specific component\r\n// Once this file gets too crowded, create an utils folder and start seperating the exported helper methods\r\n\r\n// import {useEffect, useRef, useState} from \"react\";\r\nimport ipRegex from 'ip-regex';\r\n\r\n/**\r\n * Transforms a javascript object into a query string.\r\n * @param object The source object. Example: {a: 5, b: 10}\r\n * @returns {string} The resulting query string. Example 'a=5&b=10'\r\n */\r\nexport const serializeQueryString = object => {\r\n  return Object.entries(object).map(([key, value]) => `${key}=${value}`).join('&');\r\n};\r\n\r\n/**\r\n * Set the src of a html5 <video> element and start playing\r\n * @param videoRef The reference to the video element\r\n * @param stream The stream that should be played by the referenced video element\r\n * @param muted Whether or not the audio of the stream should be muted\r\n */\r\nexport const setVideoSrc = (videoRef, stream, muted = true) => {\r\n  if (videoRef.current && stream) {\r\n    videoRef.current.srcObject = stream;\r\n    videoRef.current.oncanplay = () => {\r\n      videoRef.current.play();\r\n      videoRef.current.muted = muted;\r\n    };\r\n  }\r\n};\r\n\r\n// untested prototype for a hook that might replace setVideoSrc(). Right now there is no benefit of using it. Rethink design\r\n// export const useStream = (muted = false) => {\r\n//     const videoRef = useRef(null);\r\n//     const [stream, setStream] = useState(null);\r\n//\r\n//     useEffect(() => {\r\n//         if (videoRef.current && stream) {\r\n//             videoRef.current.srcObject = stream;\r\n//             videoRef.current.oncanplay = () => {\r\n//                 videoRef.current.play();\r\n//                 videoRef.current.muted = muted;\r\n//             };\r\n//         }\r\n//     }, [stream, videoRef, muted]);\r\n//\r\n//     return [videoRef, setStream];\r\n// };\r\n\r\nexport const clearStreamTracks = stream => {\r\n  if (stream) {\r\n    stream.getTracks().forEach(track => track.stop());\r\n  }\r\n};\r\n\r\nexport const getPersistedData = (key) => {\r\n  const dataJson = localStorage.getItem(key);\r\n  return dataJson ? JSON.parse(dataJson) : {};\r\n};\r\n\r\nexport const persistData = (key, data) => {\r\n  const dataStringified = JSON.stringify(data);\r\n  localStorage.setItem(key, dataStringified);\r\n};\r\n\r\nexport const isIpAddress = (testedString) => {\r\n  return ipRegex().test(testedString);\r\n};\r\n","import {INIT_LOCAL_USER_SOCKET, RESET_LOCAL_USER, SET_LOCAL_USER_ERROR, SET_LOCAL_USER_LOADING, SET_LOCAL_USER_METADATA} from '../actionTypes';\r\nimport {getPersistedData} from '../../utils';\r\nimport produce from 'immer';\r\n\r\nconst initialState = {\r\n  socket: null,\r\n  metadata: getPersistedData('metadata'),\r\n  loading: false,\r\n  error: null\r\n};\r\n\r\nconst localUserReducer = produce((localPeerDraft, action) => {\r\n  switch (action.type) {\r\n    case SET_LOCAL_USER_LOADING: {\r\n      localPeerDraft.loading = action.payload.loading;\r\n      return;\r\n    }\r\n    case INIT_LOCAL_USER_SOCKET: {\r\n      localPeerDraft.socket = action.payload.socket;\r\n      localPeerDraft.error = null;\r\n      return;\r\n    }\r\n    case SET_LOCAL_USER_METADATA: {\r\n      localPeerDraft.metadata = action.payload.metadata;\r\n      localPeerDraft.error = null;\r\n      return;\r\n    }\r\n    case SET_LOCAL_USER_ERROR: {\r\n      localPeerDraft.error = action.payload.error;\r\n      return;\r\n    }\r\n    case RESET_LOCAL_USER: {\r\n      localPeerDraft.socket = null;\r\n      localPeerDraft.loading = false;\r\n      localPeerDraft.metadata = getPersistedData('metadata');\r\n      localPeerDraft.error = null;\r\n      return;\r\n    }\r\n    default: {}\r\n  }\r\n}, initialState);\r\n\r\nexport default localUserReducer;\r\n","import {ADD_PEER, REMOVE_PEER, SET_PEERS_ERROR} from '../actionTypes';\r\nimport produce from 'immer';\r\n\r\nconst initialState = {\r\n  data: {\r\n    // 'd7f7saim3': {nickname: 'Andi'},\r\n    // '32mfdnmio': {nickname: 'Jimmy'}\r\n  },\r\n  error: null\r\n};\r\n\r\nconst peersReducer = produce((peersDraft, action) => {\r\n  switch (action.type) {\r\n    case ADD_PEER: {\r\n      const { socketId, metadata } = action.payload;\r\n      peersDraft.data[socketId] = { metadata };\r\n      peersDraft.error = null;\r\n      return;\r\n    }\r\n    case REMOVE_PEER: {\r\n      const peer = action.payload.peer;\r\n      delete peersDraft.data[peer.id];\r\n      peersDraft.error = null;\r\n      return;\r\n    }\r\n    case SET_PEERS_ERROR: {\r\n      peersDraft.error = action.payload.error;\r\n      return;\r\n\r\n    }\r\n    default: {}\r\n  }\r\n}, initialState);\r\n\r\nexport default peersReducer;\r\n","import {ADD_CONNECTION, REMOVE_CONNECTION, SET_CONNECTIONS_ERROR} from '../actionTypes';\r\nimport produce from 'immer';\r\n\r\nconst initialState = {\r\n  data: {},\r\n  error: null\r\n};\r\n\r\nconst connectionsReducer = produce((connectionsDraft, action) => {\r\n  switch (action.type) {\r\n    case ADD_CONNECTION: {\r\n      const connection = action.payload.connection;\r\n      connectionsDraft.data[connection.remoteSocketId] = connection;\r\n      connectionsDraft.error = null;\r\n      return;\r\n    }\r\n    case REMOVE_CONNECTION: {\r\n      const connection = action.payload.connection;\r\n      delete connectionsDraft.data[connection.remoteSocketId];\r\n      connectionsDraft.error = null;\r\n      return;\r\n    }\r\n    case SET_CONNECTIONS_ERROR: {\r\n      connectionsDraft.error = action.payload.error;\r\n      return;\r\n    }\r\n    default: {}\r\n  }\r\n}, initialState);\r\n\r\nexport default connectionsReducer;\r\n","import {ADD_STREAM, CLEAR_ALL_STREAMS, REMOVE_STREAM, SET_STREAMS_ERROR} from '../actionTypes';\r\nimport {clearStreamTracks} from '../../utils';\r\nimport produce from 'immer';\r\n\r\nconst initialState = {\r\n  data: {},\r\n  error: null\r\n};\r\n\r\nconst streamsReducer = produce((streamsDraft, action) => {\r\n  switch (action.type) {\r\n    case ADD_STREAM: {\r\n      const { socketId, stream } = action.payload;\r\n      streamsDraft.data[socketId] = stream;\r\n      streamsDraft.error = null;\r\n      return;\r\n    }\r\n    case REMOVE_STREAM: {\r\n      const { socketId } = action.payload;\r\n      const stream = streamsDraft.data[socketId];\r\n      clearStreamTracks(stream);\r\n      delete streamsDraft.data[socketId];\r\n      return;\r\n    }\r\n    case SET_STREAMS_ERROR: {\r\n      streamsDraft.error = action.payload.error;\r\n      return;\r\n    }\r\n    case CLEAR_ALL_STREAMS: {\r\n      Object.values(streamsDraft.data).forEach(clearStreamTracks);\r\n      streamsDraft.data = {};\r\n      streamsDraft.error = null;\r\n      return;\r\n    }\r\n    default: {}\r\n  }\r\n}, initialState);\r\n\r\nexport default streamsReducer;\r\n","import {SET_PLUGIN, SET_PLUGIN_ERROR} from '../actionTypes';\r\nimport produce from 'immer';\r\n\r\n// TODO there should be a plugins.reducer storing the plugin data of already fetched plugins (once they come from the backend)\r\n//  activePluginId should be stored in the room.reducer, as well as pluginIds that are shown in the room sidebar.\r\n//  plugin data can be fetched from the backend (or could already be included when fetching the room)\r\nconst initialState = {\r\n  // origin: 'null',\r\n  iframe: null,\r\n  url: '',\r\n  name: 'p2p-test-plugin',\r\n  error: null\r\n};\r\n\r\nconst pluginReducer = produce((pluginDraft, action) => {\r\n  switch (action.type) {\r\n    case SET_PLUGIN: {\r\n      const { url, name, iframe } = action.payload.plugin;\r\n      pluginDraft.iframe = iframe;\r\n      pluginDraft.url = url;\r\n      pluginDraft.name = name;\r\n      pluginDraft.error = null;\r\n      return;\r\n    }\r\n    case SET_PLUGIN_ERROR: {\r\n      pluginDraft.error = action.payload.error;\r\n      return;\r\n    }\r\n    default: {}\r\n  }\r\n}, initialState);\r\n\r\nexport default pluginReducer;\r\n","import {ADD_NEW_MESSAGE} from '../actionTypes';\r\nimport produce from 'immer';\r\n\r\nconst initialState = [];\r\n\r\nconst chatReducer = produce((messagesDraft, action) => {\r\n  switch (action.type) {\r\n    case ADD_NEW_MESSAGE: {\r\n      messagesDraft.push(action.payload);  // FIXME should be action.payload.message\r\n      return;\r\n    }\r\n    default: {}\r\n  }\r\n}, initialState);\r\n\r\nexport default chatReducer;\r\n","import {combineReducers} from 'redux';\r\nimport roomReducer from './room.reducer';\r\nimport localUserReducer from './localUser.reducer';\r\nimport peersReducer from './peers.reducer';\r\nimport connectionsReducer from './connections.reducer';\r\nimport streamsReducer from './streams.reducer';\r\nimport pluginReducer from './plugin.reducer';\r\nimport chatReducer from './chat.reducer';\r\n\r\nconst reducer = combineReducers({\r\n  room: roomReducer,\r\n  localUser: localUserReducer,\r\n  peers: peersReducer,\r\n  connections: connectionsReducer,\r\n  streams: streamsReducer,\r\n  plugin: pluginReducer,\r\n  chat: chatReducer\r\n});\r\n\r\nexport default reducer;\r\n","import {applyMiddleware, createStore} from 'redux';\r\nimport thunk from 'redux-thunk';\r\nimport {composeWithDevTools} from 'redux-devtools-extension';\r\nimport reducer from './reducers';\r\n\r\nconst store = createStore(reducer, composeWithDevTools(applyMiddleware(thunk)));\r\n\r\nexport default store;\r\n","import {createMuiTheme} from '@material-ui/core/styles';\r\n\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    primary: {\r\n      main: '#2E7D32'\r\n    },\r\n    secondary: {\r\n      main: '#FBC02D'\r\n    }\r\n  }\r\n});\r\n\r\nexport default theme;\r\n","import {ADD_STREAM, CLEAR_ALL_STREAMS, REMOVE_STREAM} from '../actionTypes';\r\n\r\nexport const addStream = (socketId, stream) => (dispatch, getState) => {\r\n  if (stream) {\r\n    dispatch({ type: ADD_STREAM, payload: { socketId, stream } });\r\n  }\r\n};\r\n\r\nexport const removeStream = (socketId) => (dispatch, getState) => {\r\n  if (socketId) {\r\n    dispatch({ type: REMOVE_STREAM, payload: { socketId } });\r\n  }\r\n};\r\n\r\nexport const startLocalStream = (socket, constraintsOverride) => async (dispatch, getState) => {\r\n  const localSocket = socket || getState().localUser.socket;\r\n\r\n  if (!socket) {\r\n    return;\r\n  }\r\n  const socketId = socket.id;\r\n  const localSteam = getState().streams.data[socketId];\r\n  if (!localSteam) {\r\n\r\n    try {\r\n      const constraints = {\r\n        audio: true,\r\n        video: {\r\n          frameRate: { ideal: 20, max: 25 },\r\n          width: { ideal: 128 },\r\n          height: { ideal: 72 }\r\n        }\r\n      };\r\n\r\n      let mediaStream = await navigator.mediaDevices.getUserMedia(constraintsOverride || constraints);\r\n      dispatch(addStream(localSocket.id, mediaStream));\r\n      return mediaStream;\r\n    } catch (error) {\r\n      console.error('local stream couldnt be started', error);\r\n    }\r\n  } else {\r\n    console.log('local stream already active');\r\n  }\r\n};\r\nexport const clearAllStreams = () => async (dispatch, getState) => {\r\n  dispatch({ type: CLEAR_ALL_STREAMS });\r\n};\r\n","import {SET_CURRENT_ROOM, SET_CURRENT_ROOM_ERROR} from '../actionTypes';\r\nimport {clearAllStreams} from './streams.actions';\r\nimport {resetLocalUser} from './localUser.actions';\r\n\r\nexport const setCurrentRoom = room => ({\r\n  type: SET_CURRENT_ROOM,\r\n  payload: { room }\r\n});\r\n\r\nexport const setCurrentRoomError = error => ({\r\n  type: SET_CURRENT_ROOM_ERROR,\r\n  payload: { error }\r\n});\r\n\r\nexport const roomExitCleanup = () => (dispatch, getState) => {\r\n  const state = getState();\r\n\r\n  const socket = state.localUser.socket;\r\n  if (socket) {\r\n    // disconnect from socketIO server\r\n    const currentRoom = state.room.data;\r\n    if (currentRoom.id) {\r\n      socket.emit('leave', currentRoom.id);\r\n      dispatch(setCurrentRoom({}));\r\n    }\r\n    socket.disconnect();\r\n    dispatch(resetLocalUser());\r\n\r\n    // clear local media stream\r\n    const localStream = state.streams[socket.id];\r\n    if (localStream) {\r\n      window.localStream.getTracks().forEach(track => track.stop());\r\n    }\r\n    dispatch(clearAllStreams());\r\n  }\r\n\r\n  // close all RTCPeerConnections\r\n  const connections = state.connections.data;\r\n  if (connections) {\r\n    Object.values(connections).forEach(conn => conn.close());\r\n  }\r\n};\r\n","import {ADD_CONNECTION, ADD_NEW_MESSAGE, ADD_PEER, REMOVE_CONNECTION, SET_CURRENT_ROOM} from '../actionTypes';\r\nimport {addStream, removeStream, startLocalStream} from './streams.actions';\r\nimport {setCurrentRoomError} from './room.actions';\r\n\r\nexport const addConnection = (connection) => async (dispatch, getState) => {\r\n  if (connection && connection.socketId) {\r\n    console.log('addConnection', connection);\r\n    await dispatch({ type: ADD_CONNECTION, payload: { connection } });\r\n    await dispatch(initConnectionListeners(connection));\r\n  }\r\n};\r\n\r\nexport const removeConnection = connection => async (dispatch, getState) => {\r\n  if (connection && connection.remoteSocketId && connection.socketId) {\r\n\r\n    const stream = getState().streams.data[connection.remoteSocketId];\r\n    if (stream) {\r\n      await dispatch(removeStream(connection.remoteSocketId));\r\n    }\r\n\r\n    await dispatch({ type: REMOVE_CONNECTION, payload: { connection } });\r\n  }\r\n};\r\n\r\nexport const initDataChannelListeners = dataChannel => (dispatch, getState) => {\r\n  if (dataChannel) {\r\n    dataChannel.onmessage = evt => {\r\n      console.log('received message: ', evt);\r\n      const data = JSON.parse(evt.data);\r\n      const type = data.type;\r\n\r\n      if (data.textMessage) {\r\n        dispatch({ type: ADD_NEW_MESSAGE, payload: data.textMessage });\r\n\r\n        const metadata = getState().localUser.metadata;\r\n        console.log(\r\n          `%c MESSAGE - ${metadata.nickname || data.textMessage.authorSocketId}: \"${data.textMessage.text}\"`,\r\n          'background: black; color: white; padding: 1rem; border: 1px solid white; border-radius: 5px;'\r\n        );\r\n      }\r\n\r\n      if (type === 'PLUGIN_DATA') {\r\n        window.postMessage(data.payload, '*');\r\n        const iframe = getState().plugin.iframe;\r\n        if (iframe) {\r\n          iframe.contentWindow.postMessage(data, '*');\r\n        }\r\n      }\r\n\r\n      if (type === 'PEER_INTRODUCTION') {\r\n        console.log('Connected peer is introducing himself to you:', data.payload);\r\n        const { senderSocketId, metadata } = data.payload;\r\n        dispatch({ type: ADD_PEER, payload: { metadata: metadata, socketId: senderSocketId } });\r\n      }\r\n    };\r\n\r\n    dataChannel.onopen = () => {\r\n      console.log('datachannel open', dataChannel);\r\n    };\r\n\r\n    dataChannel.onclose = () => {\r\n      console.log('datachannel close');\r\n    };\r\n  }\r\n};\r\n\r\nexport const initConnectionListeners = connection => (dispatch, getState) => {\r\n  if (connection && connection.socketId) {\r\n    const delayMultiplier = 1.5;\r\n    const baseDelay = 450;\r\n    const maxIterations = 9;\r\n    let currentIteration = 0;\r\n    let iceCandidates = [];\r\n\r\n    // emits ice-candidates with an increasing delay until the onicecandidate null event\r\n    // Most of the candidates trickle in within the first 0-2seconds but the null event can happen much later\r\n    // The goal is to send all ice-candidates to remotePeer but without clogging up the event loop too much\r\n    // High likelihood to be changed/simplified as time goes by...\r\n    const timer = () => {\r\n      if (iceCandidates.length) {\r\n        const { socket } = getState().localUser;\r\n        socket.emit('ice-candidates', {\r\n          senderSocketId: socket.id,\r\n          receiverSocketId: connection.remoteSocketId,\r\n          iceCandidates: iceCandidates\r\n        });\r\n        iceCandidates = [];\r\n      }\r\n\r\n      if (currentIteration <= maxIterations) {\r\n        const rawDelay = baseDelay * Math.pow(delayMultiplier, currentIteration);\r\n        const roundedDelay = Math.round(rawDelay / 100 * 2) * 100 / 2;\r\n\r\n        console.log('TIMER DELAY', roundedDelay);\r\n        setTimeout(timer, Math.round(roundedDelay));\r\n        currentIteration++;\r\n      }\r\n    };\r\n    timer();\r\n\r\n    connection.onicecandidate = (evt) => {\r\n      const iceCandidate = evt.candidate;\r\n\r\n      if (iceCandidate) {\r\n        iceCandidates.push(iceCandidate);\r\n      } else {\r\n        console.log('no more ICE');\r\n        currentIteration = maxIterations + 1;\r\n        timer();\r\n      }\r\n    };\r\n\r\n    connection.onaddstream = evt => {\r\n      dispatch(addStream(connection.remoteSocketId, evt.stream));\r\n    };\r\n\r\n    connection.onsignalingstatechange = evt => {\r\n      if (connection.signalingState && connection.localDescription && connection.remoteDescription) {\r\n        console.log('CONNECTION ESTABLISHED!!');\r\n      }\r\n    };\r\n\r\n    connection.ondatachannel = async evt => {\r\n      console.log('ondatachannel', evt);\r\n      connection.defaultDataChannel = evt.channel; // FIXME temporary. create wrapper for RTCPeerConnection\r\n      await dispatch(initDataChannelListeners(connection.defaultDataChannel));\r\n      // setTimeout(() => dispatch(introduceYourself(connection.defaultDataChannel), 500)); // TODO temporary delay for experimentation\r\n      dispatch(introduceYourself(connection.defaultDataChannel)); // FIXME test whether it works without timeout now\r\n\r\n    };\r\n\r\n    connection.onmessage = evt => {\r\n      console.log('---------connection.onmessage', evt);\r\n      // Now handled by dataChannels without wrapper of peerjs\r\n    };\r\n  }\r\n};\r\n\r\nexport const connectWithPeer = remoteSocketId => async (dispatch, getState) => {\r\n  const { socket } = getState().localUser;\r\n\r\n  if (remoteSocketId !== socket.id) {\r\n\r\n    const configuration = {\r\n      iceServers: [{ urls: 'stun:stun.l.google.com:19302' }],\r\n      iceCandidatePoolSize: 1\r\n    };\r\n\r\n    const connection = new RTCPeerConnection(configuration); // TODO check first if one already exists\r\n    connection.socketId = socket.id;\r\n    connection.remoteSocketId = remoteSocketId;\r\n\r\n    connection.defaultDataChannel = connection.createDataChannel('default'); // FIXME temporary. create wrapper for RTCPeerConnection\r\n    console.log('--defaultDataChannel created', connection.defaultDataChannel);\r\n    await dispatch(initDataChannelListeners(connection.defaultDataChannel));\r\n\r\n    const localStream = await getState().streams.data[socket.id] || dispatch(startLocalStream());\r\n    connection.addStream(localStream); // addStream needs to be called BEFORE attempting to create offer/answer\r\n    await dispatch(addConnection(connection));\r\n\r\n    const offer = await connection.createOffer();\r\n    console.log('offer created', offer);\r\n    await connection.setLocalDescription(offer);\r\n    socket.emit('offer', { receiverSocketId: remoteSocketId, offer: offer });\r\n  }\r\n};\r\n\r\nexport const sendDataToConnection = (dataChannel, data) => async (dispatch, getState) => {\r\n  if (dataChannel) {\r\n    const serializedData = JSON.stringify(data);\r\n    dataChannel.send(serializedData);\r\n  }\r\n};\r\n\r\nexport const joinRoom = (roomId, password) => async (dispatch, getState) => { // TODO move to room actions\r\n  const { socket } = getState().localUser;\r\n\r\n  if (socket) {\r\n    socket.emit('join', { roomId, password, socketId: socket.id },\r\n      // callback: the joining user himself is responsible to establish connections with other users\r\n      async (err, data) => {\r\n        if (!err) {\r\n          await dispatch(startLocalStream(socket));\r\n          await dispatch({ type: SET_CURRENT_ROOM, payload: { room: data.room } });\r\n          data.room.joinedUsers.forEach((remoteSocketId) => dispatch(connectWithPeer(remoteSocketId)));\r\n          console.log(`There are ${data.room.joinedUsers.length}x joinedUsers`);\r\n        } else {\r\n          dispatch(setCurrentRoomError(err));\r\n        }\r\n      });\r\n  }\r\n};\r\n\r\nexport const introduceYourself = (dataChannel) => async (dispatch, getState) => {\r\n  const { socket, metadata } = getState().localUser;\r\n\r\n  if (socket && metadata) {\r\n    dispatch(sendDataToConnection(dataChannel, { type: 'PEER_INTRODUCTION', payload: { senderSocketId: socket.id, metadata: metadata } }));\r\n  } else {\r\n    console.error('socket and/or metadata not available!');\r\n  }\r\n};\r\n","export const BACKEND_URL = process.env.REACT_APP_BACKEND_URL || window.location.origin;\r\n","import {INIT_LOCAL_USER_SOCKET, RESET_LOCAL_USER, SET_LOCAL_USER_LOADING, SET_LOCAL_USER_METADATA} from '../actionTypes';\r\nimport io from 'socket.io-client';\r\nimport {getPersistedData, persistData, serializeQueryString} from '../../utils';\r\nimport {addConnection, initDataChannelListeners, removeConnection} from './connections.actions';\r\nimport {startLocalStream} from './streams.actions';\r\nimport {setCurrentRoomError} from './room.actions';\r\nimport {BACKEND_URL} from '../../constants';\r\n\r\nexport const resetLocalUser = () => ({ type: RESET_LOCAL_USER });\r\n\r\n/**\r\n * Init the socket.io client. Once socket is ready, init the peerJS Peer and store them in the store.\r\n */\r\nexport const initLocalUser = () => async (dispatch, getState) => {\r\n  const metadata = getPersistedData('metadata');\r\n\r\n  if (!getState().localUser.loading) {\r\n    if (!metadata.nickname || !metadata.nickname.length) {\r\n      dispatch(setCurrentRoomError({ error: { name: 'RoomError', message: 'Please enter a nickname before joining the room.' } }));\r\n    } else {\r\n      dispatch(initLocalUserSocket(metadata));\r\n    }\r\n  }\r\n};\r\n\r\nconst initLocalUserSocket = (metadata) => async (dispatch, getState) => {\r\n\r\n  dispatch({ type: SET_LOCAL_USER_LOADING, payload: { loading: true } });\r\n  const socket = io(BACKEND_URL, {\r\n    // transports: ['websocket'],\r\n    secure: window.location.protocol === 'https',\r\n    query: serializeQueryString(metadata)\r\n  });\r\n\r\n  dispatch(initLocalUserSocketListeners(socket));\r\n};\r\n\r\nconst initLocalUserSocketListeners = (socket) => async (dispatch, getState) => {\r\n  socket.on('ready', (socketId) => {\r\n    dispatch({ type: INIT_LOCAL_USER_SOCKET, payload: { socket } });\r\n\r\n    socket.on('user-leave', (socketId) => {\r\n      const connection = getState().connections.data[socketId];\r\n      if (connection) {\r\n        dispatch(removeConnection(connection));\r\n      }\r\n    });\r\n\r\n    socket.on('offer', async ({ senderSocketId, offer }) => {\r\n      console.log('OFFER received - senderId:', senderSocketId, 'offer:', offer);\r\n\r\n      const configuration = {\r\n        iceServers: [{ urls: 'stun:stun.l.google.com:19302' }],\r\n        iceCandidatePoolSize: 1\r\n      };\r\n\r\n      const connection = new RTCPeerConnection(configuration); // TODO check first if one already exists\r\n      connection.socketId = socket.id; // FIXME temporary solution. store as es6 map. do \"new Map(Array.from(m).reverse())\" for reverse lookup\r\n      connection.remoteSocketId = senderSocketId;\r\n\r\n      connection.defaultDataChannel = connection.createDataChannel('default'); // FIXME temporary. create wrapper for RTCPeerConnection\r\n      console.log('--defaultDataChannel created', connection.defaultDataChannel);\r\n      dispatch(initDataChannelListeners(connection.defaultDataChannel));\r\n\r\n      const localStream = await getState().streams.data[socket.id] || dispatch(startLocalStream());\r\n      connection.addStream(localStream); // addStream needs to be called BEFORE attempting to create offer/answer\r\n      await dispatch(addConnection(connection));\r\n\r\n      await connection.setRemoteDescription(new RTCSessionDescription(offer));\r\n\r\n      const answer = await connection.createAnswer();\r\n      await connection.setLocalDescription(answer);\r\n      socket.emit('answer', { receiverSocketId: senderSocketId, answer: answer });\r\n\r\n    });\r\n\r\n    socket.on('answer', ({ senderSocketId, answer }) => {\r\n      const connection = getState().connections.data[senderSocketId];\r\n\r\n      if (connection) {\r\n        console.log('ANSWER received - senderId:', senderSocketId, 'answer:', answer, 'connection:', connection);\r\n        connection.setRemoteDescription(new RTCSessionDescription(answer));\r\n      }\r\n    });\r\n\r\n    socket.on('ice-candidates', ({ senderSocketId, iceCandidates }) => {\r\n      const connection = getState().connections.data[senderSocketId];\r\n\r\n      if (connection) {\r\n        console.log('ICE Candidates received - senderId:', senderSocketId);\r\n        iceCandidates.forEach(candidate => connection.addIceCandidate(new RTCIceCandidate(candidate)));\r\n      }\r\n    });\r\n  });\r\n};\r\n\r\nexport const setMetadata = (metadata) => (dispatch, getState) => {\r\n  persistData('metadata', metadata);\r\n  dispatch({ type: SET_LOCAL_USER_METADATA, payload: { metadata } });\r\n};\r\n","import React, {useState} from 'react';\r\nimport {Link} from 'react-router-dom';\r\nimport {makeStyles, ThemeProvider} from '@material-ui/core/styles';\r\nimport {Box, Button, Grid, TextField, Typography} from '@material-ui/core';\r\nimport ArrowBackIosIcon from '@material-ui/icons/ArrowBackIos';\r\nimport theme from '../../style/theme/MainTheme';\r\nimport {resetLocalUser, setMetadata} from '../../store/actions/localUser.actions';\r\nimport {connect} from 'react-redux';\r\nimport {setCurrentRoomError} from '../../store/actions/room.actions';\r\n\r\nconst useStyles = makeStyles({\r\n  containerStyle: {\r\n    display: 'flex',\r\n    justifyContent: 'center',\r\n    paddingTop: '128px'\r\n  },\r\n  titleStyle: {\r\n    display: 'flex',\r\n    justifyContent: 'center',\r\n    width: '100%',\r\n    padding: '16px',\r\n    color: 'white',\r\n    fontWeight: 'bold',\r\n    backgroundColor: '#388E3C'\r\n  },\r\n  nicknameStyle: {\r\n    width: '90%',\r\n    margin: '16px'\r\n  },\r\n  textfieldLink: {\r\n    width: '90%',\r\n    marginRight: '16px',\r\n    marginLeft: '16px'\r\n  },\r\n  nextButton: {\r\n    color: 'white',\r\n    boxShadow: 'none',\r\n    width: '100%'\r\n\r\n  },\r\n  alignbutton: {\r\n    display: 'flex',\r\n    justifyContent: 'center',\r\n    width: '80%',\r\n    marginTop: '24px',\r\n    marginBottom: '24px'\r\n  }\r\n});\r\n\r\nconst RoomLobby = ({ history, match, setMetadata, nickname, roomError, setCurrentRoomError, resetLocalUser }) => {\r\n  const [newNickname, setNewNickname] = useState(nickname);\r\n  const [link, setLink] = useState(match.params.roomId);\r\n  const classes = useStyles();\r\n\r\n  const handleChangeName = (e) => {\r\n    setNewNickname(e.target.value);\r\n  };\r\n\r\n  const handleChangeLink = (e) => {\r\n    setLink(e.target.value);\r\n  };\r\n\r\n  const handleKeyPress = (e) => {\r\n    if (e.key === 'Enter') {\r\n      handleJoin();\r\n    }\r\n  };\r\n\r\n  const handleJoin = (e) => {\r\n    setMetadata({ nickname: newNickname });\r\n    setCurrentRoomError(null);\r\n    resetLocalUser();\r\n    history.push(`/rooms/${match.params.roomId}`);\r\n  };\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <Box display='flex' height={63} bgcolor='#2E7D32' alignItems='center' paddingLeft='36px'>\r\n        <Link to=\"/\" style={{ textDecoration: 'none', color: 'white' }}><ArrowBackIosIcon/></Link>\r\n      </Box>\r\n      <Grid container className={classes.containerStyle}>\r\n        <Grid item xs={11} md={6} lg={5}>\r\n          <Box display='flex' flexDirection='column' alignItems='center' width={'100%'} borderRadius='5px' bgcolor='white'>\r\n            <Typography variant='h4' className={classes.titleStyle}>Enter the room</Typography>\r\n            <TextField\r\n              required\r\n              label=\"Nickname\"\r\n              variant=\"outlined\"\r\n              value={newNickname}\r\n              className={classes.nicknameStyle}\r\n              onChange={handleChangeName}\r\n              onKeyPress={handleKeyPress}\r\n              autoFocus\r\n            />\r\n            <TextField\r\n              required\r\n              label=\"Room ID\"\r\n              variant=\"outlined\"\r\n              value={link}\r\n              className={classes.textfieldLink}\r\n              onChange={handleChangeLink}\r\n            />\r\n            <div className={classes.alignbutton}>\r\n              <Button onClick={handleJoin} size=\"large\" color=\"secondary\" variant=\"contained\" className={classes.nextButton}>\r\n                join\r\n              </Button>\r\n            </div>\r\n            {roomError && <Box color={'red'} textAlign={'center'}>{roomError.error.message}</Box>}\r\n          </Box>\r\n        </Grid>\r\n      </Grid>\r\n    </ThemeProvider>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state) => ({\r\n  nickname: state.localUser.metadata.nickname || '',\r\n  roomError: state.room.error\r\n});\r\n\r\nexport default connect(mapStateToProps, { setMetadata, setCurrentRoomError, resetLocalUser })(RoomLobby);\r\n","import {SET_PLUGIN} from '../actionTypes';\r\nimport {sendDataToConnection} from './connections.actions';\r\n\r\nexport const setPlugin = plugin => (dispatch, getState) => {\r\n  // temporary simplified action\r\n  if (plugin) {\r\n    dispatch({ type: SET_PLUGIN, payload: { plugin } });\r\n  }\r\n};\r\n\r\nconst sendPluginMessageToAllConnections = (evt) => (dispatch, getState) => {\r\n  const connections = Object.values(getState().connections.data);\r\n  const data = { type: 'PLUGIN_DATA', payload: evt.data.payload };\r\n  connections.forEach(connection => {\r\n    dispatch(sendDataToConnection(connection.defaultDataChannel, data)); // TODO seperate dataChannel exclusive for plugin data\r\n  });\r\n};\r\n\r\nconst sendPluginMessageToConnection = (evt) => (dispatch, getState) => {\r\n  const { peerId, payload } = evt.data;\r\n  const connection = getState().connections.data[peerId];\r\n  const data = { type: 'PLUGIN_DATA', payload: payload };\r\n  dispatch(sendDataToConnection(connection.defaultDataChannel, data));\r\n};\r\n\r\n// const handlePluginRequestLocalPeer = () => (dispatch, getState) => {\r\n//     try {\r\n//         // TODO verify plugin has PLUGIN_REQUEST_LOCAL_PEER listed in required permissions and user accepted it on start of plugin\r\n//         //  A plugin will have some kind of manifest file (potentially just a .json) for all kinds of metadata like required permissions, name, max users etc\r\n//         // TODO when opening any plugin for the first time, a prompt opens informing user of the required permissions\r\n//         //  he also needs to give his consent by clicking a button which will whitelist the plugin (localstorage for the beginning)\r\n//         const peerId = getState().localUser.peer.id;\r\n//         const data = {type: 'PLUGIN_REQUEST_LOCAL_PEER_GRANT', payload: {peer: peerId}};\r\n//\r\n//         const iframe = getState().plugin.iframe;\r\n//         if (iframe) {\r\n//             iframe.contentWindow.postMessage(data, \"*\");\r\n//         }\r\n//     } catch (err) {\r\n//         console.error('handleRequestLocalPeer error', err);\r\n//     }\r\n// };\r\n\r\nconst pluginMessageActions = {\r\n  'PLUGIN_SEND_TO_ALL_PEERS': sendPluginMessageToAllConnections,\r\n  'PLUGIN_SEND_TO_PEER': sendPluginMessageToConnection,\r\n  // 'PLUGIN_REQUEST_LOCAL_PEER': handlePluginRequestLocalPeer,\r\n  'PLUGIN_PLATFORM_CONTROL_REQUEST': () => console.log('plugin is requesting something from the platform (mute local user, rumble screen, etc')\r\n};\r\n\r\nexport const handlePluginMessage = (evt) => async (dispatch, getState) => {\r\n  if (evt.data.type && evt.data.type.startsWith('PLUGIN')) {\r\n    const action = pluginMessageActions[evt.data.type];\r\n    dispatch(action(evt));\r\n  }\r\n};\r\n","import React, {useEffect, useRef} from 'react';\r\nimport {Box} from '@material-ui/core';\r\nimport {connect} from 'react-redux';\r\nimport {handlePluginMessage, setPlugin} from '../../../store/actions/plugin.actions';\r\n\r\nconst RoomPluginContent = ({ plugin, handlePluginMessage, setPlugin }) => {\r\n  const iframeRef = useRef();\r\n\r\n  useEffect(() => {\r\n    const handleMessage = (evt) => {\r\n      handlePluginMessage(evt);\r\n    };\r\n    window.addEventListener('message', handleMessage);\r\n    return () => window.removeEventListener('message', handleMessage);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (iframeRef && iframeRef.current) {\r\n      setPlugin({ ...plugin, iframe: iframeRef.current });\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [iframeRef, plugin.url]);\r\n\r\n  return (\r\n    <Box flexGrow={1}>\r\n      {plugin && plugin.url && <iframe src={plugin.url} style={{ width: '100%', height: '100%', border: 'none' }} ref={iframeRef} title={'plugin'}/>}\r\n    </Box>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state) => ({\r\n  plugin: state.plugin\r\n});\r\n\r\nexport default connect(mapStateToProps, { handlePluginMessage, setPlugin })(RoomPluginContent);\r\n","import React, {useEffect, useRef} from 'react';\r\nimport {setVideoSrc} from '../../../utils';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {Card, CircularProgress, Box} from '@material-ui/core';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    display: 'flex'\r\n  },\r\n  cardWrapper: {\r\n    position: 'relative',\r\n    display: 'flex',\r\n    flexFlow: 'column nowrap',\r\n    marginBottom: '5px',\r\n    width: '100%',\r\n    height: '130px'\r\n  },\r\n  media: {\r\n    width: '100%',\r\n    height: '100%',\r\n    objectFit: 'cover'\r\n  },\r\n  displayName: {\r\n    color: 'white',\r\n    opacity: '0.8',\r\n    position: 'absolute',\r\n    bottom: '5px',\r\n    left: '5px',\r\n    fontSize: '0.9rem',\r\n    userSelect: 'none'\r\n  }\r\n}));\r\n\r\nconst GenericMediaCard = ({ stream, muted = false, user }) => {\r\n  const classes = useStyles();\r\n  const videoRef = useRef(null);\r\n  const { nickname } = user;\r\n\r\n  useEffect(() => {\r\n    setVideoSrc(videoRef, stream, muted);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [stream]);\r\n\r\n  return (\r\n    <Card className={classes.cardWrapper}>\r\n      {stream\r\n        ? <video ref={videoRef} className={classes.media}/>\r\n        : <CircularProgress color=\"inherit\"/>\r\n      }\r\n      <Box className={classes.displayName}>{nickname}</Box>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default GenericMediaCard;\r\n","import React from 'react';\r\nimport GenericMediaCard from '../../GenericMediaCard/GenericMediaCard';\r\nimport {connect} from 'react-redux';\r\n\r\nconst RemoteMediaCard = ({ remoteStream, remoteNickname }) => <GenericMediaCard stream={remoteStream} user={{ nickname: remoteNickname }}/>;\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n  const remoteSocketId = ownProps.connection.remoteSocketId;\r\n  const remoteStream = remoteSocketId ? state.streams.data[remoteSocketId] : null;\r\n  const remoteMetadata = state.peers.data[remoteSocketId] ? state.peers.data[remoteSocketId].metadata : {};\r\n  return {\r\n    remoteStream: remoteStream,\r\n    remoteNickname: remoteMetadata.nickname || 'missing Nickname'\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps)(RemoteMediaCard);\r\n","import React from 'react';\r\nimport {connect} from 'react-redux';\r\nimport RemoteMediaCard from '../RemoteMediaCard/RemoteMediaCard';\r\n\r\nconst RemoteMediaManager = ({ connections }) => {\r\n  return (\r\n    <>\r\n      {connections && connections.map((connection) => <RemoteMediaCard key={'conn' + connection.remoteSocketId} connection={connection}/>)}\r\n    </>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = state => ({\r\n  connections: Object.values(state.connections.data)\r\n});\r\n\r\nexport default connect(mapStateToProps)(RemoteMediaManager);\r\n","import React from 'react';\r\nimport {connect} from 'react-redux';\r\nimport GenericMediaCard from '../GenericMediaCard/GenericMediaCard';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {Box} from '@material-ui/core';\r\nimport RemoteMediaManager from './RemoteMediaManager/RemoteMediaManager';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  roomMediaManager: {\r\n    padding: '5px',\r\n    backgroundColor: '#f5deb340',\r\n    borderLeft: '1px solid #0000003b'\r\n  }\r\n}));\r\n\r\nconst RoomMediaManager = ({ localStream, localPeerMetadata }) => {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Box bgcolor='lightblue' width={'220px'} minWidth={'150px'} className={classes.roomMediaManager}>\r\n      <GenericMediaCard stream={localStream} muted={true} user={{ nickname: localPeerMetadata.nickname }}/>\r\n      <RemoteMediaManager/>\r\n    </Box>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n  const socket = state.localUser.socket;\r\n  const localStream = socket ? state.streams.data[socket.id] : null;\r\n  return {\r\n    localPeerMetadata: state.localUser.metadata,\r\n    localStream: localStream\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, {})(RoomMediaManager);\r\n","import React, {useState} from 'react';\r\nimport {makeStyles, ThemeProvider} from '@material-ui/core/styles';\r\nimport {List, ListItem, ListItemIcon, ListItemText, Divider, Button, Drawer} from '@material-ui/core';\r\nimport LabelIcon from '@material-ui/icons/Label';\r\nimport WidgetsOutlinedIcon from '@material-ui/icons/WidgetsOutlined';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport theme from '../../../style/theme/MainTheme';\r\nimport {setPlugin} from '../../../store/actions/plugin.actions';\r\nimport {connect} from 'react-redux';\r\n\r\nconst useStyles = makeStyles({\r\n  list: {\r\n    width: 250\r\n  },\r\n  menuIcon: {\r\n    margin: '8px'\r\n  }\r\n});\r\n\r\n// TODO this data will be served by the backend in future releases. Not real plugins except first one in the list\r\nconst plugins = [\r\n  { name: 'Random number', url: 'https://andreas-schoch.github.io/p2p-test-plugin/' },\r\n  { name: 'Paint', url: 'https://andreas-schoch.github.io/quackamole-plugin-paint/' },\r\n  { name: 'Gomoku', url: 'https://derpmasters.github.io/quackamole-plugin-gomoku/' },\r\n  { name: '2d Shooter (WIP)', url: 'https://andreas-schoch.github.io/quackamole-plugin-2d-topdown-shooter/' },\r\n  { name: 'Breakout game', url: 'https://andreas-schoch.github.io/breakout-game/' }\r\n];\r\n\r\nconst RoomSidebarMenu = ({ plugin, setPlugin }) => {\r\n  const classes = useStyles();\r\n  const [open, setOpen] = useState(false);\r\n\r\n  const toggleDrawer = (event) => {\r\n    if (event.type === 'keydown') {\r\n      return;\r\n    }\r\n    setOpen(!open);\r\n  };\r\n\r\n  const handleSelectPlugin = (evt) => {\r\n    const index = evt.currentTarget.dataset.index;\r\n    setPlugin(plugin ? { ...plugin, ...plugins[index] } : plugins[index]);\r\n  };\r\n\r\n  const list = () => (\r\n    <div className={classes.list} role=\"presentation\" onClick={toggleDrawer}>\r\n      <List>\r\n        {plugins.map(({ name }, i) => (\r\n          <ListItem button key={name} onClick={handleSelectPlugin} data-index={i}>\r\n            <ListItemIcon><LabelIcon/></ListItemIcon>\r\n            <ListItemText primary={name}/>\r\n          </ListItem>\r\n        ))}\r\n      </List>\r\n      <Divider/>\r\n      <List>\r\n        <ListItem button>\r\n          <ListItemIcon><WidgetsOutlinedIcon/></ListItemIcon>\r\n          <ListItemText primary={'Browse Plugins'}/>\r\n        </ListItem>\r\n      </List>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <Button>\r\n        <MenuIcon onClick={toggleDrawer} color='primary' fontSize='large' className={classes.menuIcon}/>\r\n        <Drawer open={open} onClose={toggleDrawer} anchor={'left'}>\r\n          {list()}\r\n        </Drawer>\r\n      </Button>\r\n    </ThemeProvider>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state) => ({\r\n  plugin: state.plugin\r\n});\r\n\r\nexport default connect(mapStateToProps, { setPlugin })(RoomSidebarMenu);\r\n","import React from 'react';\r\nimport cx from 'clsx'; // TODO This comes from some example code, it has some nice features but we need to discuss whether we want to use it\r\nimport {withStyles} from '@material-ui/core/styles';\r\nimport {Avatar, Grid, Typography} from '@material-ui/core';\r\nimport defaultChatMsgStyles from './ChatStyle';\r\n\r\nconst ChatMsg = withStyles(defaultChatMsgStyles, { name: 'ChatMsg' })(props => {\r\n  const {\r\n    classes,\r\n    avatar,\r\n    messages,\r\n    side,\r\n    GridContainerProps,\r\n    GridItemProps,\r\n    AvatarProps,\r\n    getTypographyProps\r\n  } = props;\r\n\r\n  const attachClass = index => {\r\n    if (index === 0) {\r\n      return classes[`${side}First`];\r\n    }\r\n    if (index === messages.length - 1) {\r\n      return classes[`${side}Last`];\r\n    }\r\n    return '';\r\n  };\r\n  return (\r\n    <Grid container spacing={2} justify={side === 'right' ? 'flex-end' : 'flex-start'}{...GridContainerProps} className={classes.wrapper}>\r\n      {side === 'left' && (\r\n        <Grid item {...GridItemProps}>\r\n          <Avatar src={avatar}{...AvatarProps} className={cx(classes.avatar, AvatarProps.className)}/>\r\n        </Grid>\r\n      )}\r\n      <Grid item xs={8}>\r\n        {messages.map((msg, i) => {\r\n          const TypographyProps = getTypographyProps(msg, i, props);\r\n          return (\r\n            <div key={msg.id || i} className={classes[`${side}Row`]}>\r\n              <Typography align={'left'} {...TypographyProps} className={cx(classes.msg, classes[side], attachClass(i), TypographyProps.className)}>\r\n                {msg}\r\n              </Typography>\r\n            </div>\r\n          );\r\n        })}\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n});\r\n\r\nChatMsg.defaultProps = {\r\n  avatar: '',\r\n  messages: [],\r\n  side: 'left',\r\n  GridContainerProps: {},\r\n  GridItemProps: {},\r\n  AvatarProps: {},\r\n  getTypographyProps: () => ({})\r\n};\r\n\r\nexport default ChatMsg;\r\n","export default ({ palette, spacing }) => {\r\n  const radius = spacing(2.5);\r\n  const size = spacing(4);\r\n  const rightBgColor = palette.primary.main;\r\n  return {\r\n    wrapper: {\r\n      '&:nth-child(1)': {\r\n        marginTop: 'auto' // https://bugs.chromium.org/p/chromium/issues/detail?id=411624\r\n      }\r\n    },\r\n    avatar: {\r\n      width: size,\r\n      height: size\r\n    },\r\n    leftRow: {\r\n      textAlign: 'left'\r\n    },\r\n    rightRow: {\r\n      textAlign: 'right'\r\n    },\r\n    msg: {\r\n      padding: spacing(1, 2),\r\n      borderRadius: 4,\r\n      marginBottom: 4,\r\n      display: 'inline-block',\r\n      wordBreak: 'break-word',\r\n      fontFamily:\r\n        '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\"',\r\n      fontSize: '14px'\r\n    },\r\n    left: {\r\n      borderTopRightRadius: radius,\r\n      borderBottomRightRadius: radius,\r\n      backgroundColor: palette.grey[100]\r\n    },\r\n    right: {\r\n      borderTopLeftRadius: radius,\r\n      borderBottomLeftRadius: radius,\r\n      backgroundColor: rightBgColor,\r\n      color: palette.common.white\r\n    },\r\n    leftFirst: {\r\n      borderTopLeftRadius: radius\r\n    },\r\n    leftLast: {\r\n      borderBottomLeftRadius: radius\r\n    },\r\n    rightFirst: {\r\n      borderTopRightRadius: radius\r\n    },\r\n    rightLast: {\r\n      borderBottomRightRadius: radius\r\n    }\r\n  };\r\n};\r\n","import React, {useEffect, useRef, useState} from 'react';\r\nimport ChatMsg from './ChatMsg';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {TextField} from '@material-ui/core';\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport {connect} from 'react-redux';\r\nimport {sendMessage} from '../../../../store/actions/chat.actions';\r\n// import {toArray} from 'react-emoji-render';\r\n\r\nconst useStyles = makeStyles({\r\n  chat: {\r\n    height: '100vh',\r\n    display: 'flex',\r\n    flexFlow: 'column nowrap',\r\n    width: '320px'\r\n  },\r\n  chatFeed: {\r\n    display: 'flex',\r\n    flexFlow: 'column nowrap',\r\n    flexGrow: 1,\r\n    maxHeight: 'calc(100% - 60px)',\r\n    overflow: 'auto',\r\n    padding: '8px'\r\n  },\r\n  chatInput: {\r\n    display: 'flex',\r\n    flexFlow: 'row nowrap',\r\n    alignItems: 'flex-end',\r\n    padding: '8px'\r\n  },\r\n  chatInputTextfield: {\r\n    flexGrow: 1,\r\n    zIndex: 1000,\r\n    backgroundColor: 'white'\r\n  },\r\n  chatInputSendBtn: {\r\n    fontSize: '40px',\r\n    margin: 'auto 5px',\r\n    cursor: 'pointer',\r\n    opacity: 0.8,\r\n    transition: 'opacity 0.2s',\r\n    '&:hover': {\r\n      opacity: 0.95\r\n    }\r\n  }\r\n});\r\n\r\nconst Chat = ({ chatData, sendMessage, socket }) => {\r\n  const classes = useStyles('');\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const feedRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (feedRef.current) {\r\n      feedRef.current.scrollTop = feedRef.current.scrollHeight;\r\n    }\r\n  }, [chatData]);\r\n\r\n  const handleChangeTexfield = (event) => {\r\n    setNewMessage(event.target.value);\r\n  };\r\n\r\n  const handleKeyPress = (event) => {\r\n    if (event.key === 'Enter') {\r\n      if (event.shiftKey) {\r\n        setNewMessage(newMessage.concat('\\n'));\r\n      } else {\r\n        send(event);\r\n      }\r\n    }\r\n  };\r\n\r\n  const send = (e) => {\r\n    e.preventDefault();\r\n    if (newMessage.replace(/\\n/g, '').length) {\r\n      sendMessage(newMessage);\r\n      setNewMessage('');\r\n    }\r\n  };\r\n\r\n  // const parseEmojis = value => {\r\n  //   // toArray outputs React elements for emojis and strings for other\r\n  //   return toArray(value).reduce((previous, current) => {\r\n  //     if (typeof current === 'string') {\r\n  //       return previous + current;\r\n  //     }\r\n  //     return previous + current.props.children;\r\n  //   }, '');\r\n  // };\r\n\r\n  //handle the chat feed to display all messages on the right position\r\n  const chatMessages = chatData.map((message, i) => message.authorSocketId === socket.id\r\n    ? <ChatMsg key={i} side={'right'} messages={[message.text]}/>\r\n    : <ChatMsg key={i} avatar={''} messages={[message.text]}/>\r\n  );\r\n\r\n  return (\r\n    <div className={classes.chat}>\r\n\r\n      <div className={classes.chatFeed} ref={feedRef}>\r\n        {chatMessages}\r\n      </div>\r\n\r\n      <div className={classes.chatInput}>\r\n        <TextField\r\n          variant=\"outlined\"\r\n          multiline\r\n          rowsMax={5}\r\n          className={classes.chatInputTextfield}\r\n          onChange={handleChangeTexfield}\r\n          onKeyPress={handleKeyPress}\r\n          value={newMessage}\r\n          autoFocus\r\n        />\r\n        <SendIcon className={classes.chatInputSendBtn} onClick={send}/>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = state => ({\r\n  chatData: state.chat,\r\n  socket: state.localUser.socket\r\n});\r\n\r\nexport default connect(mapStateToProps, { sendMessage })(Chat);\r\n","import {ADD_NEW_MESSAGE} from '../actionTypes';\r\nimport {sendDataToConnection} from './connections.actions';\r\n\r\nexport const sendMessage = (text) => async (dispatch, getState) => {\r\n  const connections = Object.values(getState().connections.data);\r\n  const socket = getState().localUser.socket;\r\n\r\n  if (socket) {\r\n    connections.forEach(connection => {\r\n      // FIXME change to use separate data channel only for chat instead of identifying it by type or specific properties\r\n      const message = {\r\n        textMessage: { text: text, authorSocketId: socket.id }\r\n      };\r\n\r\n      dispatch(sendDataToConnection(connection.defaultDataChannel, message));\r\n    });\r\n\r\n    dispatch({\r\n      type: ADD_NEW_MESSAGE,\r\n      payload: { text: text, authorSocketId: socket.id }\r\n    });\r\n  } else {\r\n    console.error('socket not found');\r\n  }\r\n};\r\n","import React, {useState} from 'react';\r\nimport {ThemeProvider} from '@material-ui/core/styles';\r\nimport {Button, Drawer} from '@material-ui/core';\r\nimport ChatIcon from '@material-ui/icons/Chat';\r\nimport theme from '../../../style/theme/MainTheme';\r\nimport Chat from './Chat/Chat';\r\n\r\nconst RoomSidebarChat = () => {\r\n  const [open, setOpen] = useState(false);\r\n\r\n  const toggleDrawer = _ => setOpen(!open);\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <Button onClick={toggleDrawer}>\r\n        <ChatIcon color='primary' fontSize='large'/>\r\n      </Button>\r\n      <Drawer open={open} onClose={toggleDrawer} anchor={'right'}>\r\n        <Chat/>\r\n      </Drawer>\r\n    </ThemeProvider>\r\n  );\r\n};\r\n\r\nexport default RoomSidebarChat;\r\n","import React from 'react';\r\nimport {Box, Button} from '@material-ui/core';\r\nimport HomeIcon from '@material-ui/icons/Home';\r\nimport RoomSidebarMenu from '../RoomSidebarMenu/RoomSidebarMenu';\r\nimport RoomSidebarChat from '../RoomSidebarChat/RoomSidebarChat';\r\nimport {Link} from 'react-router-dom';\r\n\r\n// TODO actionbar needs some rework.\r\nconst RoomActionbar = () => {\r\n  return (\r\n    <Box\r\n      bgcolor={'#f5deb3eb'}\r\n      height={'10%'}\r\n      display='flex'\r\n      justifyContent={'center'}\r\n      borderTop={'1px solid #0000003b'}\r\n      alignItems={'center'}\r\n    >\r\n      <RoomSidebarMenu/>\r\n      <Link to={'/'} style={{ height: '100%' }}>\r\n        <Button style={{ height: '100%' }}>\r\n          <HomeIcon color='primary' fontSize='large'/>\r\n        </Button>\r\n      </Link>\r\n      <RoomSidebarChat/>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default RoomActionbar;\r\n","import React, {useEffect} from 'react';\r\nimport {Box} from '@material-ui/core';\r\nimport RoomPluginContent from './RoomPluginContent/RoomPluginContent';\r\nimport RoomMediaManager from './RoomMediaManager/RoomMediaManager';\r\nimport {connect} from 'react-redux';\r\nimport {joinRoom} from '../../store/actions/connections.actions';\r\nimport {initLocalUser} from '../../store/actions/localUser.actions';\r\nimport RoomActionbar from './RoomActionbar/RoomActionbar';\r\nimport {roomExitCleanup} from '../../store/actions/room.actions';\r\nimport {startLocalStream} from '../../store/actions/streams.actions';\r\n\r\nconst Room = ({ socket, match, history, initLocalUser, joinRoom, roomError, currentRoom, localPeerLoading, roomExitCleanup, startLocalStream }) => {\r\n\r\n  useEffect(() => {\r\n    if (roomError) {\r\n      history.push(`/room-lobby/${match.params.roomId}`);\r\n    } else if (!socket && !localPeerLoading) {\r\n      console.log('Room#useEffect before initLocalUser');\r\n      initLocalUser();\r\n    } else if (socket && socket.id && !currentRoom.id) {\r\n      console.log('Room#useEffect before joinRoom');\r\n      startLocalStream();\r\n      joinRoom(match.params.roomId, 'dummy123');\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [roomError, socket]);\r\n\r\n  useEffect(() => {\r\n    // unmount\r\n    return () => roomExitCleanup();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return (\r\n    <>\r\n      <Box display='flex' flexDirection='column' width={1} height={'100%'} justifyContent={'space-between'}>\r\n        <Box display='flex' flexDirection='row' width={1} height={'90%'} justifyContent={'space-between'}>\r\n          <RoomPluginContent/>\r\n          <RoomMediaManager/>\r\n        </Box>\r\n        <RoomActionbar/>\r\n      </Box>\r\n    </>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    socket: state.localUser.socket,\r\n    localPeerLoading: state.localUser.loading,\r\n    roomError: state.room.error,\r\n    currentRoom: state.room.data\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, { initLocalUser, joinRoom, roomExitCleanup, startLocalStream })(Room);\r\n","import React from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {Typography, useMediaQuery} from '@material-ui/core';\r\nimport AssessmentOutlinedIcon from '@material-ui/icons/AssessmentOutlined';\r\nimport CallOutlinedIcon from '@material-ui/icons/CallOutlined';\r\nimport VideogameAssetIcon from '@material-ui/icons/VideogameAsset';\r\n\r\nconst useStyles = makeStyles({\r\n  container: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    width: 314,\r\n    height: 400,\r\n    border: 'solid 1px lightgrey',\r\n    backgroundColor: 'white'\r\n  },\r\n  smallScreenContainer: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    width: 314,\r\n    height: 400,\r\n    border: 'solid 1px lightgrey',\r\n    backgroundColor: 'white',\r\n    margin: 8\r\n  },\r\n  alignTitle: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    margin: 24\r\n  },\r\n  customizeTitle: {\r\n    fontWeight: 'bold',\r\n    fontSize: '25px',\r\n    marginLeft: 4\r\n  },\r\n  customizeIcon: {\r\n    marginRight: 4,\r\n    color: 'rgb(46, 125, 50)'\r\n  },\r\n  customizeText: {\r\n    paddingLeft: 16,\r\n    paddingRight: 16,\r\n    marginBottom: 16\r\n  }\r\n});\r\n\r\nconst BulletPoint = (props) => {\r\n  const classes = useStyles();\r\n  const smallScreen = useMediaQuery('(max-width: 950px)');\r\n\r\n  const checkIcons = (icon) => {\r\n    if (icon === 'VideogameAssetIcon') {\r\n      return <VideogameAssetIcon fontSize='large' className={classes.customizeIcon}/>;\r\n    } else if (icon === 'AssessmentOutlinedIcon') {\r\n      return <AssessmentOutlinedIcon fontSize='large' className={classes.customizeIcon}/>;\r\n    } else if (icon === 'CallOutlinedIcon') {\r\n      return <CallOutlinedIcon fontSize='large' className={classes.customizeIcon}/>;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={smallScreen ? classes.smallScreenContainer : classes.container}>\r\n      <div className={classes.alignTitle}>\r\n        {checkIcons(props.content.icon)}\r\n        <Typography variant='h4' className={classes.customizeTitle}>{props.content.title}</Typography>\r\n      </div>\r\n      <Typography className={classes.customizeText} align='center'>{props.content.text}</Typography>\r\n      <img src={props.content.image} height='181' width='275' alt='icon'/>\r\n    </div>\r\n  );\r\n};\r\nexport default BulletPoint;\r\n","import React from 'react';\r\nimport {makeStyles, ThemeProvider} from '@material-ui/core/styles';\r\nimport {Typography, Box, Button, useMediaQuery} from '@material-ui/core';\r\nimport theme from '../../style/theme/MainTheme';\r\nimport {Link} from 'react-router-dom';\r\nimport BulletPoint from './BulletPoint/BulletPoint';\r\n\r\nconst useStyles = makeStyles({\r\n  header: {\r\n    color: 'white',\r\n    textTransform: 'uppercase',\r\n    display: 'flex',\r\n    justifyContent: 'center',\r\n    alignItems: 'center'\r\n  },\r\n  box: {\r\n    display: 'flex',\r\n    width: '100%',\r\n    height: '100%',\r\n    justifyContent: 'center'\r\n  },\r\n  smallScreenBox: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    width: '100%',\r\n    height: '100%',\r\n    alignItems: 'center'\r\n  },\r\n  titleContainer: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    width: '40%',\r\n    minWidth: 310\r\n  },\r\n  titleStyle: {\r\n    color: 'white',\r\n    fontWeight: 'bold',\r\n    marginTop: '98px'\r\n  },\r\n  buttonStyle: {\r\n    borderRadius: '5px',\r\n    // width: '106px',\r\n    fontWeight: 'bold',\r\n    color: 'white',\r\n    backgroundColor: '#FBC02D',\r\n    '&:hover': {\r\n      backgroundColor: '#f9a825'\r\n    },\r\n    '&:focus': {\r\n      outline: 0\r\n    }\r\n  },\r\n  mainImg: {\r\n    display: 'flex',\r\n    height: 224,\r\n    width: 309,\r\n    borderRadius: 5,\r\n    marginTop: 76,\r\n    marginLeft: 36,\r\n    marginRight: 36\r\n  },\r\n  smallScreenMainImg: {\r\n    display: 'flex',\r\n    height: 224,\r\n    width: 309,\r\n    borderRadius: 5,\r\n    margin: 36\r\n  },\r\n  bulletPoints: {\r\n    display: 'flex',\r\n    justifyContent: 'center',\r\n    zIndex: '3',\r\n    position: 'relative',\r\n    bottom: 150\r\n  },\r\n  smallScreenBulletPoints: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    marginTop: 72\r\n  }\r\n});\r\n\r\nconst Home = () => {\r\n  const classes = useStyles();\r\n  const smallScreen = useMediaQuery('(max-width: 950px)');\r\n  const bulletPoints = [\r\n    {\r\n      title: 'Gaming',\r\n      icon: 'VideogameAssetIcon',\r\n      image: 'https://via.placeholder.com/400x300',\r\n      text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec nec urna dolor. Maecenas vehicula dui ut quam imperdiet.'\r\n    },\r\n    {\r\n      title: 'Working',\r\n      icon: 'AssessmentOutlinedIcon',\r\n      image: 'https://via.placeholder.com/400x300',\r\n      text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec nec urna dolor. Maecenas vehicula dui ut quam imperdiet.'\r\n    },\r\n    {\r\n      title: 'Chatting',\r\n      icon: 'CallOutlinedIcon',\r\n      image: 'https://via.placeholder.com/400x300',\r\n      text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec nec urna dolor. Maecenas vehicula dui ut quam imperdiet.'\r\n    }\r\n  ];\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      {/* Header */}\r\n      <Box height={63} bgcolor='#2E7D32' className={classes.header}>\r\n        <h1>\r\n          <span role={'img'} aria-label={'a duck'}>🦆 </span>\r\n          Quackamole\r\n          <span role={'img'} aria-label={'an avocado'}> 🥑</span>\r\n        </h1>\r\n      </Box>\r\n\r\n      {/* Body */}\r\n      <Box height={540} display='flex' zIndex={1}>\r\n        <Box className={smallScreen ? classes.smallScreenBox : classes.box} bgcolor='#388E3C'>\r\n          <div className={classes.titleContainer}>\r\n            <Typography variant='h3' className={classes.titleStyle} gutterBottom align='center'>\r\n              Peer-to-peer video chat platform\r\n            </Typography>\r\n            <Link to=\"/create-room\" style={{ textDecoration: 'none' }}>\r\n              <Button size=\"large\" className={classes.buttonStyle}>Create a room</Button>\r\n            </Link>\r\n          </div>\r\n          <img\r\n            src='https://via.placeholder.com/400x300'\r\n            className={smallScreen ? classes.smallScreenMainImg : classes.mainImg}\r\n            alt={'quackamole room preview'}\r\n          />\r\n        </Box>\r\n      </Box>\r\n\r\n      {/* Bullet Points */}\r\n      <div className={smallScreen ? classes.smallScreenBulletPoints : classes.bulletPoints}>\r\n        {bulletPoints.map((data, i) => <BulletPoint content={data} key={data.title + i}> </BulletPoint>)}\r\n      </div>\r\n\r\n      {/*Temporary for debugging purposes*/}\r\n      <Link to={'/rooms/dummy-room-id'}>Test room</Link>\r\n    </ThemeProvider>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n","import React, {useState} from 'react';\r\nimport {Link, useHistory} from 'react-router-dom';\r\nimport {makeStyles, ThemeProvider} from '@material-ui/core/styles';\r\nimport {Box, Button, Grid, TextField, Typography} from '@material-ui/core';\r\nimport theme from '../../style/theme/MainTheme';\r\nimport ArrowBackIosIcon from '@material-ui/icons/ArrowBackIos';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport {BACKEND_URL} from '../../constants';\r\n\r\nconst useStyles = makeStyles({\r\n  containerStyle: {\r\n    display: 'flex',\r\n    justifyContent: 'center',\r\n    paddingTop: '128px'\r\n  },\r\n  titleStyle: {\r\n    display: 'flex',\r\n    justifyContent: 'center',\r\n    padding: '16px',\r\n    color: 'white',\r\n    fontWeight: 'bold',\r\n    backgroundColor: '#388E3C',\r\n    width: '100%'\r\n  },\r\n  formControl: {\r\n    width: '20%',\r\n    margin: '16px'\r\n  },\r\n  select: {\r\n    borderColor: '#FB8C00',\r\n    '&:before': {\r\n      borderColor: '#FB8C00'\r\n    },\r\n    '&:after': {\r\n      borderColor: '#f57c00'\r\n    }\r\n  },\r\n  textfield: {\r\n    width: '90%',\r\n    marginTop: '48px'\r\n  },\r\n  textfieldLink: {\r\n    width: '90%',\r\n    marginRight: '16px',\r\n    marginLeft: '16px'\r\n  },\r\n  alignButton: {\r\n    display: 'flex',\r\n    justifyContent: 'flex-end',\r\n    width: '100%',\r\n    padding: '16px'\r\n  },\r\n  btnCreateWrapper: {\r\n    position: 'relative'\r\n  },\r\n  btnCreate: {\r\n    color: 'white',\r\n    boxShadow: 'none',\r\n  },\r\n  fabProgress: {\r\n    position: 'absolute',\r\n    top: -6,\r\n    left: -6,\r\n    zIndex: 1,\r\n  },\r\n  btnCreateProgress: {\r\n    position: 'absolute',\r\n    top: '50%',\r\n    left: '50%',\r\n    marginTop: -12,\r\n    marginLeft: -12,\r\n  },\r\n  paper: {\r\n    padding: theme.spacing(2),\r\n    textAlign: 'center',\r\n    color: theme.palette.text.secondary\r\n  },\r\n  copyLink: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    marginTop: '16px',\r\n    width: '90%'\r\n  },\r\n  nextButton: {\r\n    color: 'white',\r\n    boxShadow: 'none',\r\n    marginBottom: '16px',\r\n    width: '100%'\r\n  },\r\n  subtitle: {\r\n    display: 'flex',\r\n    justifyContent: 'center',\r\n    margin: '16px'\r\n  }\r\n});\r\n\r\nconst RoomCreateForm = () => {\r\n  const [name, setName] = useState('');\r\n  const [link, setLink] = useState('');\r\n  const [roomId, setRoomId] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const classes = useStyles();\r\n  const history = useHistory();\r\n\r\n  const handleChangeTexfield = (event) => {\r\n    setName(event.target.value);\r\n  };\r\n\r\n  const handleKeyPress = async (evt) => {\r\n    if (!loading && evt.key === 'Enter') {\r\n        if (!roomId) {\r\n          const room = await createRoom();\r\n\r\n          if (room) {\r\n            setError(null);\r\n            setRoomId(room.id);\r\n            setLink(`${window.location.origin}/#/room-lobby/${room.id}`);\r\n          }\r\n      } else if (!error && roomId) {\r\n        history.push(`/room-lobby/${roomId}`);\r\n      }\r\n\r\n\r\n    }\r\n  };\r\n\r\n  const createRoom = async () => {\r\n    try {\r\n      let data = {\r\n        name: name,\r\n        password: 'Test123.',\r\n        maxUsers: 4\r\n      };\r\n\r\n      if (data.name.length === 0) {\r\n        setError(new Error('The room needs a name'));\r\n        return;\r\n      }\r\n\r\n      setLoading(true);\r\n      const res = await fetch(`${BACKEND_URL}/api/rooms`, {\r\n        method: 'post',\r\n        body: JSON.stringify(data),\r\n        headers: { 'Content-Type': 'application/json' }\r\n      });\r\n      setLoading(false);\r\n\r\n      if (res.status >= 400) {\r\n        setError(new Error(`Something went wrong. Try again`));\r\n        return;\r\n      }\r\n\r\n      return await res.json();\r\n    } catch (err) {\r\n      setError(err);\r\n    }\r\n  };\r\n\r\n  const createRoomJSX =\r\n    <Box display='flex' flexDirection='column' alignItems='center' width={'100%'} borderRadius='5px' bgcolor='white'>\r\n      <Typography variant='h4' className={classes.titleStyle}>Create a new room</Typography>\r\n      <TextField\r\n        required\r\n        label='Room name'\r\n        variant='outlined'\r\n        value={name}\r\n        onChange={handleChangeTexfield}\r\n        className={classes.textfield}\r\n        onKeyPress={handleKeyPress}\r\n        autoFocus\r\n      />\r\n      <div className={classes.alignButton}>\r\n        <div className={classes.btnCreateWrapper}>\r\n          <Button\r\n            size='large'\r\n            color='secondary'\r\n            variant='contained'\r\n            disabled={loading}\r\n            className={classes.btnCreate}\r\n            onClick={createRoom}\r\n          >\r\n            Create\r\n          </Button>\r\n            {loading && <CircularProgress size={24} className={classes.btnCreateProgress}/>}\r\n        </div>\r\n      </div>\r\n    </Box>;\r\n\r\n  const shareRoomJSX =\r\n    <Box\r\n      display='flex'\r\n      flexDirection='column'\r\n      alignItems='center'\r\n      width={'100%'}\r\n      borderRadius='5px'\r\n      bgcolor='white'\r\n      onKeyPress={handleKeyPress}\r\n    >\r\n      <Typography variant='h4' className={classes.titleStyle}>Room was created</Typography>\r\n      <div className={classes.copyLink}>\r\n        <TextField variant='outlined' value={link} onChange={handleChangeTexfield} className={classes.textfieldLink} minWidth={300} autoFocus/>\r\n        <Button size='large' color='secondary' variant='contained' className={classes.myButton} onClick={() => {\r\n          navigator.clipboard.writeText(link);\r\n        }}>\r\n          copy\r\n        </Button>\r\n      </div>\r\n      <Typography variant='h6' align='center' className={classes.subtitle}>\r\n        Share the link to invite someones to your room\r\n      </Typography>\r\n\r\n      <Link to={`/room-lobby/${roomId}`} style={{ textDecoration: 'none', width: '80%' }}>\r\n        <Button\r\n          size='large'\r\n          color='secondary'\r\n          variant='contained'\r\n          className={classes.nextButton}\r\n          to={`/room-lobby/${roomId}`}\r\n        >\r\n          next\r\n        </Button>\r\n      </Link>\r\n    </Box>;\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      {/* Header */}\r\n      <Box\r\n        display='flex'\r\n        height={63}\r\n        bgcolor='#2E7D32'\r\n        alignItems='center'\r\n        paddingLeft='36px'\r\n      >\r\n        <Link to='/' style={{ textDecoration: 'none', color: 'white' }}>\r\n          <ArrowBackIosIcon/>\r\n        </Link>\r\n      </Box>\r\n\r\n      {/* Body */}\r\n      <Grid container className={classes.containerStyle}>\r\n        <Grid item xs={11} md={6} lg={6}>\r\n        {roomId ? shareRoomJSX : createRoomJSX}\r\n          {error && <Box color={'red'} textAlign={'center'}>{error.message}</Box>}\r\n        </Grid>\r\n      </Grid>\r\n    </ThemeProvider>\r\n  );\r\n};\r\n\r\nexport default RoomCreateForm;\r\n","import React from 'react';\r\nimport {HashRouter as Router, Route, Switch} from 'react-router-dom';\r\nimport {CssBaseline} from '@material-ui/core';\r\nimport RoomLobby from '../RoomLobby/RoomLobby';\r\nimport Room from '../Room/Room';\r\nimport Home from '../Home/Home';\r\nimport RoomCreateForm from '../RoomCreateForm/RoomCreateForm';\r\n\r\nconst App = () => {\r\n  return (\r\n    <CssBaseline>\r\n      <Router>\r\n        <Switch>\r\n          <Route exact path='/' component={Home}/>\r\n          <Route exact path='/create-room' component={RoomCreateForm}/>\r\n          <Route exact path='/room-lobby/:roomId' component={RoomLobby}/>\r\n          <Route path='/rooms/:roomId' component={Room}/>\r\n        </Switch>\r\n      </Router>\r\n    </CssBaseline>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport './index.scss';\r\nimport ReactDOM from 'react-dom';\r\nimport {Provider} from 'react-redux';\r\nimport store from './store';\r\nimport App from './components/App/App';\r\n// eslint-disable-next-line\r\nimport adapter from 'webrtc-adapter'; // insulates app from browser webrtc implementation differences\r\n\r\nReactDOM.render(\r\n  <>\r\n    <Provider store={store}>\r\n      <App/>\r\n    </Provider>\r\n  </>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}