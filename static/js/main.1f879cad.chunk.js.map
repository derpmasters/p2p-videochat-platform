{"version":3,"sources":["store/reducers/room.reducer.js","store/actionTypes.js","store/reducers/peers.reducer.js","store/reducers/connections.reducer.js","store/reducers/calls.reducer.js","store/reducers/index.js","store/index.js","components/RoomLobby/RoomLobby.jsx","components/Room/Room.jsx","components/Home/Home.jsx","components/RoomCreateForm/RoomCreateForm.jsx","components/TestRoom/TestStreamManager/VideoCard/VideoCard.jsx","components/TestRoom/TestStreamManager/TestStreamManager.jsx","components/TestRoom/TestRoom.jsx","store/actions/connections.actions.js","utils.js","constants.js","components/App/App.jsx","index.jsx","../node_modules/peerjs/dist sync"],"names":["initialState","data","id","name","peers","connections","calls","error","roomReducer","room","action","type","payload","Object","keys","nickname","peerId","connection","call","peersReducer","connectionsReducer","connectionId","newData","entries","filter","conn","callsReducer","reducer","combineReducers","store","createStore","composeWithDevTools","applyMiddleware","thunk","RoomLobby","Room","Home","to","RoomCreateForm","VideoCard","localPeer","localStream","useState","remoteStream","setRemoteStream","videoRef","useRef","handleOnStream","on","remoteMediaStream","console","log","useEffect","answer","current","srcObject","oncanplay","play","muted","onClick","peer","ref","connect","state","values","setLocalStream","startLocalStream","a","navigator","mediaDevices","getUserMedia","video","audio","mediaStream","map","addConnection","dispatch","getState","addConnectionAction","socket","setSocket","setLocalPeer","message","roomId","password","inputState","setInputState","initConnectionListeners","parsedData","JSON","parse","textMessage","author","text","object","io","secure","query","key","value","join","socketId","connectionWithLeavingUser","close","initSocket","customPeerId","Peer","host","port","path","debug","config","iceServers","url","initPeer","emit","connectWithPeer","remotePeerId","e","maxConnections","joinedUsers","forEach","listAllPeers","onSubmit","preventDefault","send","stringify","sendMessage","aria-label","onChange","target","placeholder","App","CssBaseline","exact","component","TestRoom","ReactDOM","render","document","getElementById","webpackEmptyContext","req","Error","code","resolve","module","exports"],"mappings":"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","file":"static/js/main.1f879cad.chunk.js","sourcesContent":["import {SET_CALLS, ADD_CONNECTION, SET_CURRENT_ROOM, SET_CURRENT_ROOM_ERROR, SET_PEERS} from '../actionTypes';\r\n\r\nconst initialState = {\r\n    data: {\r\n        id: 'dummy-room-id',\r\n        name: 'Dummy Room',\r\n        peers: [\r\n            'd7f7saim3',\r\n            '32mfdnmio',\r\n        ],\r\n        connections: [\r\n            'd7f7saim3',\r\n            '32mfdnmio',\r\n        ],\r\n        calls: [\r\n            'd7f7saim3',\r\n            '32mfdnmio',\r\n        ]\r\n    },\r\n    error: null\r\n};\r\n\r\nconst roomReducer = (room = initialState, action) => {\r\n    switch (action.type) {\r\n        case SET_CURRENT_ROOM: {\r\n            return {data: action.payload.room, error: null};\r\n        }\r\n        case SET_CURRENT_ROOM_ERROR: {\r\n            return {data: room.data, error: action.payload.error};\r\n        }\r\n        case SET_PEERS: {\r\n            const peers = Object.keys(action.payload.peers);\r\n            return {data: room.data, peers, error: null};\r\n        }\r\n        case ADD_CONNECTION: {\r\n            // const connections = Object.keys(action.payload.connections);\r\n            // return {data: room.data, connections, error: null};\r\n            return room;\r\n        }\r\n        case SET_CALLS: {\r\n            const calls = Object.keys(action.payload.calls);\r\n            return {data: room.data, calls, error: null};\r\n        }\r\n        default: {\r\n            return room;\r\n        }\r\n    }\r\n};\r\n\r\nexport default roomReducer;\r\n","export const SET_CURRENT_ROOM = 'SET_CURRENT_ROOM';\r\nexport const SET_CURRENT_ROOM_ERROR = 'SET_CURRENT_ROOM_ERROR';\r\n\r\nexport const SET_PEERS = 'SET_PEERS';\r\nexport const SET_PEERS_ERROR = 'SET_PEERS_ERROR';\r\n\r\nexport const ADD_CONNECTION = 'ADD_CONNECTION';\r\nexport const REMOVE_CONNECTION = 'REMOVE_CONNECTION';\r\nexport const SET_CONNECTIONS_ERROR = 'SET_CONNECTIONS_ERROR';\r\n\r\nexport const SET_CALLS = 'SET_CALLS';\r\nexport const SET_CALLS_ERROR = 'SET_CALLS_ERROR';\r\n","import {ADD_CONNECTION, SET_CALLS, SET_PEERS, SET_PEERS_ERROR} from '../actionTypes';\r\n\r\nconst initialState = {\r\n    data: {\r\n        'd7f7saim3': {nickname: 'Andi', peerId: 'dscdsv-csdvsdv-dvewvew-btrbrb3', connection: 'efewfgrger', call: 'fewfewfwef'},\r\n        '32mfdnmio': {nickname: 'Jimmy', peerId: 'ztjzt-ckhjgvv-dvewvew-b3cddrv', connection: 'vverberberb', call: 'vewrverbe'}\r\n    },\r\n    error: null\r\n};\r\n\r\nconst peersReducer = (peers = initialState, action) => {\r\n    switch (action.type) {\r\n        case SET_PEERS: {\r\n            return {peers: action.payload.peers, error: null};\r\n        }\r\n        case SET_PEERS_ERROR: {\r\n            return {data: peers.data, error: action.payload.error};\r\n        }\r\n        case ADD_CONNECTION: {\r\n            // TODO iterate through peers and reference their connection id\r\n            return peers;\r\n        }\r\n        case SET_CALLS: {\r\n            // TODO iterate through peers and reference their call id\r\n            return peers;\r\n        }\r\n        default: {\r\n            return peers;\r\n        }\r\n    }\r\n};\r\n\r\nexport default peersReducer;\r\n\r\n","import {ADD_CONNECTION, REMOVE_CONNECTION, SET_CONNECTIONS_ERROR} from '../actionTypes';\r\n\r\nconst initialState = {\r\n    data: {},\r\n    error: null\r\n};\r\n\r\nconst connectionsReducer = (connections = initialState, action) => {\r\n    switch (action.type) {\r\n        case ADD_CONNECTION: {\r\n            const connection = action.payload.connection;\r\n            return {data: {...connections.data, [connection.connectionId]: connection}, error: null};\r\n        }\r\n        case REMOVE_CONNECTION: {\r\n            const newData = Object.entries(connections.data).filter(conn => conn.connectionId !== action.payload.connectionId);\r\n            return {data: newData, error: null};\r\n        }\r\n        case SET_CONNECTIONS_ERROR: {\r\n            return {...connections, error: action.payload.error};\r\n        }\r\n        default: {\r\n            return connections;\r\n        }\r\n    }\r\n};\r\n\r\nexport default connectionsReducer;\r\n\r\n","import {SET_CALLS, SET_CALLS_ERROR} from '../actionTypes';\r\n\r\nconst initialState = {\r\n    data: {},\r\n    error: null\r\n};\r\n\r\nconst callsReducer = (calls = initialState, action) => {\r\n    switch (action.type) {\r\n        case SET_CALLS: {\r\n            return {calls: action.payload.calls, error: null};\r\n        }\r\n        case SET_CALLS_ERROR: {\r\n            return {data: calls.data, error: action.payload.error};\r\n        }\r\n        default: {\r\n            return calls;\r\n        }\r\n    }\r\n};\r\n\r\nexport default callsReducer;\r\n\r\n","import { combineReducers } from 'redux';\r\nimport roomReducer from './room.reducer';\r\nimport peersReducer from './peers.reducer';\r\nimport connectionsReducer from './connections.reducer';\r\nimport callsReducer from './calls.reducer';\r\n\r\nconst reducer = combineReducers({\r\n    room: roomReducer,\r\n    peers: peersReducer,\r\n    calls: callsReducer,\r\n    connections: connectionsReducer\r\n});\r\n\r\nexport default reducer;\r\n","import { createStore, applyMiddleware } from 'redux';\r\nimport thunk from 'redux-thunk';\r\nimport { composeWithDevTools } from 'redux-devtools-extension';\r\nimport reducer from './reducers';\r\n\r\nconst store = createStore(reducer, composeWithDevTools(applyMiddleware(thunk)));\r\n\r\nexport default store;\r\n","import React from 'react';\r\n\r\nconst RoomLobby = () => {\r\n    return <div>RoomLobby</div>;\r\n};\r\n\r\nexport default RoomLobby;\r\n","import React from 'react';\r\n\r\nconst Room = () => {\r\n    return <div>Room</div>;\r\n};\r\n\r\nexport default Room;\r\n","import React from 'react';\r\nimport {Link} from \"react-router-dom\";\r\n\r\nconst Home = () => {\r\n    return <div>Home\r\n        <Link to={'test-room'} >TestRoom</Link>\r\n    </div>;\r\n};\r\n\r\nexport default Home;\r\n","import React from 'react';\r\n\r\nconst RoomCreateForm = () => {\r\n    return <div>RoomCreateForm</div>;\r\n};\r\n\r\nexport default RoomCreateForm;\r\n","import React, {useEffect, useRef, useState} from 'react';\r\n\r\nconst VideoCard = ({localPeer, localStream, connection}) => {\r\n    const [remoteStream, setRemoteStream] = useState(null);\r\n    const videoRef = useRef(null);\r\n\r\n    const handleOnStream = (call) => {\r\n        call.on('stream', remoteMediaStream => {\r\n            console.log('ONSTREAM', remoteMediaStream);\r\n            setRemoteStream(remoteMediaStream);\r\n        });\r\n    };\r\n\r\n    const initCallListeners = () => {\r\n        localPeer.on('call', call => {\r\n            call.answer(localStream);\r\n            handleOnStream(call);\r\n        });\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (localPeer && localPeer.id) {\r\n            initCallListeners();\r\n        }\r\n    }, [localPeer]);\r\n\r\n    // set src of <video> to remote stream when available\r\n    useEffect(() => {\r\n        if (videoRef.current && remoteStream) {\r\n            console.log('useEFECT srcset, remote stream', remoteStream);\r\n            videoRef.current.srcObject = remoteStream;\r\n            videoRef.current.oncanplay = () => {\r\n                videoRef.current.play();\r\n                videoRef.current.muted = false; // set to false to hear/test your own audio\r\n            };\r\n        }\r\n    }, [remoteStream]);\r\n\r\n    const handleStartCall = () => {\r\n        if (localPeer) {\r\n            const call = localPeer.call(connection.peer, localStream);\r\n            handleOnStream(call);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <button onClick={handleStartCall}>CALL this connection {connection.peer}</button>\r\n            <video ref={videoRef}/>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default VideoCard;\r\n","import React, {useCallback, useEffect, useState} from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport VideoCard from \"./VideoCard/VideoCard\";\r\n\r\nconst TestStreamManager = ({localPeer, connections}) => {\r\n    const [localStream, setLocalStream] = useState(null);\r\n\r\n    const startLocalStream = async () => {\r\n        try {\r\n            let mediaStream = await navigator.mediaDevices.getUserMedia({video: true, audio: true});\r\n            setLocalStream(mediaStream);\r\n        } catch (error) {\r\n            console.error('local stream couldnt be started via \"startStream()\"', error);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (localPeer && localPeer.id) {\r\n            startLocalStream();\r\n        }\r\n    }, [localPeer]);\r\n\r\n    return (\r\n        <div>\r\n            {localStream && connections && connections.map(connection => <VideoCard localPeer={localPeer} localStream={localStream} connection={connection}/>)}\r\n        </div>\r\n    );\r\n};\r\n\r\n\r\nconst mapStateToProps = (state) => ({\r\n    connections: Object.values(state.connections.data)\r\n});\r\n\r\nexport default  connect(mapStateToProps)(TestStreamManager);\r\n","import React, {useState, useEffect} from 'react';\r\nimport {connect} from 'react-redux'\r\nimport Peer from \"peerjs\";\r\nimport io from 'socket.io-client';\r\nimport {serializeQueryString} from \"../../utils\";\r\nimport {API_BASE_URL, PORT_SIGNALING, PORT_SOCKET} from \"../../constants\";\r\nimport {addConnection} from \"../../store/actions/connections.actions\";\r\nimport {Link} from \"react-router-dom\";\r\nimport TestStreamManager from \"./TestStreamManager/TestStreamManager\";\r\n\r\n\r\n// const calls = [];\r\nconst TestRoom = ({connections, addConnection}) => {\r\n    const [socket, setSocket] = useState(null);\r\n    const [localPeer, setLocalPeer] = useState(null);\r\n    const [remoteStreams, setRemoteStreams] = useState([]);\r\n\r\n    const [inputState, setInputState] = useState({\r\n        message: '',\r\n        roomId: 'dummy-room-id',\r\n        password: 'dummy123'\r\n    });\r\n\r\n    const initPeer = () => {\r\n        if (socket) {\r\n            const customPeerId = socket.id;\r\n            const peer = new Peer(customPeerId, {\r\n                host: API_BASE_URL,\r\n                port: PORT_SIGNALING,\r\n                path: '/peer/signal',\r\n                debug: 3,\r\n                config: {iceServers: [{url: 'stun:stun.l.google.com:19302'}]}\r\n            });\r\n\r\n            console.log('peer', customPeerId, peer);\r\n            setLocalPeer(peer);\r\n        } else {\r\n            console.log('could not create new Peer because the socket.io connection is not established yet');\r\n        }\r\n    };\r\n\r\n    const initSocket = () => {\r\n        const socket = io(`https://${API_BASE_URL}:${PORT_SOCKET}`, {\r\n            // transports: ['websocket'],\r\n            secure: true,\r\n            query: serializeQueryString({\r\n                nickname: 'andi'\r\n            })\r\n        });\r\n\r\n        socket.on('ready', (socketId) => {\r\n            setSocket(socket);\r\n        });\r\n\r\n        // Init Listeners\r\n        socket.on('user-join', (room) => {\r\n            console.log('new user joined room, he will connect to you shortly');\r\n        });\r\n\r\n        socket.on('user-leave', (data) => {\r\n            const connectionWithLeavingUser = connections[data.peerId];\r\n            console.log('user left room', data.peerId, connectionWithLeavingUser);\r\n\r\n            if (connectionWithLeavingUser) {\r\n                connectionWithLeavingUser.close();\r\n            }\r\n        });\r\n    };\r\n\r\n    const initConnectionListeners = (connection) => {\r\n        connection.on('data', data => {\r\n            const parsedData = JSON.parse(data);\r\n\r\n            if (parsedData.textMessage) {\r\n                console.log(\r\n                    `%c MESSAGE - ${parsedData.textMessage.author}: \"${parsedData.textMessage.text}\"`,\r\n                    'background: black; color: white; padding: 1rem'\r\n                );\r\n            }\r\n        });\r\n    };\r\n\r\n    useEffect(() => {\r\n        initSocket();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (localPeer) {\r\n            console.log('peer initialized: ', localPeer);\r\n\r\n            localPeer.on('open', id => {\r\n                console.log('My peer ID is: ' + localPeer.id, localPeer);\r\n            });\r\n\r\n            localPeer.on('connection', connection => {\r\n                console.log('on connection with', connection);\r\n                addConnection(connection);\r\n                initConnectionListeners(connection);\r\n            });\r\n        }\r\n    }, [localPeer]);\r\n\r\n    useEffect(() => {\r\n        if (socket && socket.id) {\r\n            initPeer();\r\n        }\r\n\r\n        // On unmount: notify other people that you left before actually disconnecting\r\n        return () => {\r\n            if (socket) {\r\n                socket.emit('leave', inputState.roomId); // TODO change id for real rooms.\r\n            }\r\n        }\r\n    }, [socket]);\r\n\r\n\r\n    const handleCreateRoom = (e) => {\r\n        socket.emit('create', {\r\n            // id: 'test-room-id',\r\n            name: 'test room name',\r\n            password: inputState.password,\r\n            maxConnections: 4\r\n        }, (data) => {\r\n            if (data) {\r\n                setInputState({...inputState, roomId: 'dummy-room-id'});\r\n            }\r\n        });\r\n    };\r\n\r\n    const handleJoinRoom = (e) => {\r\n        const {roomId, password } = inputState;\r\n        socket.emit('join', { roomId, password, peerId: localPeer.id },\r\n            // callback: the joining user himself is responsible to establish connections with other users\r\n            (data) => {\r\n            if (data) {\r\n                console.log('joined room', data);\r\n                data.room.joinedUsers.forEach((peerId) => {\r\n                    if (peerId !== localPeer.id) {\r\n                        connectWithPeer(peerId);\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    };\r\n\r\n    const handleListAllPeers = (e) => {\r\n        localPeer.listAllPeers((peers) => {\r\n            console.log('peers', peers);\r\n        });\r\n    };\r\n\r\n    const sendMessage = () => {\r\n        if (localPeer) {\r\n            const message = {textMessage: {author: 'derp', text: inputState.message} };\r\n            Object.values(connections).forEach(connection => {\r\n                console.log('send message to', connection.peer);\r\n                connection.send(JSON.stringify(message));\r\n            });\r\n        }\r\n    };\r\n\r\n    const connectWithPeer = async (remotePeerId) => {\r\n        const connection = await localPeer.connect(remotePeerId);\r\n        addConnection(connection);\r\n        initConnectionListeners(connection);\r\n    };\r\n\r\n    //////////////////\r\n    //// HANDLERS ////\r\n    //////////////////\r\n    const handleChange = e => setInputState({...inputState, [e.target.name]: e.target.value});\r\n\r\n    const handleSendMessage = e => {\r\n        e.preventDefault();\r\n        sendMessage();\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <div>\r\n                Hello world\r\n                <button onClick={handleCreateRoom}>create room</button>\r\n                <button onClick={handleJoinRoom}>join room</button>\r\n                <button onClick={handleListAllPeers}>listAllPeers room</button>\r\n                <Link to={'/'}>HOME</Link>\r\n            </div>\r\n            <div>\r\n                <form onSubmit={handleSendMessage}>\r\n                    <fieldset>\r\n                        <legend>Send Message to Peers</legend>\r\n                        <input\r\n                            type='text'\r\n                            aria-label='chat input'\r\n                            name='message'\r\n                            value={inputState.message}\r\n                            onChange={handleChange}\r\n                            placeholder='Hello Peer...'\r\n                        />\r\n                        <button type='submit'>send</button>\r\n                    </fieldset>\r\n                </form>\r\n            </div>\r\n            <TestStreamManager localPeer={localPeer} />\r\n        </>\r\n    );\r\n};\r\n\r\nconst mapStateToProps = (state) => ({\r\n    connections: state.connections.data,\r\n});\r\n\r\nexport default connect(mapStateToProps, {addConnection})(TestRoom);\r\n\r\n","import {ADD_CONNECTION} from \"../actionTypes\";\r\n\r\nconst addConnectionAction = connection => ({\r\n    type: ADD_CONNECTION,\r\n    payload: {connection}\r\n});\r\n\r\nexport const addConnection = connection => (dispatch, getState) => {\r\n    if (connection.peer && connection.connectionId) {\r\n        dispatch(addConnectionAction(connection));\r\n    }\r\n};\r\n","// The place to put all helper methods that do not necessarily belong to a specific component\r\n// Once this file gets too crowded, create an utils folder and start seperating the exported helper methods\r\n\r\n/**\r\n * Transforms a javascript object into a query string.\r\n * @param object The source object. Example: {a: 5, b: 10}\r\n * @returns {string} The resulting query string. Example 'a=5&b=10'\r\n */\r\nexport const serializeQueryString = object => {\r\n    return Object.entries(object).map(([key, value]) => `${key}=${value}`).join('&');\r\n};\r\n","export const API_BASE_URL = 'derpmasters.online'; // will use a environment variable later on\r\n// export const API_BASE_URL = 'localhost'; // uncomment for local development\r\n\r\nexport const PORT_SIGNALING = '5001';\r\nexport const PORT_SOCKET = '5002';\r\n","import React from 'react';\r\nimport { HashRouter as Router, Route, Switch } from \"react-router-dom\";\r\nimport RoomLobby from \"../RoomLobby/RoomLobby\";\r\nimport Room from \"../Room/Room\";\r\nimport Home from \"../Home/Home\";\r\nimport RoomCreateForm from \"../RoomCreateForm/RoomCreateForm\";\r\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\r\nimport TestRoom from \"../TestRoom/TestRoom\";\r\n\r\nconst App = () => {\r\n    return (\r\n        <CssBaseline>\r\n            <Router>\r\n                <Switch>\r\n                    <Route exact path='/' component={Home} />\r\n                    <Route exact path='/create-room' component={RoomCreateForm} />\r\n                    <Route exact path='/room-lobby/:roomId' component={RoomLobby} />\r\n                    <Route path='/rooms/:roomId' component={Room} />\r\n                    <Route path='/test-room' component={TestRoom} />\r\n                </Switch>\r\n            </Router>\r\n        </CssBaseline>\r\n    );\r\n};\r\n\r\nexport default App;\r\n","import React, {StrictMode} from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\nimport store from './store';\r\nimport App from './components/App/App';\r\n\r\nReactDOM.render(\r\n  <StrictMode>\r\n      <Provider store={store}>\r\n          <App />\r\n      </Provider>\r\n  </StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 69;"],"sourceRoot":""}