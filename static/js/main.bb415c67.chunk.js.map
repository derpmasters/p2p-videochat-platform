{"version":3,"sources":["../node_modules/peerjs/dist sync","store/reducers/room.reducer.js","store/actionTypes.js","utils.js","store/reducers/localUser.reducer.js","store/reducers/peers.reducer.js","store/reducers/connections.reducer.js","store/reducers/calls.reducer.js","store/reducers/streams.reducer.js","store/reducers/plugin.reducer.js","store/reducers/chat.reducer.js","store/reducers/index.js","store/index.js","style/theme/MainTheme.jsx","store/actions/streams.actions.js","store/actions/calls.actions.js","store/actions/room.actions.js","store/actions/connections.actions.js","store/actions/localUser.actions.js","components/RoomLobby/RoomLobby.jsx","store/actions/plugin.actions.js","components/Room/RoomPluginContent/RoomPluginContent.jsx","components/Room/GenericMediaCard/GenericMediaCard.jsx","components/Room/RoomMediaManager/RemoteMediaCard/RemoteMediaCard.jsx","components/Room/RoomMediaManager/RemoteMediaManager/RemoteMediaManager.jsx","components/Room/RoomMediaManager/RoomMediaManager.jsx","components/Room/RoomSidebarMenu/RoomSidebarMenu.jsx","components/Room/RoomSidebarChat/Chat/ChatMsg.jsx","components/Room/RoomSidebarChat/Chat/ChatStyle.jsx","components/Room/RoomSidebarChat/Chat/Chat.jsx","store/actions/chat.actions.js","components/Room/RoomSidebarChat/RoomSidebarChat.jsx","components/Room/RoomActionbar/RoomActionbar.jsx","components/Room/Room.jsx","constants.js","components/Home/Home.jsx","components/RoomCreateForm/RoomCreateForm.jsx","components/App/App.jsx","index.jsx"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","initialState","data","error","roomReducer","room","action","type","payload","clearStreamTracks","stream","getTracks","forEach","track","stop","getPersistedData","key","dataJson","localStorage","getItem","JSON","parse","peer","socket","metadata","localUserReducer","localPeer","peersReducer","peers","peerId","newData","connectionsReducer","connections","connection","callsReducer","calls","call","streamsReducer","streams","Object","values","url","name","pluginReducer","plugin","chatReducer","state","reducer","combineReducers","localUser","chat","store","createStore","composeWithDevTools","applyMiddleware","thunk","theme","createMuiTheme","palette","primary","main","secondary","addStream","dispatch","getState","removeStream","startLocalStream","constraintsOverride","a","constraints","audio","video","frameRate","ideal","max","width","height","navigator","mediaDevices","getUserMedia","mediaStream","window","localStream","console","log","addCall","initCallListeners","removeCall","on","remoteMediaStream","callConnection","setCurrentRoomError","addConnection","initConnectionListeners","removeConnection","connectionId","setTimeout","introduceYourself","textMessage","text","postMessage","iframe","contentWindow","remoteMetadata","connectWithPeer","remotePeerId","connect","sendDataToConnection","send","initLocalUserPeerListeners","answer","useStyles","makeStyles","containerStyle","display","justifyContent","paddingTop","titleStyle","padding","color","fontWeight","backgroundColor","nicknameStyle","margin","textfieldLink","marginRight","marginLeft","nextButton","boxShadow","alignbutton","marginTop","props","nickname","roomError","setMetadata","dataStringified","stringify","setItem","persistData","resetLocalUser","history","match","useState","newNickname","setNewNickname","params","roomId","link","setLink","classes","ThemeProvider","Box","bgcolor","alignItems","paddingLeft","to","style","textDecoration","Container","className","flexDirection","borderRadius","Typography","variant","TextField","required","label","value","onChange","target","Button","onClick","push","size","textAlign","message","setPlugin","pluginMessageActions","evt","handlePluginMessage","startsWith","iframeRef","useRef","useEffect","handleMessage","addEventListener","removeEventListener","current","flexGrow","src","ref","title","root","cardWrapper","position","flexFlow","marginBottom","media","objectFit","displayName","opacity","bottom","left","fontSize","userSelect","GenericMediaCard","muted","user","videoRef","srcObject","oncanplay","play","setVideoSrc","Card","CircularProgress","ownProps","remoteStream","remoteNickname","map","roomMediaManager","localPeerMetadata","minWidth","list","menuIcon","plugins","open","setOpen","toggleDrawer","event","handleSelectPlugin","index","currentTarget","dataset","Drawer","onClose","anchor","role","List","i","ListItem","button","data-index","ListItemIcon","ListItemText","Divider","ChatMsg","withStyles","spacing","radius","rightBgColor","avatar","leftRow","rightRow","msg","wordBreak","fontFamily","borderTopRightRadius","borderBottomRightRadius","grey","right","borderTopLeftRadius","borderBottomLeftRadius","common","white","leftFirst","leftLast","rightFirst","rightLast","messages","side","GridContainerProps","GridItemProps","AvatarProps","getTypographyProps","Grid","container","justify","item","Avatar","cx","xs","TypographyProps","align","length","defaultProps","chatContainer","textField","chatSection","customizeIcon","border","cursor","background","chatData","sendMessage","newMessage","setNewMessage","parseEmojis","toArray","reduce","previous","children","chatFeed","multiline","fullWidth","preventDefault","overflowY","WebkitFlex","chatIcon","RoomSidebarChat","RoomActionbar","localMetadata","initLocalUser","io","process","secure","query","object","entries","join","socketId","customPeerId","Peer","host","port","path","config","iceServers","joinRoom","password","emit","err","joinedUsers","clearAllStreams","disconnect","conn","close","buttonStyle","outline","Home","gutterBottom","formControl","select","borderColor","textfield","alignButton","myButton","paper","copyLink","subtitle","RoomCreateForm","React","status","setStatus","setName","setRoomId","active","setActive","handleChangeTexfield","FormControl","InputLabel","Select","labelId","MenuItem","maxUsers","fetch","method","body","headers","then","response","json","testedString","ipRegex","test","clipboard","writeText","App","CssBaseline","exact","component","RoomLobby","Room","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.bb415c67.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 191;","import {SET_CURRENT_ROOM, SET_CURRENT_ROOM_ERROR} from '../actionTypes';\r\n\r\nconst initialState = {\r\n    data: {\r\n        // id: 'dummy-room-id',\r\n        // name: 'Dummy Room',\r\n    },\r\n    error: null\r\n};\r\n\r\nconst roomReducer = (room = initialState, action) => {\r\n    switch (action.type) {\r\n        case SET_CURRENT_ROOM: {\r\n            return {data: action.payload.room, error: null};\r\n        }\r\n        case SET_CURRENT_ROOM_ERROR: {\r\n            return {data: room.data, error: action.payload.error};\r\n        }\r\n        default: {\r\n            return room;\r\n        }\r\n    }\r\n};\r\n\r\nexport default roomReducer;\r\n","export const ADD_PEER = 'ADD_PEER';\r\nexport const REMOVE_PEER = 'REMOVE_PEER';\r\nexport const SET_PEERS_ERROR = 'SET_PEERS_ERROR';\r\n\r\nexport const ADD_CONNECTION = 'ADD_CONNECTION';\r\nexport const REMOVE_CONNECTION = 'REMOVE_CONNECTION';\r\nexport const SET_CONNECTIONS_ERROR = 'SET_CONNECTIONS_ERROR';\r\n\r\nexport const ADD_CALL = 'ADD_CALL';\r\nexport const REMOVE_CALL = 'REMOVE_CALL';\r\nexport const SET_CALLS_ERROR = 'SET_CALLS_ERROR';\r\n\r\nexport const ADD_STREAM = 'ADD_STREAM';\r\nexport const REMOVE_STREAM = 'REMOVE_STREAM';\r\nexport const SET_STREAMS_ERROR = 'SET_STREAM_ERROR';\r\nexport const CLEAR_ALL_STREAMS = 'CLEAR_ALL_STREAMS';\r\n\r\nexport const SET_CURRENT_ROOM = 'SET_CURRENT_ROOM';\r\nexport const SET_CURRENT_ROOM_ERROR = 'SET_CURRENT_ROOM_ERROR';\r\n\r\nexport const INIT_LOCAL_USER_SOCKET = 'INIT_LOCAL_USER_SOCKET';\r\nexport const INIT_LOCAL_USER_PEER = 'INIT_LOCAL_USER_PEER';\r\nexport const SET_LOCAL_USER_METADATA = 'SET_LOCAL_USER_METADATA';\r\nexport const SET_LOCAL_USER_ERROR = 'SET_LOCAL_USER_ERROR';\r\nexport const RESET_LOCAL_USER = 'RESET_LOCAL_USER';\r\n\r\nexport const SET_PLUGIN = 'SET_PLUGIN';\r\nexport const SET_PLUGIN_ERROR = 'SET_PLUGIN_ERROR';\r\n\r\nexport const ADD_NEW_MESSAGE = 'ADD_NEW_MESSAGE';\r\n","// The place to put all helper methods that do not necessarily belong to a specific component\r\n// Once this file gets too crowded, create an utils folder and start seperating the exported helper methods\r\n\r\n// import {useEffect, useRef, useState} from \"react\";\r\nimport ipRegex from \"ip-regex\";\r\n\r\n/**\r\n * Transforms a javascript object into a query string.\r\n * @param object The source object. Example: {a: 5, b: 10}\r\n * @returns {string} The resulting query string. Example 'a=5&b=10'\r\n */\r\nexport const serializeQueryString = object => {\r\n    return Object.entries(object).map(([key, value]) => `${key}=${value}`).join('&');\r\n};\r\n\r\n/**\r\n * Set the src of a html5 <video> element and start playing\r\n * @param videoRef The reference to the video element\r\n * @param stream The stream that should be played by the referenced video element\r\n * @param muted Whether or not the audio of the stream should be muted\r\n */\r\nexport const setVideoSrc = (videoRef, stream, muted= true) => {\r\n    if (videoRef.current && stream) {\r\n        videoRef.current.srcObject = stream;\r\n        videoRef.current.oncanplay = () => {\r\n            videoRef.current.play();\r\n            videoRef.current.muted = muted;\r\n        };\r\n    }\r\n};\r\n\r\n// untested prototype for a hook that might replace setVideoSrc(). Right now there is no benefit of using it. Rethink design\r\n// export const useStream = (muted = false) => {\r\n//     const videoRef = useRef(null);\r\n//     const [stream, setStream] = useState(null);\r\n//\r\n//     useEffect(() => {\r\n//         if (videoRef.current && stream) {\r\n//             videoRef.current.srcObject = stream;\r\n//             videoRef.current.oncanplay = () => {\r\n//                 videoRef.current.play();\r\n//                 videoRef.current.muted = muted;\r\n//             };\r\n//         }\r\n//     }, [stream, videoRef, muted]);\r\n//\r\n//     return [videoRef, setStream];\r\n// };\r\n\r\nexport const clearStreamTracks = stream => {\r\n    if (stream) {\r\n        stream.getTracks().forEach(track => track.stop());\r\n    }\r\n};\r\n\r\nexport const getPersistedData = (key) => {\r\n    const dataJson = localStorage.getItem(key);\r\n    return dataJson ? JSON.parse(dataJson) : {};\r\n};\r\n\r\nexport const persistData = (key, data) => {\r\n    const dataStringified = JSON.stringify(data);\r\n    localStorage.setItem(key, dataStringified);\r\n};\r\n\r\nexport const isIpAddress = (testedString) => {\r\n    return ipRegex().test(testedString);\r\n}\r\n","import {INIT_LOCAL_USER_SOCKET, INIT_LOCAL_USER_PEER, SET_LOCAL_USER_METADATA, SET_LOCAL_USER_ERROR, RESET_LOCAL_USER} from '../actionTypes';\r\nimport {getPersistedData} from \"../../utils\";\r\n\r\nconst initialState = {\r\n    peer: null,\r\n    socket: null,\r\n    metadata: getPersistedData('metadata'),\r\n    error: null\r\n};\r\n\r\nconst localUserReducer = (localPeer = initialState, action) => {\r\n    switch (action.type) {\r\n        case INIT_LOCAL_USER_SOCKET: {\r\n            return {...localPeer, socket: action.payload.socket, error: null};\r\n        }\r\n        case INIT_LOCAL_USER_PEER: {\r\n            return {...localPeer, peer: action.payload.peer, error: null};\r\n        }\r\n        case SET_LOCAL_USER_METADATA: {\r\n            return {...localPeer, metadata: action.payload.metadata, error: null};\r\n        }\r\n        case SET_LOCAL_USER_ERROR: {\r\n            return {...localPeer, error: action.payload.error}\r\n        }\r\n        case RESET_LOCAL_USER: {\r\n            return initialState;\r\n        }\r\n        default: {\r\n            return localPeer;\r\n        }\r\n    }\r\n};\r\n\r\nexport default localUserReducer;\r\n\r\n","import {ADD_PEER, REMOVE_PEER, SET_PEERS_ERROR} from '../actionTypes';\r\n\r\nconst initialState = {\r\n    data: {\r\n        // 'd7f7saim3': {nickname: 'Andi'},\r\n        // '32mfdnmio': {nickname: 'Jimmy'}\r\n    },\r\n    error: null\r\n};\r\n\r\nconst peersReducer = (peers = initialState, action) => {\r\n    switch (action.type) {\r\n        case ADD_PEER: {\r\n            const {peerId, metadata} = action.payload;\r\n            return {data: {...peers.data, [peerId]: {metadata}}, error: null};\r\n        }\r\n        case REMOVE_PEER: {\r\n            const newData = {...peers.data};\r\n            const peer = action.payload.peer;\r\n            delete newData[peer.id];\r\n            return {data: newData, error: null};\r\n        }\r\n        case SET_PEERS_ERROR: {\r\n            return {...peers, error: action.payload.error};\r\n        }\r\n        default: {\r\n            return peers;\r\n        }\r\n    }\r\n};\r\n\r\nexport default peersReducer;\r\n\r\n","import {ADD_CONNECTION, REMOVE_CONNECTION, SET_CONNECTIONS_ERROR} from '../actionTypes';\r\n\r\nconst initialState = {\r\n    data: {},\r\n    error: null\r\n};\r\n\r\nconst connectionsReducer = (connections = initialState, action) => {\r\n    switch (action.type) {\r\n        case ADD_CONNECTION: {\r\n            const connection = action.payload.connection;\r\n            return {data: {...connections.data, [connection.peer]: connection}, error: null};\r\n        }\r\n        case REMOVE_CONNECTION: {\r\n            const newData = {...connections.data};\r\n            const connection = action.payload.connection;\r\n            delete newData[connection.peer];\r\n            return {data: newData, error: null};\r\n        }\r\n        case SET_CONNECTIONS_ERROR: {\r\n            return {...connections, error: action.payload.error};\r\n        }\r\n        default: {\r\n            return connections;\r\n        }\r\n    }\r\n};\r\n\r\nexport default connectionsReducer;\r\n\r\n","import {ADD_CALL, REMOVE_CALL, SET_CALLS_ERROR} from '../actionTypes';\r\n\r\nconst initialState = {\r\n    data: {},\r\n    error: null\r\n};\r\n\r\nconst callsReducer = (calls = initialState, action) => {\r\n    switch (action.type) {\r\n        case ADD_CALL: {\r\n            const call = action.payload.call;\r\n            return {data: {...calls.data, [call.peer]: call}, error: null};\r\n        }\r\n        case REMOVE_CALL: {\r\n            const newData = {...calls.data};\r\n            const call = action.payload.call;\r\n            delete newData[call.peer];\r\n            return {data: newData, error: null};\r\n        }\r\n        case SET_CALLS_ERROR: {\r\n            return {...calls, error: action.payload.error};\r\n        }\r\n        default: {\r\n            return calls;\r\n        }\r\n    }\r\n};\r\n\r\nexport default callsReducer;\r\n\r\n","import {ADD_STREAM, REMOVE_STREAM, REMOVE_CONNECTION, SET_STREAMS_ERROR, CLEAR_ALL_STREAMS} from '../actionTypes';\r\nimport {clearStreamTracks} from \"../../utils\";\r\n\r\nconst initialState = {\r\n    data: {},\r\n    error: null\r\n};\r\n\r\nconst streamsReducer = (streams = initialState, action) => {\r\n    switch (action.type) {\r\n        case ADD_STREAM: {\r\n            const {peerId, stream} = action.payload;\r\n            return {data: {...streams.data, [peerId]: stream}, error: null};\r\n        }\r\n        case REMOVE_STREAM: {\r\n            const newData = {...streams.data};\r\n            const peerId = action.payload.peerId;\r\n            const stream = newData[peerId];\r\n            clearStreamTracks(stream);\r\n            delete newData[peerId];\r\n            return {data: newData, error: null};\r\n        }\r\n        case SET_STREAMS_ERROR: {\r\n            return {...streams, error: action.payload.error};\r\n        }\r\n        case CLEAR_ALL_STREAMS: {\r\n            Object.values(streams.data).forEach(clearStreamTracks);\r\n            return {...streams, data: {}, error: null};\r\n        }\r\n        // case REMOVE_CONNECTION: {\r\n        //     const newData = {...streams.data};\r\n        //     const peerId = action.payload.connection.peer;\r\n        //     const stream = newData[peerId]\r\n        //     clearStreamTracks(stream);\r\n        //     delete newData[peerId];\r\n        //     return {data: newData, error: null};\r\n        // }\r\n        default: {\r\n            return streams;\r\n        }\r\n    }\r\n};\r\n\r\nexport default streamsReducer;\r\n","import {SET_PLUGIN, SET_PLUGIN_ERROR} from '../actionTypes';\r\n\r\nconst initialState = {\r\n    // origin: 'null',\r\n    url: '',\r\n    name: 'p2p-test-plugin',\r\n    error: null\r\n};\r\n\r\nconst pluginReducer = (plugin = initialState, action) => {\r\n    switch (action.type) {\r\n        case SET_PLUGIN: {\r\n            return {...plugin, ...action.payload.plugin, error: null};\r\n        }\r\n        case SET_PLUGIN_ERROR: {\r\n            return {...plugin, error: action.payload.error}\r\n        }\r\n        default: {\r\n            return plugin;\r\n        }\r\n    }\r\n};\r\n\r\nexport default pluginReducer;\r\n\r\n","import {ADD_NEW_MESSAGE} from '../actionTypes';\r\n\r\nconst initialState = [\r\n];\r\n\r\nconst chatReducer = (state = initialState, action) => {\r\n    switch(action.type) {\r\n        case ADD_NEW_MESSAGE: {\r\n            return [...state, action.payload];\r\n        }\r\n        default: {\r\n            return state;\r\n        }\r\n    }\r\n};\r\n\r\nexport default chatReducer\r\n","import { combineReducers } from 'redux';\r\nimport roomReducer from './room.reducer';\r\nimport localUserReducer from \"./localUser.reducer\";\r\nimport peersReducer from './peers.reducer';\r\nimport connectionsReducer from './connections.reducer';\r\nimport callsReducer from './calls.reducer';\r\nimport streamsReducer from \"./streams.reducer\";\r\nimport pluginReducer from \"./plugin.reducer\";\r\nimport chatReducer from \"./chat.reducer\";\r\n\r\nconst reducer = combineReducers({\r\n    room: roomReducer,\r\n    localUser: localUserReducer,\r\n    peers: peersReducer,\r\n    calls: callsReducer,\r\n    connections: connectionsReducer,\r\n    streams: streamsReducer,\r\n    plugin: pluginReducer,\r\n    chat: chatReducer\r\n});\r\n\r\nexport default reducer;\r\n","import { createStore, applyMiddleware } from 'redux';\r\nimport thunk from 'redux-thunk';\r\nimport { composeWithDevTools } from 'redux-devtools-extension';\r\nimport reducer from './reducers';\r\n\r\nconst store = createStore(reducer, composeWithDevTools(applyMiddleware(thunk)));\r\n\r\nexport default store;\r\n","import { createMuiTheme } from '@material-ui/core/styles';\r\n\r\nconst theme = createMuiTheme({\r\n    palette: {\r\n        primary: {\r\n            main: '#E53935'\r\n        },\r\n        secondary: {\r\n            main: '#FB8C00'\r\n        }\r\n    }\r\n})\r\n\r\nexport default theme","import {ADD_STREAM, CLEAR_ALL_STREAMS, REMOVE_STREAM} from \"../actionTypes\";\r\n\r\nexport const addStream = (peerId, stream) => (dispatch, getState) => {\r\n    if (stream) {\r\n        dispatch({type: ADD_STREAM, payload: {peerId, stream}});\r\n    }\r\n};\r\n\r\nexport const removeStream = (peerId) => (dispatch, getState) => {\r\n    if (peerId) {\r\n        dispatch({type: REMOVE_STREAM, payload: {peerId}});\r\n    }\r\n};\r\n\r\nexport const startLocalStream = (peer, constraintsOverride) => async (dispatch, getState) => {\r\n    const localPeer = peer || getState().localUser.peer;\r\n    const localSteam = getState().streams.data[localPeer.id]\r\n    if (!localSteam) {\r\n\r\n        try {\r\n            const constraints = {\r\n                audio: true,\r\n                video: {\r\n                    frameRate: {ideal: 20, max: 25},\r\n                    width: {ideal: 128},\r\n                    height: {ideal: 72}\r\n                }\r\n            };\r\n\r\n            let mediaStream = await navigator.mediaDevices.getUserMedia(constraintsOverride || constraints);\r\n            dispatch(addStream(localPeer.id, mediaStream));\r\n            window.localStream = mediaStream; // kind of hacky to stop the tracks on unmount\r\n            return mediaStream;\r\n        } catch (error) {\r\n            console.error('local stream couldnt be started', error);\r\n        }\r\n    } else {\r\n        console.log('local stream already active');\r\n    }\r\n};\r\nexport const clearAllStreams = () => async (dispatch, getState) => {\r\n        dispatch({type: CLEAR_ALL_STREAMS});\r\n\r\n};\r\n","import {ADD_CALL, REMOVE_CALL} from \"../actionTypes\";\r\nimport {startLocalStream, addStream} from \"./streams.actions\";\r\n\r\nexport const addCall = call => (dispatch, getState) => {\r\n    if (call) {\r\n        dispatch({type: ADD_CALL, payload: {call}});\r\n        dispatch(initCallListeners(call));\r\n    }\r\n};\r\n\r\nexport const removeCall = call => (dispatch, getState) => {\r\n    if (call) {\r\n        dispatch({type: REMOVE_CALL, payload: {call}});\r\n    }\r\n};\r\n\r\nexport const initCallListeners = call => (dispatch, getState) => {\r\n    if (call) {\r\n        call.on('stream', remoteMediaStream => {\r\n            dispatch(addStream(call.peer, remoteMediaStream));\r\n        });\r\n    }\r\n};\r\n\r\nexport const callConnection = connection => async (dispatch, getState) => {\r\n    const {peer} = getState().localUser;\r\n    const localStream = getState().streams.data[peer.id] || await dispatch(startLocalStream(peer));\r\n\r\n    const call = await peer.call(connection.peer, localStream);\r\n    dispatch(addCall(call));\r\n};\r\n\r\nexport const callReplaceStreamTrack = (remotePeerId, options) => async (dispatch, getState) => {\r\n    const call = getState().calls.data[remotePeerId];\r\n    const {peer} = getState().localUser;\r\n    const localStream = await dispatch(startLocalStream(peer, options));\r\n\r\n    call.peerConnection.getSenders()[0].replaceTrack(localStream);\r\n\r\n    dispatch(addCall(call));\r\n};\r\n","import {SET_CURRENT_ROOM, SET_CURRENT_ROOM_ERROR} from \"../actionTypes\";\r\n\r\nexport const setCurrentRoom = room => ({\r\n    type: SET_CURRENT_ROOM,\r\n    payload: {room}\r\n});\r\n\r\nexport const setCurrentRoomError = error => ({\r\n    type: SET_CURRENT_ROOM_ERROR,\r\n    payload: {error}\r\n});\r\n\r\nexport const joinRoom = (roomId, password, peerData) => (dispatch, getState) => {\r\n    //\r\n    // const room = null;\r\n    // dispatch(setCurrentRoom(room));\r\n};\r\n","import {ADD_CONNECTION, REMOVE_CONNECTION, ADD_NEW_MESSAGE, ADD_PEER, SET_CURRENT_ROOM} from \"../actionTypes\";\r\nimport {callConnection, removeCall} from \"./calls.actions\";\r\nimport {removeStream, startLocalStream} from \"./streams.actions\";\r\nimport {setCurrentRoomError} from \"./room.actions\";\r\n\r\nexport const addConnection = connection => async (dispatch, getState) => {\r\n    if (connection && connection.peer) {\r\n        await dispatch({type: ADD_CONNECTION, payload: {connection}});\r\n        await dispatch(initConnectionListeners(connection));\r\n    }\r\n};\r\n\r\nexport const removeConnection = connection => async (dispatch, getState) => {\r\n    if (connection && connection.peer) {\r\n\r\n        const stream = getState().streams.data[connection.peer];\r\n        if (stream) {\r\n            await dispatch(removeStream(connection.peer));\r\n        }\r\n\r\n        const call = getState().calls.data[connection.peer];\r\n        if (call) {\r\n            await dispatch(removeCall(call));\r\n        }\r\n\r\n        await dispatch({type: REMOVE_CONNECTION, payload: {connection}});\r\n    }\r\n};\r\n\r\nexport const initConnectionListeners = connection => (dispatch, getState) => {\r\n    if (connection && connection.connectionId) {\r\n        connection.on('open', () => {\r\n            setTimeout(() => dispatch(introduceYourself(connection), 500)); // TODO temporary delay for experimentation\r\n        });\r\n\r\n        connection.on('data', data => {\r\n            console.log('on connection data', data);\r\n            const type = data.type;\r\n\r\n            if (data.textMessage) {\r\n                dispatch({type: ADD_NEW_MESSAGE, payload: data.textMessage});\r\n                console.log(`%c MESSAGE - ${data.textMessage.peerId}: \"${data.textMessage.text}\"`, 'background: black; color: white; padding: 1rem');\r\n            }\r\n\r\n            if (type === 'PLUGIN_DATA') {\r\n                window.postMessage(data.payload, '*');\r\n                const iframe = getState().plugin.iframe;\r\n                if (iframe) {\r\n                    iframe.contentWindow.postMessage(data, \"*\");\r\n                }\r\n            }\r\n\r\n            if (type === 'PEER_INTRODUCTION') {\r\n                console.log('Connected peer is introducing himself to you:', data.payload);\r\n                const remoteMetadata = data.payload.metadata;\r\n                dispatch({type: ADD_PEER, payload: {metadata: remoteMetadata, peerId: connection.peer}});\r\n            }\r\n        });\r\n\r\n        connection.on('close', () => {\r\n            dispatch(removeConnection(connection));\r\n        });\r\n    }\r\n};\r\n\r\nexport const connectWithPeer = remotePeerId => async (dispatch, getState) => {\r\n    const {peer} = getState().localUser;\r\n\r\n    if (remotePeerId !== peer.id) {\r\n        const connection = await peer.connect(remotePeerId);\r\n        await dispatch(addConnection(connection));\r\n        await dispatch(callConnection(connection));\r\n    }\r\n};\r\n\r\nexport const sendDataToConnection = (connection, data) => async (dispatch, getState) => {\r\n    if (connection) {\r\n        connection.send(data);\r\n    }\r\n};\r\n\r\nexport const joinRoom = (roomId, password) => async (dispatch, getState) => { // TODO move to room actions\r\n    const {socket, peer} = getState().localUser;\r\n\r\n    if (socket && peer) {\r\n        socket.emit('join', {roomId, password, peerId: peer.id},\r\n            // callback: the joining user himself is responsible to establish connections with other users\r\n            async (err, data) => {\r\n                if (!err) {\r\n                    await dispatch(startLocalStream(peer));\r\n                    await dispatch({type: SET_CURRENT_ROOM, payload: {room: data.room}});\r\n                    data.room.joinedUsers.forEach((remotePeerId) => dispatch(connectWithPeer(remotePeerId)));\r\n                } else {\r\n                    dispatch(setCurrentRoomError(err));\r\n                }\r\n            });\r\n    }\r\n};\r\n\r\nexport const introduceYourself = (connection) => async (dispatch, getState) => {\r\n    const metadata = getState().localUser.metadata;\r\n\r\n    if (metadata) {\r\n        dispatch(sendDataToConnection(connection, {type: 'PEER_INTRODUCTION', payload: {metadata}}));\r\n    }\r\n};\r\n\r\n\r\n","import {INIT_LOCAL_USER_PEER, INIT_LOCAL_USER_SOCKET, RESET_LOCAL_USER, SET_LOCAL_USER_METADATA} from \"../actionTypes\";\r\nimport Peer from \"peerjs\";\r\nimport {API_BASE_URL, PORT_SIGNALING, PORT_SOCKET, SSL_ENABLED} from \"../../constants\";\r\nimport io from \"socket.io-client\";\r\nimport {persistData, serializeQueryString} from \"../../utils\";\r\nimport {addConnection, removeConnection} from \"./connections.actions\";\r\nimport {addCall} from \"./calls.actions\";\r\nimport {startLocalStream} from \"./streams.actions\";\r\n\r\nexport const resetLocalUser = () => ({type: RESET_LOCAL_USER});\r\n\r\nconst initLocalUserPeer = (customPeerId) => async (dispatch, getState) => {\r\n    const peer = await new Peer(customPeerId, {\r\n        host: API_BASE_URL,\r\n        port: PORT_SIGNALING,\r\n        path: '/peer/signal',\r\n        // debug: 3,\r\n        config: {iceServers: [{url: 'stun:stun.l.google.com:19302'}]}\r\n    });\r\n\r\n    await dispatch({type: INIT_LOCAL_USER_PEER, payload: {peer}});\r\n    await dispatch(startLocalStream(peer));\r\n    await dispatch(initLocalUserPeerListeners(peer));\r\n};\r\n\r\n/**\r\n * Init the socket.io client. Once socket is ready, init the peerJS Peer and store them in the store.\r\n */\r\nexport const initLocalUser = (metadata) => async (dispatch, getState) => {\r\n    // const metadata = getState().localUser.metadata || {};\r\n    // FIXME peer init can fail when socket.id start with an underscore. Rarely happens though, allow peerId to be different from socketId\r\n    const protocol = SSL_ENABLED ? 'https' : 'http';\r\n    const socket = io(`${protocol}://${API_BASE_URL}:${PORT_SOCKET}`, {\r\n        // transports: ['websocket'],\r\n        secure: SSL_ENABLED,\r\n        query: serializeQueryString(metadata)\r\n    });\r\n\r\n    socket.on('ready', (socketId) => {\r\n        dispatch({type: INIT_LOCAL_USER_SOCKET, payload: {socket}});\r\n        dispatch(initLocalUserPeer(socketId));\r\n    });\r\n\r\n    socket.on('user-leave', (socketId) => {\r\n        const connection = getState().connections.data[socketId];\r\n        if (connection) {\r\n            dispatch(removeConnection(connection));\r\n        }\r\n    });\r\n};\r\n\r\nconst initLocalUserPeerListeners = (peer) => async (dispatch, getState) => {\r\n    const localPeer = peer || getState().localUser.peer;\r\n\r\n    if (localPeer) {\r\n        localPeer.on('open', id => {\r\n        });\r\n\r\n        localPeer.on('connection', connection => {\r\n            dispatch(addConnection(connection));\r\n        });\r\n\r\n        localPeer.on('call', async call => {\r\n            const localStream = await getState().streams.data[localPeer.id] || dispatch(startLocalStream(peer));\r\n            call.answer(localStream);\r\n            dispatch(addCall(call));\r\n        })\r\n    }\r\n};\r\n\r\nexport const setMetadata = (metadata) => (dispatch, getState) => {\r\n    persistData('metadata', metadata);\r\n    dispatch({type: SET_LOCAL_USER_METADATA, payload: {metadata}});\r\n};\r\n","import React, {useState} from 'react';\r\nimport {Link} from \"react-router-dom\";\r\nimport { ThemeProvider, makeStyles } from '@material-ui/core/styles';\r\nimport theme from '../../style/theme/MainTheme';\r\nimport Box from '@material-ui/core/Box';\r\nimport Container from '@material-ui/core/Container';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Button from '@material-ui/core/Button';\r\nimport ArrowBackIosIcon from '@material-ui/icons/ArrowBackIos';\r\nimport {resetLocalUser, setMetadata} from \"../../store/actions/localUser.actions\";\r\nimport {connect} from \"react-redux\";\r\nimport {setCurrentRoomError} from \"../../store/actions/room.actions\";\r\nimport {RESET_LOCAL_USER} from \"../../store/actionTypes\";\r\n\r\nconst useStyles = makeStyles ({\r\n    containerStyle: {\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        paddingTop: '128px'\r\n    },\r\n    titleStyle: {\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        padding: '16px',\r\n        color: 'white',\r\n        fontWeight: 'bold',\r\n        backgroundColor: '#FB8C00',\r\n    },\r\n    nicknameStyle: {\r\n        width: '616px',\r\n        margin: '16px',\r\n    },\r\n    textfieldLink: {\r\n        width: '616px',\r\n        marginRight: '16px',\r\n        marginLeft: '16px',\r\n    },\r\n    nextButton: {\r\n        color: 'white',\r\n        boxShadow: 'none',\r\n        width: '422px',\r\n\r\n    },\r\n    alignbutton: {\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        marginTop: '24px',\r\n    }\r\n});\r\n\r\nconst RoomLobby = ({history, match, setMetadata, nickname, roomError, setCurrentRoomError, resetLocalUser}) => {\r\n    const [newNickname, setNewNickname] = useState(nickname);\r\n    const [link, setLink] = useState(match.params.roomId);\r\n    const classes = useStyles();\r\n\r\n    const handleChangeName = (e) => {\r\n        setNewNickname(e.target.value)\r\n    };\r\n\r\n    const handleChangeLink = (e) => {\r\n        setLink(e.target.value)\r\n    };\r\n\r\n    const handleJoin = (e) => {\r\n        setMetadata({nickname: newNickname});\r\n        setCurrentRoomError(null);\r\n        resetLocalUser();\r\n        history.push(`/rooms/${match.params.roomId}`);\r\n    };\r\n\r\n    return (\r\n        <ThemeProvider theme={theme}>\r\n            <Box display='flex' height={63} bgcolor='#E53935' alignItems='center' paddingLeft='36px'>\r\n                <Link to=\"/\" style={{ textDecoration: 'none', color: 'white'}}>\r\n                    <ArrowBackIosIcon/>\r\n                </Link>\r\n            </Box>\r\n            <Container className={classes.containerStyle}>\r\n                <Box display='flex' flexDirection='column' width={648} height={307} borderRadius='5px' bgcolor='white'>\r\n                    <Typography variant='h4' className={classes.titleStyle}>Enter the room</Typography>\r\n                    <TextField\r\n                        required\r\n                        id=\"outlined-required\"\r\n                        label=\"Nickname\"\r\n                        variant=\"outlined\"\r\n                        value={newNickname}\r\n                        className={classes.nicknameStyle}\r\n                        onChange={handleChangeName}\r\n                     />\r\n                    <TextField\r\n                        required\r\n                        id=\"outlined-required\"\r\n                        label=\"Room ID\"\r\n                        variant=\"outlined\"\r\n                        value={link}\r\n                        className={classes.textfieldLink}\r\n                        onChange={handleChangeLink}\r\n                     />\r\n                     <div className={classes.alignbutton}>\r\n                        <Button onClick={handleJoin} size=\"large\" color=\"secondary\" variant=\"contained\" className={classes.nextButton}>\r\n                            join\r\n                        </Button>\r\n                    </div>\r\n                    {roomError && <Box color={'red'} textAlign={'center'}>{roomError.error.message}</Box>}\r\n                </Box>\r\n            </Container>\r\n        </ThemeProvider>\r\n    )\r\n};\r\n\r\nconst mapStateToProps = (state, props) => ({\r\n    nickname: state.localUser.metadata.nickname || '',\r\n    roomError: state.room.error\r\n});\r\n\r\nexport default connect(mapStateToProps, {setMetadata, setCurrentRoomError, resetLocalUser})(RoomLobby);\r\n","import {SET_PLUGIN} from \"../actionTypes\";\r\nimport {sendDataToConnection} from \"./connections.actions\";\r\n\r\nexport const setPlugin = plugin => (dispatch, getState) => {\r\n    // temporary simplified action\r\n    if (plugin) {\r\n        dispatch({type: SET_PLUGIN, payload: {plugin}});\r\n    }\r\n};\r\n\r\nconst sendPluginMessageToAllConnections = (evt) => (dispatch, getState) => {\r\n    const connections = Object.values(getState().connections.data);\r\n    const data = {type: 'PLUGIN_DATA', payload: evt.data.payload};\r\n    console.log('PLUGIN_SEND_TO_ALL_PEERS', data);\r\n    connections.forEach(connection => {\r\n         dispatch(sendDataToConnection(connection, data));\r\n     });\r\n};\r\n\r\nconst sendPluginMessageToConnection = (evt) => (dispatch, getState) => {\r\n    const {peerId, payload} = evt.data;\r\n    const connection = getState().connections.data[peerId];\r\n    const data = {type: 'PLUGIN_DATA', payload: payload};\r\n    dispatch(sendDataToConnection(connection, data));\r\n};\r\n\r\nconst pluginMessageActions = {\r\n    'PLUGIN_SEND_TO_ALL_PEERS': sendPluginMessageToAllConnections,\r\n    'PLUGIN_SEND_TO_PEER': sendPluginMessageToConnection,\r\n    'PLUGIN_PLATFORM_CONTROL_REQUEST': () => console.log('plugin is requesting something from the platform (mute local user, rumble screen, etc')\r\n};\r\n\r\nexport const handlePluginMessage = (evt) => async (dispatch, getState) => {\r\n    if (evt.data.type && evt.data.type.startsWith('PLUGIN')) {\r\n        const action = pluginMessageActions[evt.data.type];\r\n        dispatch(action(evt))\r\n    }\r\n}\r\n\r\n","import React, {useEffect, useRef} from 'react';\r\nimport {Box} from \"@material-ui/core\";\r\nimport {connect} from \"react-redux\";\r\nimport {handlePluginMessage, setPlugin} from \"../../../store/actions/plugin.actions\";\r\n\r\nconst RoomPluginContent = ({plugin, handlePluginMessage, setPlugin}) => {\r\n    const iframeRef = useRef();\r\n\r\n    useEffect(() => {\r\n        const handleMessage = (evt) => {\r\n            handlePluginMessage(evt);\r\n        };\r\n        window.addEventListener('message', handleMessage);\r\n        return () => window.removeEventListener('message', handleMessage);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (iframeRef && iframeRef.current) {\r\n            setPlugin({...plugin, iframe: iframeRef.current});\r\n        }\r\n    }, [iframeRef, plugin.url]);\r\n\r\n    return (\r\n        <Box bgcolor='salmon' flexGrow={1}>\r\n            {plugin && plugin.url && <iframe src={plugin.url} style={{width: '100%', height: '100%'}} ref={iframeRef} title={'plugin content'} />}\r\n        </Box>\r\n\r\n    );\r\n};\r\n\r\nconst mapStateToProps = (state) => ({\r\n    plugin: state.plugin\r\n});\r\n\r\nexport default connect(mapStateToProps, {handlePluginMessage, setPlugin})(RoomPluginContent);\r\n","import React, {useEffect, useRef} from 'react';\r\nimport {Box, Card, CircularProgress, makeStyles} from \"@material-ui/core\";\r\nimport {setVideoSrc} from \"../../../utils\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        display: 'flex',\r\n    },\r\n    cardWrapper: {\r\n        position: 'relative',\r\n        display: 'flex',\r\n        flexFlow: 'column nowrap',\r\n        marginBottom: '5px',\r\n        width: '100%',\r\n        height: '130px',\r\n    },\r\n    media: {\r\n        width: '100%',\r\n        height: '100%',\r\n        objectFit: 'cover'\r\n    },\r\n    displayName: {\r\n        color: 'white',\r\n        opacity: '0.8',\r\n        position: 'absolute',\r\n        bottom: '5px',\r\n        left: '5px',\r\n        fontSize: '0.9rem',\r\n        userSelect: 'none'\r\n    }\r\n}));\r\n\r\nconst GenericMediaCard = ({stream, muted = false, user}) => {\r\n    const classes = useStyles();\r\n    const videoRef = useRef(null);\r\n    const {nickname} = user;\r\n\r\n    useEffect(() => {\r\n        setVideoSrc(videoRef, stream, muted);\r\n    }, [stream]);\r\n\r\n    return (\r\n        <Card className={classes.cardWrapper}>\r\n            {stream\r\n                ? <video ref={videoRef} className={classes.media} />\r\n                : <CircularProgress color=\"inherit\" />\r\n            }\r\n            <Box className={classes.displayName}>{nickname}</Box>\r\n        </Card>\r\n    );\r\n};\r\n\r\nexport default GenericMediaCard;\r\n","import React from 'react';\r\nimport GenericMediaCard from \"../../GenericMediaCard/GenericMediaCard\";\r\nimport {connect} from \"react-redux\";\r\n\r\nconst RemoteMediaCard = ({remoteStream, remoteNickname}) => <GenericMediaCard stream={remoteStream} user={{nickname: remoteNickname}} />;\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    const remotePeerId = ownProps.connection.peer;\r\n    const remoteStream = remotePeerId ? state.streams.data[remotePeerId] : null;\r\n    const remoteMetadata = state.peers.data[remotePeerId] ? state.peers.data[remotePeerId].metadata : {};\r\n    return {\r\n        remoteStream: remoteStream,\r\n        remoteNickname: remoteMetadata.nickname || 'missing Nickname',\r\n    }\r\n};\r\n\r\nexport default connect(mapStateToProps)(RemoteMediaCard);\r\n","import React, {useEffect, useRef, useState} from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport RemoteMediaCard from \"../RemoteMediaCard/RemoteMediaCard\";\r\n\r\nconst RemoteMediaManager = ({connections}) => {\r\n    return (\r\n        <>\r\n            {connections && connections.map(connection => <RemoteMediaCard key={connection.connectionId} connection={connection} />)}\r\n        </>\r\n    );\r\n};\r\n\r\nconst mapStateToProps = state => ({\r\n    connections: Object.values(state.connections.data)\r\n});\r\n\r\nexport default connect(mapStateToProps)(RemoteMediaManager);\r\n","import React, {useEffect, useRef, useState} from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport GenericMediaCard from \"../GenericMediaCard/GenericMediaCard\";\r\nimport {Box, makeStyles} from \"@material-ui/core\";\r\nimport RemoteMediaManager from \"./RemoteMediaManager/RemoteMediaManager\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    roomMediaManager: {\r\n        padding: '5px',\r\n    },\r\n}));\r\n\r\nconst RoomMediaManager = ({localStream, localPeerMetadata}) => {\r\n    const classes = useStyles();\r\n\r\n    return (\r\n        <Box bgcolor='lightblue' width={'220px'} minWidth={'150px'} className={classes.roomMediaManager}>\r\n            <GenericMediaCard stream={localStream} muted={true} user={{nickname: localPeerMetadata.nickname}}/>\r\n            <RemoteMediaManager />\r\n        </Box>\r\n    );\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n    const localPeer = state.localUser.peer;\r\n    const localStream = localPeer ? state.streams.data[localPeer.id] : null;\r\n    return {\r\n        localPeerMetadata: state.localUser.metadata,\r\n        localStream: localStream,\r\n    }\r\n};\r\n\r\nexport default connect(mapStateToProps, {})(RoomMediaManager);\r\n","import React, {useState} from 'react';\r\nimport {ThemeProvider, makeStyles} from '@material-ui/core/styles';\r\nimport LabelIcon from '@material-ui/icons/Label';\r\nimport WidgetsOutlinedIcon from '@material-ui/icons/WidgetsOutlined';\r\nimport Button from '@material-ui/core/Button';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport List from '@material-ui/core/List';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport theme from '../../../style/theme/MainTheme';\r\nimport {setPlugin} from \"../../../store/actions/plugin.actions\";\r\nimport {connect} from \"react-redux\";\r\n\r\nconst useStyles = makeStyles({\r\n    list: {\r\n        width: 250,\r\n    },\r\n    menuIcon: {\r\n        margin: '8px'\r\n    }\r\n});\r\n\r\n// TODO this data will be served by the backend in future releases. Not real plugins except first one in the list\r\nconst plugins = [\r\n    {name: 'Random number', url: 'https://andreas-schoch.github.io/p2p-test-plugin/'},\r\n    {name: 'Paint', url: 'https://andreas-schoch.github.io/quackamole-plugin-paint/'},\r\n    {name: 'Gomoku', url: 'https://derpmasters.github.io/quackamole-plugin-gomoku/'},\r\n    {name: 'Breakout game', url: 'https://andreas-schoch.github.io/breakout-game/'},\r\n    {name: 'Todo list', url: 'https://andreas-schoch.github.io/react-todo-app/'},\r\n    {name: 'Karaoke', url: 'https://www.youtube.com/embed/dQw4w9WgXcQ'},\r\n];\r\n\r\nconst RoomSidebarMenu = ({plugin, setPlugin}) => {\r\n    const classes = useStyles();\r\n    const [open, setOpen] = useState(false);\r\n\r\n    const toggleDrawer = (event) => {\r\n        if (event.type === 'keydown') {\r\n            return;\r\n        }\r\n        setOpen(!open);\r\n    };\r\n\r\n    const handleSelectPlugin = (evt) => {\r\n        const index = evt.currentTarget.dataset.index;\r\n        setPlugin(plugin ? {...plugin, ...plugins[index]} : plugins[index]);\r\n    };\r\n\r\n    const list = () => (\r\n        <div className={classes.list} role=\"presentation\" onClick={toggleDrawer}>\r\n            <List>\r\n                {plugins.map(({name}, i) => (\r\n                    <ListItem button key={name} onClick={handleSelectPlugin} data-index={i}>\r\n                        <ListItemIcon><LabelIcon/></ListItemIcon>\r\n                        <ListItemText primary={name}/>\r\n                    </ListItem>\r\n                ))}\r\n            </List>\r\n            <Divider/>\r\n            <List>\r\n                <ListItem button>\r\n                    <ListItemIcon><WidgetsOutlinedIcon/></ListItemIcon>\r\n                    <ListItemText primary={'Browse Plugins'}/>\r\n                </ListItem>\r\n            </List>\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <ThemeProvider theme={theme}>\r\n            <Button>\r\n                <MenuIcon onClick={toggleDrawer} color='primary' fontSize='large' className={classes.menuIcon}/>\r\n                <Drawer open={open} onClose={toggleDrawer} anchor={'left'}>\r\n                    {list()}\r\n                </Drawer>\r\n            </Button>\r\n        </ThemeProvider>\r\n    );\r\n};\r\n\r\nconst mapStateToProps = (state) => ({\r\n    plugin: state.plugin\r\n});\r\n\r\nexport default connect(mapStateToProps, {setPlugin})(RoomSidebarMenu);\r\n","import React from 'react';\r\nimport cx from 'clsx';  // TODO This comes from some example code, it has some nice features but we need to discuss whether we want to use it\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport withStyles from '@material-ui/core/styles/withStyles';\r\nimport defaultChatMsgStyles from './ChatStyle';\r\n\r\nconst ChatMsg = withStyles(defaultChatMsgStyles, { name: 'ChatMsg' })(props => {\r\n  const {\r\n    classes,\r\n    avatar,\r\n    messages,\r\n    side,\r\n    GridContainerProps,\r\n    GridItemProps,\r\n    AvatarProps,\r\n    getTypographyProps,\r\n  } = props;\r\n\r\n  const attachClass = index => {\r\n    if (index === 0) {\r\n      return classes[`${side}First`];\r\n    }\r\n    if (index === messages.length - 1) {\r\n      return classes[`${side}Last`];\r\n    }\r\n    return '';\r\n  };\r\n  return (\r\n    <Grid\r\n      container\r\n      spacing={2}\r\n      justify={side === 'right' ? 'flex-end' : 'flex-start'}\r\n      {...GridContainerProps}\r\n    >\r\n      {side === 'left' && (\r\n        <Grid item {...GridItemProps}>\r\n          <Avatar\r\n            src={avatar}\r\n            {...AvatarProps}\r\n            className={cx(classes.avatar, AvatarProps.className)}\r\n          />\r\n        </Grid>\r\n      )}\r\n      <Grid item xs={8}>\r\n        {messages.map((msg, i) => {\r\n          const TypographyProps = getTypographyProps(msg, i, props);\r\n          return (\r\n            // eslint-disable-next-line react/no-array-index-key\r\n            <div key={msg.id || i} className={classes[`${side}Row`]}>\r\n              <Typography\r\n                align={'left'}\r\n                {...TypographyProps}\r\n                className={cx(\r\n                  classes.msg,\r\n                  classes[side],\r\n                  attachClass(i),\r\n                  TypographyProps.className\r\n                )}\r\n              >\r\n                {msg}\r\n              </Typography>\r\n            </div>\r\n          );\r\n        })}\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n});\r\n\r\nChatMsg.defaultProps = {\r\n  avatar: '',\r\n  messages: [],\r\n  side: 'left',\r\n  GridContainerProps: {},\r\n  GridItemProps: {},\r\n  AvatarProps: {},\r\n  getTypographyProps: () => ({}),\r\n};\r\n\r\nexport default ChatMsg;\r\n","export default ({ palette, spacing }) => {\r\n    const radius = spacing(2.5);\r\n    const size = spacing(4);\r\n    const rightBgColor = palette.primary.main;\r\n    return {\r\n      avatar: {\r\n        width: size,\r\n        height: size,\r\n      },\r\n      leftRow: {\r\n        textAlign: 'left',\r\n      },\r\n      rightRow: {\r\n        textAlign: 'right',\r\n      },\r\n      msg: {\r\n        padding: spacing(1, 2),\r\n        borderRadius: 4,\r\n        marginBottom: 4,\r\n        display: 'inline-block',\r\n        wordBreak: 'break-word',\r\n        fontFamily:\r\n          '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\"',\r\n        fontSize: '14px',\r\n      },\r\n      left: {\r\n        borderTopRightRadius: radius,\r\n        borderBottomRightRadius: radius,\r\n        backgroundColor: palette.grey[100],\r\n      },\r\n      right: {\r\n        borderTopLeftRadius: radius,\r\n        borderBottomLeftRadius: radius,\r\n        backgroundColor: rightBgColor,\r\n        color: palette.common.white,\r\n      },\r\n      leftFirst: {\r\n        borderTopLeftRadius: radius,\r\n      },\r\n      leftLast: {\r\n        borderBottomLeftRadius: radius,\r\n      },\r\n      rightFirst: {\r\n        borderTopRightRadius: radius,\r\n      },\r\n      rightLast: {\r\n        borderBottomRightRadius: radius,\r\n      },\r\n    };\r\n  };\r\n","import React, { useState } from 'react';\r\nimport ChatMsg from './ChatMsg';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport {ThemeProvider, makeStyles} from '@material-ui/core/styles';\r\nimport {connect} from \"react-redux\";\r\nimport {sendMessage} from '../../../../store/actions/chat.actions';\r\nimport {toArray} from \"react-emoji-render\";\r\n\r\nconst useStyles = makeStyles({\r\n    chatContainer: {\r\n    },\r\n    textField: {\r\n        width: \"85%\",\r\n        marginRight: \"5px\",\r\n    },\r\n    chatSection: {\r\n        display: \"flex\",\r\n        justifyContent: \"space-between\",\r\n        alignItems: \"center\",\r\n    },\r\n    customizeIcon: {\r\n        border: '2px solid #E53935',\r\n        borderRadius: '50%',\r\n        color: '#E53935',\r\n        height: 35,\r\n        width: 35,\r\n        padding: 4,\r\n        cursor: 'pointer',\r\n        '&:hover': {\r\n            background: \"#E53935\",\r\n            color: 'white',\r\n         },\r\n    },\r\n});\r\n\r\nconst Chat = ({chatData, sendMessage, connections, localPeer}) => {\r\n    const classes = useStyles('');\r\n    const [newMessage, setNewMessage] = useState('');\r\n\r\n    const handleChangeTexfield = (event) => {\r\n        setNewMessage(event.target.value)\r\n    };\r\n\r\n    const send = (e) => {\r\n        e.preventDefault();\r\n        sendMessage(newMessage);\r\n        setNewMessage('');\r\n    };\r\n\r\n    const parseEmojis = value => {\r\n        const emojisArray = toArray(value);\r\n\r\n        // toArray outputs React elements for emojis and strings for other\r\n        const newValue = emojisArray.reduce((previous, current) => {\r\n          if (typeof current === \"string\") {\r\n            return previous + current;\r\n          }\r\n          return previous + current.props.children;\r\n        }, \"\");\r\n\r\n        return newValue;\r\n      };\r\n\r\n    //handle the chat feed to display all messages on the right position\r\n      const chatFeed = chatData.map((message, i) => message.peerId === localPeer.id ?\r\n        <ChatMsg\r\n            key={i}\r\n            side={'right'}\r\n            messages={[parseEmojis(message.text)]}\r\n        /> :\r\n        <ChatMsg\r\n            key={i}\r\n            avatar={''}\r\n            messages={[parseEmojis(message.text)]}\r\n        />\r\n    );\r\n\r\n    return (\r\n        <div className={classes.chatContainer}>\r\n            {chatFeed}\r\n            <div className={classes.chatSection}>\r\n                <TextField\r\n                    variant=\"outlined\"\r\n                    size=\"small\"\r\n                    multiline\r\n                    fullWidth\r\n                    className={classes.textField}\r\n                    onChange={handleChangeTexfield}\r\n                    value={parseEmojis(newMessage)}\r\n                />\r\n                <SendIcon\r\n                    className={classes.customizeIcon}\r\n                    onClick={send}\r\n                />\r\n            </div>\r\n        </div>\r\n    )\r\n};\r\n\r\nconst mapStateToProps = (state, props) => ({\r\n    chatData: state.chat,\r\n    connections: Object.values(state.connections.data),\r\n    localPeer: state.localUser.peer,\r\n});\r\n\r\nexport default connect(mapStateToProps, {sendMessage})(Chat);\r\n","import {ADD_NEW_MESSAGE} from '../actionTypes';\r\n\r\nexport const sendMessage = (text) => async (dispatch, getState) => {\r\n    const connections = Object.values(getState().connections.data);\r\n    const localPeer = getState().localUser.peer;\r\n\r\n    connections.forEach(connection => connection.send({textMessage: {\r\n        text: text,\r\n        peerId: localPeer.id\r\n    }}));\r\n\r\n    dispatch({\r\n        type: ADD_NEW_MESSAGE,\r\n        payload: {text: text, peerId: localPeer.id}\r\n    });\r\n};\r\n","import React, {useState} from 'react';\r\nimport {ThemeProvider, makeStyles} from '@material-ui/core/styles';\r\nimport ChatIcon from '@material-ui/icons/Chat';\r\nimport Button from '@material-ui/core/Button';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport theme from '../../../style/theme/MainTheme';\r\nimport Chat from './Chat/Chat';\r\n\r\nconst useStyles = makeStyles({\r\n    list: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        justifyContent: 'flex-end',\r\n        overflowY: 'auto',\r\n        WebkitFlex: '1 1 auto',\r\n        height: '100%',\r\n        width: 400,\r\n        padding: 10,\r\n    },\r\n    chatIcon: {\r\n        margin: '8px'\r\n    }\r\n});\r\n\r\nconst RoomSidebarChat = () => {\r\n    const classes = useStyles();\r\n    const [open, setOpen] = useState(false);\r\n\r\n    const toggleDrawer = (event) => {\r\n        if (event.type === 'keydown') {\r\n            return;\r\n        }\r\n        setOpen(!open);\r\n    };\r\n\r\n    const list = () => (\r\n        <div className={classes.list} role=\"presentation\">\r\n            <Chat/>\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <ThemeProvider theme={theme}>\r\n            <Button>\r\n                <ChatIcon onClick={toggleDrawer} color='primary' fontSize='large' className={classes.chatIcon}/>\r\n                <Drawer open={open} onClose={toggleDrawer} anchor={'right'}>\r\n                    {list()}\r\n                </Drawer>\r\n            </Button>\r\n        </ThemeProvider>\r\n    );\r\n};\r\n\r\nexport default RoomSidebarChat;\r\n","import React from 'react';\r\nimport {Box} from \"@material-ui/core\";\r\nimport RoomSidebarMenu from \"../RoomSidebarMenu/RoomSidebarMenu\";\r\nimport RoomSidebarChat from \"../RoomSidebarChat/RoomSidebarChat\";\r\nimport {Link} from \"react-router-dom\";\r\n\r\nconst RoomActionbar = () => {\r\n    return (\r\n        <>\r\n            <Box bgcolor={'wheat'} height={'10%'} display='flex' flexDirection='row' width={1} justifyContent={'center'}>\r\n                {/* space for some easy access actions like mute, enable camera, chat etc. */}\r\n                <RoomSidebarMenu />\r\n                <RoomSidebarChat />\r\n                <Link to={'/'}>Home</Link>\r\n            </Box>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default RoomActionbar;\r\n","import React, {useEffect} from 'react';\r\nimport {Box} from \"@material-ui/core\";\r\nimport RoomPluginContent from \"./RoomPluginContent/RoomPluginContent\";\r\nimport RoomMediaManager from \"./RoomMediaManager/RoomMediaManager\";\r\nimport {connect} from \"react-redux\";\r\nimport {addConnection, removeConnection, joinRoom} from \"../../store/actions/connections.actions\";\r\nimport {initLocalUser} from \"../../store/actions/localUser.actions\";\r\nimport {startLocalStream, clearAllStreams} from \"../../store/actions/streams.actions\";\r\nimport RoomActionbar from \"./RoomActionbar/RoomActionbar\";\r\nimport {getPersistedData} from \"../../utils\";\r\n\r\nconst Room = ({socket, localPeer, localMetadata, localStream, connections, match, history, initLocalUser, joinRoom, startLocalStream, clearAllStreams, roomError}) => {\r\n    // // TODO refactor these messy useEffects. Start using useCallback and add all dependencies\r\n\r\n    useEffect(() => {\r\n        const metadata = getPersistedData('metadata');\r\n        if (!localPeer) {\r\n            initLocalUser(metadata);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (roomError) {\r\n            history.push(`/room-lobby/${match.params.roomId}`);\r\n        }\r\n    }, [roomError]);\r\n\r\n    useEffect(() => {\r\n        if (localMetadata.nickname && localPeer) {\r\n            startLocalStream();\r\n            joinRoom(match.params.roomId, 'dummy123');\r\n        }\r\n    }, [localPeer, localMetadata, startLocalStream, joinRoom, match]);\r\n\r\n    useEffect(() => {\r\n        // unmount\r\n        return () => {\r\n            if (socket) {\r\n                socket.emit('leave', match.params.roomId);\r\n                socket.disconnect();\r\n            }\r\n\r\n            if (connections) {\r\n                Object.values(connections).forEach(conn => conn.close());\r\n            }\r\n\r\n            if (window.localStream) {\r\n                window.localStream.getTracks().forEach(track => track.stop());\r\n            }\r\n            clearAllStreams();\r\n        }\r\n    }, [socket]);\r\n\r\n    return (\r\n        <>\r\n            <Box display='flex' flexDirection='column' width={1} height={'100%'} justifyContent={'space-between'} >\r\n                <Box display='flex' flexDirection='row' width={1} height={'90%'} justifyContent={'space-between'}>\r\n                    <RoomPluginContent/>\r\n                    <RoomMediaManager />\r\n                </Box>\r\n                <RoomActionbar />\r\n            </Box>\r\n        </>\r\n    );\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n    const localPeer = state.localUser.peer;\r\n    return {\r\n        socket: state.localUser.socket,\r\n        localPeer: localPeer,\r\n        localMetadata: state.localUser.metadata,\r\n        localStream: localPeer ? state.streams.data[localPeer] : null,\r\n        connections: state.connections.data,\r\n        roomError: state.room.error\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, {addConnection, removeConnection, initLocalUser, joinRoom, startLocalStream, clearAllStreams})(Room);\r\n","const isLocal = process.env.NODE_ENV === 'development';\r\n\r\nexport const API_BASE_URL = isLocal ? 'localhost' : process.env.REACT_APP_API_BASE_URL;\r\nexport const SSL_ENABLED = isLocal ? false : process.env.REACT_APP_SSL_ENABLED === 'true';\r\n\r\nexport const PORT_SIGNALING = process.env.REACT_APP_PORT_SIGNALING;\r\nexport const PORT_SOCKET = process.env.REACT_APP_PORT_SOCKET;\r\n\r\nexport const FRONTEND_URL = isLocal ? 'localhost' : process.env.REACT_APP_FRONTEND_URL;\r\n","import React from 'react';\r\nimport {ThemeProvider, makeStyles} from '@material-ui/core/styles';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport theme from '../../style/theme/MainTheme';\r\nimport Box from '@material-ui/core/Box';\r\nimport Button from '@material-ui/core/Button';\r\nimport {Link} from \"react-router-dom\";\r\n\r\n\r\nconst useStyles = makeStyles({\r\n    titleStyle: {\r\n        color: 'white',\r\n        fontWeight: 'bold',\r\n        marginTop: '98px'\r\n    },\r\n    buttonStyle: {\r\n        borderRadius: '50px',\r\n        width: '106px',\r\n        fontWeight: 'bold',\r\n        border: '2px solid #E53935',\r\n        '&:hover': {\r\n            color: 'white',\r\n            backgroundColor: '#E53935',\r\n        },\r\n        '&:focus': {\r\n            outline: 0,\r\n        }\r\n    }\r\n});\r\n\r\n\r\nconst Home = () => {\r\n\r\n    const classes = useStyles();\r\n\r\n    return (\r\n        <ThemeProvider theme={theme}>\r\n            {/* Header */}\r\n            <Box\r\n                height={63}\r\n                bgcolor='#E53935'\r\n            > </Box>\r\n\r\n            {/* Body */}\r\n            <Box\r\n                height={640}\r\n                display='flex'\r\n            >\r\n                {/* left box */}\r\n                <Box\r\n                    display='flex'\r\n                    flexDirection='column'\r\n                    width='50%'\r\n                    height='100%'\r\n                    bgcolor='#FDD835'\r\n                    alignItems='center'\r\n                >\r\n                    <Typography\r\n                        variant='h3'\r\n                        className={classes.titleStyle}\r\n                        gutterBottom\r\n                    > Create a new room\r\n                    </Typography>\r\n                    <Link to=\"/create-room\" style={{textDecoration: 'none'}}>\r\n                        <Button\r\n                            size=\"large\"\r\n                            color='primary'\r\n                            className={classes.buttonStyle}\r\n                        >\r\n                            Create\r\n                        </Button>\r\n                    </Link>\r\n                </Box>\r\n\r\n                {/* right box */}\r\n                <Box\r\n                    display='flex'\r\n                    flexDirection='column'\r\n                    width='50%'\r\n                    height='100%'\r\n                    bgcolor='#FB8C00'\r\n                    alignItems='center'\r\n                >\r\n                    <Typography\r\n                        variant=\"h3\"\r\n                        className={classes.titleStyle}\r\n                        gutterBottom\r\n                    > Join a room\r\n                    </Typography>\r\n                    <Button\r\n                        size=\"large\"\r\n                        color='primary'\r\n                        className={classes.buttonStyle}\r\n                    >Join\r\n                    </Button>\r\n                </Box>\r\n            </Box>\r\n            {/*Temporary for debugging purposes*/}\r\n            <Link to={'/rooms/dummy-room-id'}>Test room</Link>\r\n        </ThemeProvider>\r\n    )\r\n};\r\n\r\nexport default Home;\r\n","import React from 'react';\r\nimport {Link} from \"react-router-dom\";\r\nimport { ThemeProvider, makeStyles } from '@material-ui/core/styles';\r\nimport theme from '../../style/theme/MainTheme';\r\nimport Box from '@material-ui/core/Box';\r\nimport Container from '@material-ui/core/Container';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport Select from '@material-ui/core/Select';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Button from '@material-ui/core/Button';\r\nimport ArrowBackIosIcon from '@material-ui/icons/ArrowBackIos';\r\nimport {API_BASE_URL, SSL_ENABLED, FRONTEND_URL, PORT_SOCKET } from '../../constants';\r\nimport {isIpAddress} from \"../../utils\";\r\n\r\nconst useStyles = makeStyles({\r\n    containerStyle: {\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        paddingTop: '128px'\r\n    },\r\n    titleStyle: {\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        padding: '16px',\r\n        color: 'white',\r\n        fontWeight: 'bold',\r\n        backgroundColor: '#FB8C00',\r\n    },\r\n    formControl: {\r\n        width: '20%',\r\n        margin: '16px'\r\n    },\r\n    select: {\r\n        borderColor: '#FB8C00',\r\n        '&:before': {\r\n            borderColor: '#FB8C00',\r\n        },\r\n        '&:after': {\r\n            borderColor: '#f57c00',\r\n        }\r\n    },\r\n    textfield: {\r\n        width: '616px',\r\n        marginLeft: '16px',\r\n    },\r\n    textfieldLink: {\r\n        width: '506px',\r\n        marginRight: '16px',\r\n        marginLeft: '16px',\r\n    },\r\n    alignButton: {\r\n        display: 'flex',\r\n        justifyContent: 'flex-end',\r\n        margin: '16px'\r\n    },\r\n    myButton: {\r\n        color: 'white',\r\n        boxShadow: 'none'\r\n    },\r\n    paper: {\r\n        padding: theme.spacing(2),\r\n        textAlign: 'center',\r\n        color: theme.palette.text.secondary,\r\n      },\r\n    copyLink: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        marginTop: '16px'\r\n    },\r\n    nextButton: {\r\n        color: 'white',\r\n        boxShadow: 'none',\r\n        margin: '32px',\r\n        width: '576px'\r\n    },\r\n    subtitle: {\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        marginTop: '16px'\r\n    }\r\n});\r\n\r\nconst RoomCreateForm = () => {\r\n    const [status, setStatus] = React.useState('');\r\n    const [name, setName] = React.useState('');\r\n    const [link, setLink] = React.useState('');\r\n    const [roomId, setRoomId] = React.useState('');\r\n    const [active, setActive ] = React.useState(true);\r\n    const classes = useStyles();\r\n\r\n    const handleChange = (event) => {\r\n        setStatus(event.target.value);\r\n    };\r\n\r\n    const handleChangeTexfield = (event) => {\r\n        setName(event.target.value)\r\n    };\r\n\r\n    const createRoom = () => {\r\n        let data = {\r\n            name: name,\r\n            password: 'Test123.',\r\n            maxUsers: 4,\r\n            status: status\r\n        };\r\n\r\n        if(name.length > 0 && status.length > 0) {\r\n            const protocol = SSL_ENABLED ? 'https':'http';\r\n            fetch(`${protocol}://${API_BASE_URL}:${PORT_SOCKET}/api/rooms`, {\r\n                method: 'post',\r\n                body: JSON.stringify(data),\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                  },\r\n            }).then(response => response.json()\r\n            ).then( data => {\r\n                const port = isIpAddress(FRONTEND_URL) ? '3000' : ''; // TODO temp fix for gh-pages. remove once frontend is served via proxy by real domain\r\n                setLink(`${protocol}://${FRONTEND_URL}:${port}/#/room-lobby/${data}`);\r\n                setRoomId(data);\r\n                setActive(false);\r\n            });\r\n        } else {\r\n            console.log('error')\r\n        }\r\n    };\r\n\r\n    const copyToClipboard = () =>{\r\n        let mylink = link;\r\n        mylink.select();\r\n        document.execCommand('copy');\r\n    };\r\n\r\n    return (\r\n        <ThemeProvider theme={theme}>\r\n            {/* Header */}\r\n            <Box\r\n                display='flex'\r\n                height={63}\r\n                bgcolor='#E53935'\r\n                alignItems='center'\r\n                paddingLeft='36px'\r\n            >\r\n               <Link to=\"/\" style={{ textDecoration: 'none', color: 'white'}}>\r\n                    <ArrowBackIosIcon/>\r\n               </Link>\r\n            </Box>\r\n\r\n            {/* Body */}\r\n            <Container\r\n                className={classes.containerStyle}\r\n            >\r\n                {/* create a new room */}\r\n                {active ?  // TODO ternary is too long, making it hard too read, create subcomponents for create and share markup\r\n                <Box\r\n                    display='flex'\r\n                    flexDirection='column'\r\n                    width={648}\r\n                    height={307}\r\n                    borderRadius='5px'\r\n                    bgcolor='white'\r\n                >\r\n                    <Typography\r\n                        variant='h4'\r\n                        className={classes.titleStyle}\r\n                    >Create a new room\r\n                    </Typography>\r\n\r\n                    <FormControl variant=\"outlined\" className={classes.formControl}>\r\n                        <InputLabel id=\"demo-simple-select-outlined-label\">Status</InputLabel>\r\n                        <Select\r\n\r\n                        labelId=\"demo-simple-select-outlined-label\"\r\n                        id=\"demo-simple-select-outlined\"\r\n                        value={status}\r\n                        onChange={handleChange}\r\n                        label=\"Status\"\r\n                        className={classes.select}\r\n                        >\r\n                        <MenuItem value={'Privat'}>Privat</MenuItem>\r\n                        {/* <MenuItem value={'Public'}>Public</MenuItem> */}\r\n                        </Select>\r\n                    </FormControl>\r\n\r\n                    <TextField\r\n                        required\r\n                        id=\"outlined-required\"\r\n                        label=\"Room name\"\r\n                        variant=\"outlined\"\r\n                        value={name}\r\n                        onChange={handleChangeTexfield}\r\n                        className={classes.textfield}\r\n                    />\r\n                    <div className={classes.alignButton}>\r\n                            <Button\r\n                                size=\"large\"\r\n                                color=\"secondary\"\r\n                                variant=\"contained\"\r\n                                className={classes.myButton}\r\n                                onClick={createRoom}\r\n                            >\r\n                                create\r\n                            </Button>\r\n                    </div>\r\n                </Box> :\r\n\r\n                // share your room\r\n                <Box\r\n                display='flex'\r\n                flexDirection='column'\r\n                width={648}\r\n                height={307}\r\n                borderRadius='5px'\r\n                bgcolor='white'\r\n                >\r\n                <Typography\r\n                    variant='h4'\r\n                    className={classes.titleStyle}\r\n                >Room was created\r\n                </Typography>\r\n\r\n                <div className={classes.copyLink}>\r\n                    <TextField\r\n                        variant=\"outlined\"\r\n                        value={link}\r\n                        onChange={handleChangeTexfield}\r\n                        className={classes.textfieldLink}\r\n                    />\r\n                    <Button\r\n                        size=\"large\"\r\n                        color=\"secondary\"\r\n                        variant=\"contained\"\r\n                        className={classes.myButton}\r\n                        onClick={() => {navigator.clipboard.writeText(link)}}\r\n                    >\r\n                        copy\r\n                    </Button>\r\n                </div>\r\n                <Typography\r\n                        variant='h6'\r\n                        className={classes.subtitle}\r\n                    > Share your link and invite someone to your room\r\n                </Typography>\r\n\r\n                <Link to={`/room-lobby/${roomId}`} style={{ textDecoration: 'none',}}>\r\n                 <Button\r\n                    size=\"large\"\r\n                    color=\"secondary\"\r\n                    variant=\"contained\"\r\n                    className={classes.nextButton}\r\n                   >\r\n                        next\r\n                </Button>\r\n                </Link>\r\n               </Box>\r\n            }\r\n            </Container>\r\n        </ThemeProvider>\r\n    )\r\n};\r\n\r\nexport default RoomCreateForm;\r\n","import React from 'react';\r\nimport { HashRouter as Router, Route, Switch } from \"react-router-dom\";\r\nimport RoomLobby from \"../RoomLobby/RoomLobby\";\r\nimport Room from \"../Room/Room\";\r\nimport Home from \"../Home/Home\";\r\nimport RoomCreateForm from \"../RoomCreateForm/RoomCreateForm\";\r\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\r\n\r\nconst App = () => {\r\n    return (\r\n        <CssBaseline>\r\n            <Router>\r\n                <Switch>\r\n                    <Route exact path='/' component={Home} />\r\n                    <Route exact path='/create-room' component={RoomCreateForm} />\r\n                    <Route exact path='/room-lobby/:roomId' component={RoomLobby} />\r\n                    <Route path='/rooms/:roomId' component={Room} />\r\n                </Switch>\r\n            </Router>\r\n        </CssBaseline>\r\n    );\r\n};\r\n\r\nexport default App;\r\n","import React, {StrictMode} from 'react';\r\nimport './index.scss';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\nimport store from './store';\r\nimport App from './components/App/App';\r\n\r\nReactDOM.render(\r\n  <>\r\n      <Provider store={store}>\r\n          <App />\r\n      </Provider>\r\n  </>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}