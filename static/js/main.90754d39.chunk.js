(this["webpackJsonpp2p-videochat-platform-frontend"]=this["webpackJsonpp2p-videochat-platform-frontend"]||[]).push([[0],{136:function(e,t,a){e.exports=a(183)},138:function(e,t,a){},146:function(e,t){},150:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=150},180:function(e,t){},183:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=(a(138),a(8)),c=a.n(o),l=a(26),i=a(33),u=a(108),s=a(109),m=(a(146),a(11)),d={peer:null,socket:null,metadata:{nickname:"Andi"},error:null},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_LOCAL_USER_SOCKET":return Object(m.a)({},e,{socket:t.payload.socket,error:null});case"INIT_LOCAL_USER_PEER":return Object(m.a)({},e,{peer:t.payload.peer,error:null});case"SET_LOCAL_USER_METADATA":return Object(m.a)({},e,{metadata:t.payload.metadata,error:null});case"SET_LOCAL_USER_ERROR":return Object(m.a)({},e,{error:t.payload.error});default:return e}},f=a(24),E={data:{d7f7saim3:{nickname:"Andi",peerId:"dscdsv-csdvsdv-dvewvew-btrbrb3",connection:"efewfgrger",call:"fewfewfwef"},"32mfdnmio":{nickname:"Jimmy",peerId:"ztjzt-ckhjgvv-dvewvew-b3cddrv",connection:"vverberberb",call:"vewrverbe"}},error:null},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_PEER":var a=t.payload.peer;return{data:Object(m.a)({},e.data,Object(f.a)({},a.id,a)),error:null};case"REMOVE_PEER":var n=Object(m.a)({},e.data),r=t.payload.peer;return delete n[r.id],{data:n,error:null};case"SET_PEERS_ERROR":return Object(m.a)({},e,{error:t.payload.error});case"ADD_CONNECTION":case"REMOVE_CONNECTION":case"ADD_CALL":case"REMOVE_CALL":case"SET_STREAM":default:return e}},g={data:{},error:null},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_CONNECTION":var a=t.payload.connection;return{data:Object(m.a)({},e.data,Object(f.a)({},a.peer,a)),error:null};case"REMOVE_CONNECTION":var n=Object(m.a)({},e.data),r=t.payload.connection;return delete n[r.peer],{data:n,error:null};case"SET_CONNECTIONS_ERROR":return Object(m.a)({},e,{error:t.payload.error});default:return e}},y={data:{},error:null},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_CALL":var a=t.payload.call;return console.log("REDUCER ADD_CALL",a),{data:Object(m.a)({},e.data,Object(f.a)({},a.peer,a)),error:null};case"REMOVE_CALL":var n=Object(m.a)({},e.data),r=t.payload.call;return delete n[r.id],{data:n,error:null};case"SET_CALLS_ERROR":return Object(m.a)({},e,{error:t.payload.error});default:return e}},x={data:{},error:null},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_STREAM":var a=t.payload,n=a.peerId,r=a.isActive;return{data:Object(m.a)({},e.data,Object(f.a)({},n,r)),error:null};case"SET_STREAM_ERROR":return Object(m.a)({},e,{error:t.payload.error});default:return e}},w=Object(i.combineReducers)({localUser:p,peers:h,calls:v,connections:b,streams:O}),S=Object(i.createStore)(w,Object(s.composeWithDevTools)(Object(i.applyMiddleware)(u.a))),j=a(27),C=a(37),N=a(16),k=a(211),R=a(213),_=a(118),L=Object(_.a)({palette:{primary:{main:"#E53935"},secondary:{main:"#FB8C00"}}}),I=a(227),T=a(215),A=a(67),D=a(231),M=a(220),B=a(64),U=a.n(B),P=Object(k.a)({containerStyle:{display:"flex",justifyContent:"center",paddingTop:"128px"},titleStyle:{display:"flex",justifyContent:"center",padding:"16px",color:"white",fontWeight:"bold",backgroundColor:"#FB8C00"},nicknameStyle:{width:"616px",margin:"16px"},textfieldLink:{width:"616px",marginRight:"16px",marginLeft:"16px"},nextButton:{color:"white",boxShadow:"none",width:"422px"},alignbutton:{display:"flex",justifyContent:"center",marginTop:"24px"}}),F=function(){var e=r.a.useState(""),t=Object(N.a)(e,2),a=t[0],n=t[1],o=r.a.useState(""),c=Object(N.a)(o,2),l=c[0],i=c[1],u=P();return r.a.createElement(R.a,{theme:L},r.a.createElement(I.a,{display:"flex",height:63,bgcolor:"#E53935",alignItems:"center",paddingLeft:"36px"},r.a.createElement(j.b,{to:"/",style:{textDecoration:"none",color:"white"}},r.a.createElement(U.a,null))),r.a.createElement(T.a,{className:u.containerStyle},r.a.createElement(I.a,{display:"flex",flexDirection:"column",width:648,height:307,borderRadius:"5px",bgcolor:"white"},r.a.createElement(A.a,{variant:"h4",className:u.titleStyle},"Enter the rooom"),r.a.createElement(D.a,{required:!0,id:"outlined-required",label:"Nickname",variant:"outlined",value:a,className:u.nicknameStyle,onChange:function(e){n(e.target.value)}}),r.a.createElement(D.a,{required:!0,id:"outlined-required",label:"Room ID",variant:"outlined",value:l,className:u.textfieldLink,onChange:function(e){i(e.target.value)}}),r.a.createElement("div",{className:u.alignbutton},r.a.createElement(M.a,{size:"large",color:"secondary",variant:"contained",className:u.nextButton},"join")))))},z=a(230),W=a(219),q=a(223),K=a(186),J=a(221),V=a(222),X=a(82),Z=a.n(X),G=a(83),H=a.n(G),Q=a(114),Y=a.n(Q),$=Object(k.a)({list:{width:250},fullList:{width:"auto"},menuIcon:{margin:"8px"}}),ee=function(){var e=$(),t=r.a.useState(!1),a=Object(N.a)(t,2),n=a[0],o=a[1],c=function(e){"keydown"!==e.type&&o(!n)};return r.a.createElement(R.a,{theme:L},r.a.createElement("div",null,r.a.createElement(Y.a,{onClick:c,color:"primary",fontSize:"large",className:e.menuIcon}),r.a.createElement(z.a,{open:n,onClose:c},r.a.createElement("div",{className:e.list,role:"presentation",onClick:c,onKeyDown:c},r.a.createElement(W.a,null,["Inbox","Starred","Send email","Drafts"].map((function(e,t){return r.a.createElement(K.a,{button:!0,key:e},r.a.createElement(J.a,null,t%2===0?r.a.createElement(Z.a,null):r.a.createElement(H.a,null)),r.a.createElement(V.a,{primary:e}))}))),r.a.createElement(q.a,null),r.a.createElement(W.a,null,["All mail","Trash","Spam"].map((function(e,t){return r.a.createElement(K.a,{button:!0,key:e},r.a.createElement(J.a,null,t%2===0?r.a.createElement(Z.a,null):r.a.createElement(H.a,null)),r.a.createElement(V.a,{primary:e}))})))))))},te=function(){return r.a.createElement(I.a,{bgcolor:"salmon",flexGrow:1},"Plugin Content")},ae=a(224),ne=function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e.current&&t&&(e.current.srcObject=t,e.current.oncanplay=function(){e.current.play(),e.current.muted=a})},re=Object(k.a)((function(e){return{root:{display:"flex"},cardWrapper:{marginBottom:"5px"},media:{width:"100%",height:"120px",objectFit:"cover"}}})),oe=function(e){var t=e.stream,a=e.muted,o=void 0!==a&&a,c=e.user,l=re(),i=Object(n.useRef)(null),u=c.nickname;c.peerId;return Object(n.useEffect)((function(){ne(i,t,o)}),[t]),r.a.createElement(ae.a,{className:l.cardWrapper},r.a.createElement("video",{ref:i,className:l.media}),u)},ce=a(115),le=new function e(){var t=this;Object(ce.a)(this,e),this.setStream=function(e,a){return t.streams[e]=a},this.getStream=function(e){return t.streams[e]},this.clearStream=function(e){var a=t.streams[e];a&&a.getTracks().forEach((function(e){return e.stop()}))},this.clearAllStreams=function(){Object.keys(t.streams).forEach((function(e){t.clearStream(e)}))},this.streams={}};window.streamStore=le;var ie=le,ue=a(38),se=a.n(ue),me=a(54),de=function(e,t){return function(a,n){a({type:"SET_STREAM",payload:{peerId:e,isActive:t}})}},pe=function(e){return function(t,a){e&&(t({type:"ADD_CALL",payload:{call:e}}),t(fe(e)))}},fe=function(e){return function(t,a){e&&e.on("stream",(function(a){ie.setStream(e.peer,a),t(de(e.peer,!0))}))}},Ee=Object(l.b)((function(e,t){var a=e.localUser.peer,n=t.connection.peer,r=n?ie.getStream(n):null;return{localPeer:a,localStream:a?ie.getStream(a.id):null,remoteStream:r}}),{addCall:pe})((function(e){var t=e.localPeer,a=e.localStream,o=e.remoteStream,c=e.connection,l=e.addCall;Object(n.useEffect)((function(){t&&c&&!o&&i()}),[t,c]);var i=function(){if(t){var e=t.call(c.peer,a);l(e)}};return r.a.createElement(oe,{stream:o,user:{nickname:"remote"}})})),he=Object(l.b)((function(e){return{connections:Object.values(e.connections.data)}}))((function(e){var t=e.localPeer,a=e.localStream,n=e.connections;return r.a.createElement(r.a.Fragment,null,t&&a&&n&&n.map((function(e){return r.a.createElement(Ee,{key:e.connectionId,connection:e})})))})),ge=Object(k.a)((function(e){return{roomMediaManager:{padding:"5px"}}})),be=Object(l.b)((function(e){var t=e.localUser.peer,a=t?ie.getStream(t.id):null;return{localPeer:e.localUser.peer,localStream:a}}),{startLocalStream:function(){return function(){var e=Object(me.a)(se.a.mark((function e(t,a){var n,r;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a().localUser.peer,e.prev=1,e.next=4,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 4:r=e.sent,ie.setStream(n.id,r),t(de(n.id,!0)),window.localStream=r,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error('local stream couldnt be started via "startStream()"',e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,a){return e.apply(this,arguments)}}()}})((function(e){var t=e.localPeer,a=e.localStream,o=e.startLocalStream,c=ge(),l=Object(n.useRef)(null);return Object(n.useEffect)((function(){return function(){ie.clearAllStreams()}}),[]),Object(n.useEffect)((function(){t&&t.id&&o()}),[t]),Object(n.useEffect)((function(){a&&ne(l,a,!0)}),[a]),r.a.createElement(I.a,{bgcolor:"lightblue",width:"200px",minWidth:"150px",className:c.roomMediaManager},console.log("localStream--",a),r.a.createElement(oe,{stream:a,muted:!0,user:{nickname:"local"}}),r.a.createElement(he,{localPeer:t,localStream:a}))})),ye=function(e){return function(t,a){e.peer&&e.connectionId&&(t({type:"ADD_CONNECTION",payload:{connection:e}}),t(xe(e)))}},ve=function(e){return function(t,a){e.connectionId&&t({type:"REMOVE_CONNECTION",payload:{connection:e}})}},xe=function(e){return function(t,a){e&&e.connectionId&&(e.on("data",(function(e){var t=JSON.parse(e);t.textMessage&&console.log("%c MESSAGE - ".concat(t.textMessage.author,': "').concat(t.textMessage.text,'"'),"background: black; color: white; padding: 1rem"),t.pluginData&&console.log("received plugin data:",t)})),e.on("close",(function(){t(ve(e))})))}},Oe=a(116),we=a.n(Oe),Se=a(117),je=a.n(Se),Ce=function(e){return function(t,a){var n=e||a().localUser.peer;n&&(n.on("open",(function(e){console.log("------------------------My peer ID is: "+n.id,n)})),n.on("connection",(function(e){t(ye(e))})),n.on("call",(function(e){var r=a().streams.data[n.id];console.log("ONCALL action, local stream active: ",r,ie.getStream(n.id)),e.answer(),t(pe(e))})))}},Ne=Object(l.b)((function(e){return{socket:e.localUser.socket,localPeer:e.localUser.peer,connections:e.connections.data}}),{addConnection:ye,removeConnection:ve,initLocalUser:function(e){return function(){var t=Object(me.a)(se.a.mark((function t(a,n){var r;return se.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"https",(r=je()("".concat("https","://").concat("derpmasters.online",":").concat("5002"),{secure:!0,query:(n=e,Object.entries(n).map((function(e){var t=Object(N.a)(e,2),a=t[0],n=t[1];return"".concat(a,"=").concat(n)})).join("&"))})).on("ready",(function(t){var n;a({type:"SET_LOCAL_USER_METADATA",payload:{metadata:e}}),a({type:"INIT_LOCAL_USER_SOCKET",payload:{socket:r}}),a((n=t,function(){var e=Object(me.a)(se.a.mark((function e(t,a){var r;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new we.a(n,{host:"derpmasters.online",port:"5001",path:"/peer/signal",config:{iceServers:[{url:"stun:stun.l.google.com:19302"}]}});case 2:r=e.sent,t({type:"INIT_LOCAL_USER_PEER",payload:{peer:r}}),t(Ce(r));case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()))}));case 3:case"end":return t.stop()}var n}),t)})));return function(e,a){return t.apply(this,arguments)}}()},joinRoom:function(e,t){return function(a,n){var r=n().localUser,o=r.socket,c=r.peer;o&&c&&o.emit("join",{roomId:e,password:t,peerId:c.id},(function(e){e&&(console.log("joined room",e),e.room.joinedUsers.forEach((function(e){if(e!==c.id){var t=c.connect(e,{metadata:{nickname:"test-metadata"}});a(ye(t))}})))}))}}})((function(e){var t=e.socket,a=e.localPeer,o=e.connections,c=e.match,l=e.initLocalUser,i=e.joinRoom;return Object(n.useEffect)((function(){l({nickname:"andiiii"})}),[]),Object(n.useEffect)((function(){if(a){var e=c.params.roomId;i(e,"dummy123")}}),[a]),Object(n.useEffect)((function(){return function(){var e=c.params.roomId;t&&t.emit("leave",e),o&&Object.values(o).forEach((function(e){return e.close()}))}}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(ee,null),r.a.createElement(I.a,{display:"flex",flexDirection:"column",width:1,height:"calc(100% - 60px)",justifyContent:"space-between"},r.a.createElement(I.a,{display:"flex",flexDirection:"row",width:1,height:"90%",justifyContent:"space-between"},r.a.createElement(te,null),r.a.createElement(be,null)),r.a.createElement(I.a,{bgcolor:"wheat",height:"10%"}," ")))})),ke=Object(k.a)({titleStyle:{color:"white",fontWeight:"bold",marginTop:"98px"},buttonStyle:{borderRadius:"50px",width:"106px",fontWeight:"bold",border:"2px solid #E53935","&:hover":{color:"white",backgroundColor:"#E53935"},"&:focus":{outline:0}}}),Re=function(){var e=ke();return r.a.createElement(R.a,{theme:L},r.a.createElement(I.a,{height:63,bgcolor:"#E53935"}," "),r.a.createElement(I.a,{height:640,display:"flex"},r.a.createElement(I.a,{display:"flex",flexDirection:"column",width:"50%",height:"100%",bgcolor:"#FDD835",alignItems:"center"},r.a.createElement(A.a,{variant:"h3",className:e.titleStyle,gutterBottom:!0}," Create a new room"),r.a.createElement(j.b,{to:"/create-room",style:{textDecoration:"none"}},r.a.createElement(M.a,{size:"large",color:"primary",className:e.buttonStyle},"Create"))),r.a.createElement(I.a,{display:"flex",flexDirection:"column",width:"50%",height:"100%",bgcolor:"#FB8C00",alignItems:"center"},r.a.createElement(A.a,{variant:"h3",className:e.titleStyle,gutterBottom:!0}," Join a room"),r.a.createElement(M.a,{size:"large",color:"primary",className:e.buttonStyle},"Join"))),r.a.createElement(j.b,{to:"/rooms/dummy-room-id"},"Test room"))},_e=a(232),Le=a(225),Ie=a(218),Te=a(228),Ae=Object(k.a)({containerStyle:{display:"flex",justifyContent:"center",paddingTop:"128px"},titleStyle:{display:"flex",justifyContent:"center",padding:"16px",color:"white",fontWeight:"bold",backgroundColor:"#FB8C00"},formControl:{width:"20%",margin:"16px"},select:{borderColor:"#FB8C00","&:before":{borderColor:"#FB8C00"},"&:after":{borderColor:"#f57c00"}},textfield:{width:"616px",marginLeft:"16px"},textfieldLink:{width:"506px",marginRight:"16px",marginLeft:"16px"},alignButton:{display:"flex",justifyContent:"flex-end",margin:"16px"},myButton:{color:"white",boxShadow:"none"},paper:{padding:L.spacing(2),textAlign:"center",color:L.palette.text.secondary},copyLink:{display:"flex",alignItems:"center",marginTop:"16px"},nextButton:{color:"white",boxShadow:"none",margin:"32px",width:"576px"},subtitle:{display:"flex",justifyContent:"center",marginTop:"16px"}}),De=function(){var e=r.a.useState(""),t=Object(N.a)(e,2),a=t[0],n=t[1],o=r.a.useState(""),c=Object(N.a)(o,2),l=c[0],i=c[1],u=r.a.useState("https://www.figma.com/file/By2kgyeP0jIK0txwX2ZF0 https://www.figma.com/file/By2kgyeP0jIK0txwX2ZF0 https://www.figma.com/file/By2kgyeP0jIK0txwX2ZF0 https://www.figma.com/file/By2kgyeP0jIK0txwX2ZF0"),s=Object(N.a)(u,2),m=s[0],d=(s[1],r.a.useState(!0)),p=Object(N.a)(d,2),f=p[0],E=p[1],h=Ae(),g=function(e){i(e.target.value)};return r.a.createElement(R.a,{theme:L},r.a.createElement(I.a,{display:"flex",height:63,bgcolor:"#E53935",alignItems:"center",paddingLeft:"36px"},r.a.createElement(j.b,{to:"/",style:{textDecoration:"none",color:"white"}},r.a.createElement(U.a,null))),r.a.createElement(T.a,{className:h.containerStyle},f?r.a.createElement(I.a,{display:"flex",flexDirection:"column",width:648,height:307,borderRadius:"5px",bgcolor:"white"},r.a.createElement(A.a,{variant:"h4",className:h.titleStyle},"Create a new room"),r.a.createElement(Ie.a,{variant:"outlined",className:h.formControl},r.a.createElement(_e.a,{id:"demo-simple-select-outlined-label"},"Status"),r.a.createElement(Te.a,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",value:a,onChange:function(e){n(e.target.value)},label:"Status",className:h.select},r.a.createElement(Le.a,{value:"Privat"},"Privat"),r.a.createElement(Le.a,{value:"Public"},"Public"))),r.a.createElement(D.a,{required:!0,id:"outlined-required",label:"Room name",variant:"outlined",value:l,onChange:g,className:h.textfield}),r.a.createElement("div",{className:h.alignButton},r.a.createElement(M.a,{size:"large",color:"secondary",variant:"contained",className:h.myButton,onClick:function(){l.length>0&&a.length>0?(E(!1),console.log(a,l)):console.log("error")}},"create"))):r.a.createElement(I.a,{display:"flex",flexDirection:"column",width:648,height:307,borderRadius:"5px",bgcolor:"white"},r.a.createElement(A.a,{variant:"h4",className:h.titleStyle},"Room was created"),r.a.createElement("div",{className:h.copyLink},r.a.createElement(D.a,{variant:"outlined",value:m,onChange:g,className:h.textfieldLink}),r.a.createElement(M.a,{size:"large",color:"secondary",variant:"contained",className:h.myButton,onClick:function(){navigator.clipboard.writeText(m)}},"copy")),r.a.createElement(A.a,{variant:"h6",className:h.subtitle}," Share your link and invite someone to your room"),r.a.createElement(j.b,{to:"/room-lobby/1",style:{textDecoration:"none"}},r.a.createElement(M.a,{size:"large",color:"secondary",variant:"contained",className:h.nextButton},"next")))))},Me=a(226),Be=function(){return r.a.createElement(Me.a,null,r.a.createElement(j.a,null,r.a.createElement(C.c,null,r.a.createElement(C.a,{exact:!0,path:"/",component:Re}),r.a.createElement(C.a,{exact:!0,path:"/create-room",component:De}),r.a.createElement(C.a,{exact:!0,path:"/room-lobby/:roomId",component:F}),r.a.createElement(C.a,{path:"/rooms/:roomId",component:Ne}))))};c.a.render(r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a,{store:S},r.a.createElement(Be,null))),document.getElementById("root"))}},[[136,1,2]]]);
//# sourceMappingURL=main.90754d39.chunk.js.map